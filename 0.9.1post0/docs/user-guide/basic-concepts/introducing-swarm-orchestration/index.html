<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="A programming framework for agentic AI"><meta name=author content="Chi Wang & Qingyun Wu"><link href=https://docs.ag2.ai/latest/docs/user-guide/basic-concepts/introducing-swarm-orchestration/ rel=canonical><link rel=icon href=../../../../assets/images/favicon.png><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.6.12"><title>Agent Orchestration: Coordinating Multiple Agents - AG2</title><link rel=stylesheet href=../../../../assets/stylesheets/main.2afb09e1.min.css><link rel=stylesheet href=../../../../assets/stylesheets/palette.06af60db.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Inter:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Inter";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../../../css/timeago.css><link rel=stylesheet href=../../../../assets/_mkdocstrings.css><link rel=stylesheet href=../../../../stylesheets/extra.ff0633.min.css><script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><script id=__analytics>function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-2GN2KN2CE4"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-2GN2KN2CE4",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-2GN2KN2CE4",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script><script>"undefined"!=typeof __md_analytics&&__md_analytics()</script><meta http-equiv=Cache-Control content="no-cache, no-store, must-revalidate"><meta property=og:type content=website><meta property=og:title content="AG2 - Agent Orchestration: Coordinating Multiple Agents"><meta property=og:description content="A programming framework for agentic AI"><meta content=https://docs.ag2.ai/latest/docs/user-guide/basic-concepts/introducing-swarm-orchestration/ property=og:url><meta property=og:image content=https://opengraph.githubassets.com/1671805243.560327/ag2ai/ag2><meta property=og:image:type content=image/png><meta property=og:image:width content=1200><meta property=og:image:height content=630><meta name=twitter:card content=summary_large_image><meta name=twitter:title content="AG2 - Agent Orchestration: Coordinating Multiple Agents"><meta name=twitter:description content="A programming framework for agentic AI"><meta name=twitter:image content=https://opengraph.githubassets.com/1671805243.560327/ag2ai/ag2><link rel=icon href=https://docs.ag2.ai/latest/assets/img/favicon.svg type=image/x-icon><link rel=icon href=https://docs.ag2.ai/latest/assets/img/favicon-dark.svg type=image/x-icon media="(prefers-color-scheme: light)"><link rel=icon href=https://docs.ag2.ai/latest/assets/img/favicon.svg type=image/x-icon media="(prefers-color-scheme: dark)"><link href=../../../../assets/stylesheets/glightbox.min.css rel=stylesheet><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }
    .gscrollbar-fixer { padding-right: 15px; }
    .gdesc-inner { font-size: 0.75rem; }
    body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
    body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
    body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}</style><script src=../../../../assets/javascripts/glightbox.min.js></script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=custom data-md-color-accent=indigo> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#the-need-for-specialized-agents class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <div data-md-color-scheme=default data-md-component=outdated hidden> <aside class="md-banner md-banner--warning"> <div class="md-banner__inner md-grid md-typeset"> You're not viewing the latest version. <a href=../../../../..> <strong>Click here to go to latest.</strong> </a> </div> <script>var el=document.querySelector("[data-md-component=outdated]"),base=new URL("../../../.."),outdated=__md_get("__outdated",sessionStorage,base);!0===outdated&&el&&(el.hidden=!1)</script> </aside> </div> <header class="md-header md-header--shadow md-header--lifted" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../../../.. title=AG2 class="md-header__button md-logo" aria-label=AG2 data-md-component=logo> <img src=../../../../assets/img/logo.svg alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> AG2 </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Agent Orchestration: Coordinating Multiple Agents </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme=default data-md-color-primary=custom data-md-color-accent=indigo aria-label="Switch to dark mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=custom data-md-color-accent=indigo aria-label="Switch to light mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg> </label> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/ag2ai/ag2 title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </div> <div class=md-source__repository> ag2ai/ag2 </div> </a> </div> </nav> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../../../quick-start/ class=md-tabs__link> Quick Start </a> </li> <li class=md-tabs__item> <a href=../installing-ag2/ class=md-tabs__link> User Guide </a> </li> <li class=md-tabs__item> <a href=../../../api-reference/autogen/Agent/ class=md-tabs__link> API References </a> </li> <li class=md-tabs__item> <a href=../../../contributor-guide/contributing/ class=md-tabs__link> Contributor Guide </a> </li> <li class=md-tabs__item> <a href=../../../ecosystem/agentops/ class=md-tabs__link> Ecosystem </a> </li> <li class=md-tabs__item> <a href=../../../use-cases/use-cases/customer-service/ class=md-tabs__link> Use Cases </a> </li> <li class=md-tabs__item> <a href=../../../user-stories/2025-04-30-Cegid-Pulse-OS/cegid_pulse_os/ class=md-tabs__link> Community Insights </a> </li> <li class=md-tabs__item> <a href=../../../blog/ class=md-tabs__link> Blog </a> </li> </ul> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../../../.. title=AG2 class="md-nav__button md-logo" aria-label=AG2 data-md-component=logo> <img src=../../../../assets/img/logo.svg alt=logo> </a> AG2 </label> <div class=md-nav__source> <a href=https://github.com/ag2ai/ag2 title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </div> <div class=md-source__repository> ag2ai/ag2 </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../quick-start/ class=md-nav__link> <span class=md-ellipsis> Quick Start </span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../installing-ag2/ class=md-nav__link> <span class=md-ellipsis> User Guide </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../api-reference/autogen/Agent/ class=md-nav__link> <span class=md-ellipsis> API References </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../contributor-guide/contributing/ class=md-nav__link> <span class=md-ellipsis> Contributor Guide </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../ecosystem/agentops/ class=md-nav__link> <span class=md-ellipsis> Ecosystem </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../use-cases/use-cases/customer-service/ class=md-nav__link> <span class=md-ellipsis> Use Cases </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../user-stories/2025-04-30-Cegid-Pulse-OS/cegid_pulse_os/ class=md-nav__link> <span class=md-ellipsis> Community Insights </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../blog/ class=md-nav__link> <span class=md-ellipsis> Blog </span> <span class="md-nav__icon md-icon"></span> </a> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#the-need-for-specialized-agents class=md-nav__link> <span class=md-ellipsis> The Need for Specialized Agents </span> </a> </li> <li class=md-nav__item> <a href=#introducing-the-swarm-pattern class=md-nav__link> <span class=md-ellipsis> Introducing the Swarm Pattern </span> </a> </li> <li class=md-nav__item> <a href=#from-concept-to-implementation class=md-nav__link> <span class=md-ellipsis> From Concept to Implementation </span> </a> </li> <li class=md-nav__item> <a href=#enhancing-our-financial-compliance-system-with-swarm class=md-nav__link> <span class=md-ellipsis> Enhancing Our Financial Compliance System with Swarm </span> </a> <nav class=md-nav aria-label="Enhancing Our Financial Compliance System with Swarm"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#the-challenge class=md-nav__link> <span class=md-ellipsis> The Challenge </span> </a> </li> <li class=md-nav__item> <a href=#our-swarm-solution class=md-nav__link> <span class=md-ellipsis> Our Swarm Solution </span> </a> </li> <li class=md-nav__item> <a href=#implementation-creating-the-necessary-agents class=md-nav__link> <span class=md-ellipsis> Implementation: Creating the Necessary Agents </span> </a> </li> <li class=md-nav__item> <a href=#initiating-the-swarm class=md-nav__link> <span class=md-ellipsis> Initiating the Swarm </span> </a> </li> <li class=md-nav__item> <a href=#understanding-the-swarm-workflow class=md-nav__link> <span class=md-ellipsis> Understanding the Swarm Workflow </span> </a> </li> <li class=md-nav__item> <a href=#complete-code-example class=md-nav__link> <span class=md-ellipsis> Complete Code Example </span> </a> </li> <li class=md-nav__item> <a href=#how-to-run-this-example class=md-nav__link> <span class=md-ellipsis> How to Run This Example </span> </a> </li> <li class=md-nav__item> <a href=#example-output class=md-nav__link> <span class=md-ellipsis> Example Output </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#automatic-termination-in-swarm-chats class=md-nav__link> <span class=md-ellipsis> Automatic Termination in Swarm Chats </span> </a> <nav class=md-nav aria-label="Automatic Termination in Swarm Chats"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#creating-a-termination-condition class=md-nav__link> <span class=md-ellipsis> Creating a Termination Condition </span> </a> </li> <li class=md-nav__item> <a href=#updated-flow-with-automatic-termination class=md-nav__link> <span class=md-ellipsis> Updated Flow with Automatic Termination </span> </a> </li> <li class=md-nav__item> <a href=#complete-code-example-with-automatic-termination class=md-nav__link> <span class=md-ellipsis> Complete Code Example with Automatic Termination </span> </a> </li> <li class=md-nav__item> <a href=#example-output-with-automatic-termination class=md-nav__link> <span class=md-ellipsis> Example Output with Automatic Termination </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#next-steps-extending-the-system class=md-nav__link> <span class=md-ellipsis> Next Steps: Extending the System </span> </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <a href=https://github.com/ag2ai/ag2/edit/main/website/docs/user-guide/basic-concepts/introducing-swarm-orchestration.md title="Edit this page" class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="m7 14.94 6.06-6.06 2.06 2.06L9.06 17H7zM12 20a8 8 0 0 0 8-8 8 8 0 0 0-8-8 8 8 0 0 0-8 8 8 8 0 0 0 8 8m4.7-10.65-1 1-2.05-2.05 1-1c.21-.22.56-.22.77 0l1.28 1.28c.22.21.22.56 0 .77M12 2a10 10 0 0 1 10 10 10 10 0 0 1-10 10A10 10 0 0 1 2 12 10 10 0 0 1 12 2"/></svg> </a> <h1>Agent Orchestration: Coordinating Multiple Agents</h1> <p>In our financial compliance example, we've successfully implemented a human-in-the-loop agent that processes transactions and flags suspicious ones for human approval. This works well for basic compliance checking, but what if we need to provide detailed summary reports after all transactions are processed?</p> <p>We could expand the system message of our <code>finance_bot</code> to include this functionality, but this approach isn't scalable as requirements grow more complex. The <code>finance_bot</code> would have multiple responsibilities, making it harder to maintain and extend.</p> <h2 id=the-need-for-specialized-agents>The Need for Specialized Agents<a class=headerlink href=#the-need-for-specialized-agents title="Permanent link">#</a></h2> <p>As our financial compliance system evolves, we might need to:</p> <ul> <li>Generate formatted summary reports of all transactions</li> <li>Perform risk analysis on transaction patterns</li> <li>Create visualizations of financial data</li> <li>Send notifications to relevant stakeholders</li> </ul> <p>Each of these tasks requires different specialized knowledge and skills. This is where AG2's orchestration patterns come in - they allow us to coordinate multiple specialized agents to work together seamlessly.</p> <h2 id=introducing-the-swarm-pattern>Introducing the Swarm Pattern<a class=headerlink href=#introducing-the-swarm-pattern title="Permanent link">#</a></h2> <p>AG2 offers several orchestration patterns, and for our evolving financial compliance system, the swarm pattern is particularly powerful. It allows specialized agents to collaborate with dynamic handoffs to achieve complex workflows.</p> <p><strong>An Analogy for Swarm Pattern:</strong></p> <p>Continuing our hospital treatment system analogy from the HITL. Think of the swarm pattern like a hospital emergency in the hospital:</p> <ul> <li>The patient first sees whichever specialist is most appropriate (a triage agent)</li> <li>Each specialist (specialized agent) handles a specific aspect of patient care</li> <li>After completing their work, specialists can explicitly transfer the patient to another specialist based on what they found (agent handoffs)</li> <li>If a specialist doesn't specify who should see the patient next, we can revert to the hospital coordinator (swarm manager) who can review the patient's chart and decide which specialist would be most appropriate</li> <li>The patient record follows them through the entire process (shared context)</li> <li>The entire system works together to ensure the patient receives the right care at the right time</li> </ul> <p>This pattern leverages specialized skills while maintaining a cohesive workflow across multiple participants, with both direct handoffs and intelligent coordination when needed.</p> <h2 id=from-concept-to-implementation>From Concept to Implementation<a class=headerlink href=#from-concept-to-implementation title="Permanent link">#</a></h2> <p>Implementing a swarm in AG2 is straightforward using the <a href=../../../api-reference/autogen/initiate_swarm_chat><code>initiate_swarm_chat</code></a> method:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=kn>from</span><span class=w> </span><span class=nn>autogen</span><span class=w> </span><span class=kn>import</span> <span class=n>ConversableAgent</span><span class=p>,</span> <span class=n>AfterWorkOption</span><span class=p>,</span> <span class=n>initiate_swarm_chat</span><span class=p>,</span> <span class=n>LLMConfig</span>
<a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a>
<a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a><span class=c1># Create your specialized agents</span>
<a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a><span class=k>with</span> <span class=n>llm_config</span><span class=p>:</span>
<a id=__codelineno-0-5 name=__codelineno-0-5 href=#__codelineno-0-5></a>    <span class=n>agent_1</span> <span class=o>=</span> <span class=n>ConversableAgent</span><span class=p>(</span><span class=n>name</span><span class=o>=</span><span class=s2>&quot;agent_1&quot;</span><span class=p>,</span> <span class=n>system_message</span><span class=o>=</span><span class=s2>&quot;...&quot;</span><span class=p>)</span>
<a id=__codelineno-0-6 name=__codelineno-0-6 href=#__codelineno-0-6></a>    <span class=n>agent_2</span> <span class=o>=</span> <span class=n>ConversableAgent</span><span class=p>(</span><span class=n>name</span><span class=o>=</span><span class=s2>&quot;agent_2&quot;</span><span class=p>,</span> <span class=n>system_message</span><span class=o>=</span><span class=s2>&quot;...&quot;</span><span class=p>)</span>
<a id=__codelineno-0-7 name=__codelineno-0-7 href=#__codelineno-0-7></a>
<a id=__codelineno-0-8 name=__codelineno-0-8 href=#__codelineno-0-8></a><span class=c1># Create human agent if needed</span>
<a id=__codelineno-0-9 name=__codelineno-0-9 href=#__codelineno-0-9></a><span class=n>human</span> <span class=o>=</span> <span class=n>ConversableAgent</span><span class=p>(</span><span class=n>name</span><span class=o>=</span><span class=s2>&quot;human&quot;</span><span class=p>,</span> <span class=n>human_input_mode</span><span class=o>=</span><span class=s2>&quot;ALWAYS&quot;</span><span class=p>)</span>
<a id=__codelineno-0-10 name=__codelineno-0-10 href=#__codelineno-0-10></a>
<a id=__codelineno-0-11 name=__codelineno-0-11 href=#__codelineno-0-11></a><span class=c1># Initialize the swarm</span>
<a id=__codelineno-0-12 name=__codelineno-0-12 href=#__codelineno-0-12></a><span class=hll><span class=n>result</span><span class=p>,</span> <span class=n>_</span><span class=p>,</span> <span class=n>_</span> <span class=o>=</span> <span class=n>initiate_swarm_chat</span><span class=p>(</span>
</span><a id=__codelineno-0-13 name=__codelineno-0-13 href=#__codelineno-0-13></a><span class=hll>    <span class=n>initial_agent</span><span class=o>=</span><span class=n>agent_1</span><span class=p>,</span>              <span class=c1># Agent that starts the workflow</span>
</span><a id=__codelineno-0-14 name=__codelineno-0-14 href=#__codelineno-0-14></a><span class=hll>    <span class=n>agents</span><span class=o>=</span><span class=p>[</span><span class=n>agent_1</span><span class=p>,</span> <span class=n>agent_2</span><span class=p>,</span> <span class=n>human</span><span class=p>],</span>   <span class=c1># All agents in the swarm</span>
</span><a id=__codelineno-0-15 name=__codelineno-0-15 href=#__codelineno-0-15></a><span class=hll>    <span class=n>messages</span><span class=o>=</span><span class=s2>&quot;Initial request&quot;</span><span class=p>,</span>         <span class=c1># Starting message</span>
</span><a id=__codelineno-0-16 name=__codelineno-0-16 href=#__codelineno-0-16></a><span class=hll>    <span class=n>swarm_manager_args</span><span class=o>=</span><span class=p>{</span><span class=s2>&quot;llm_config&quot;</span><span class=p>:</span> <span class=n>llm_config</span><span class=p>},</span>  <span class=c1># Config for swarm manager</span>
</span><a id=__codelineno-0-17 name=__codelineno-0-17 href=#__codelineno-0-17></a><span class=hll>    <span class=n>after_work</span><span class=o>=</span><span class=n>AfterWorkOption</span><span class=o>.</span><span class=n>SWARM_MANAGER</span>        <span class=c1># Revert to swarm manager after an agent finishes</span>
</span><a id=__codelineno-0-18 name=__codelineno-0-18 href=#__codelineno-0-18></a><span class=hll><span class=p>)</span>
</span></code></pre></div> <p><strong>The AfterWork Concept:</strong></p> <p>A core component to the swarm pattern is the concept of "AfterWork" - what happens after an agent completes its task. This is what makes swarms powerful and flexible:</p> <ul> <li>Each agent performs its specialized task, then control needs to pass somewhere</li> <li>The AfterWork mechanism determines where control goes next: to another agent, back to a manager, to a human, or simply end</li> <li>This creates dynamic, intelligent workflows that can adapt based on the results of each step</li> </ul> <h2 id=enhancing-our-financial-compliance-system-with-swarm>Enhancing Our Financial Compliance System with Swarm<a class=headerlink href=#enhancing-our-financial-compliance-system-with-swarm title="Permanent link">#</a></h2> <p>Now that we understand the swarm pattern, let's see how it solves our challenge of adding specialized summary reporting to our financial compliance system.</p> <h3 id=the-challenge>The Challenge<a class=headerlink href=#the-challenge title="Permanent link">#</a></h3> <p>In our Human in the Loop example, we built a <code>finance_bot</code> that could process transactions and get human approval for suspicious ones. However, we now need professional, formatted summary reports of all the transactions.</p> <h3 id=our-swarm-solution>Our Swarm Solution<a class=headerlink href=#our-swarm-solution title="Permanent link">#</a></h3> <p>Here's how we'll enhance our system:</p> <ul> <li>Keep the <code>finance_bot</code> focused on transaction processing and human approval</li> <li>Create a new <code>summary_bot</code> specialized in generating formatted transaction reports</li> <li>Use the swarm pattern to automatically transition from <code>finance_bot</code> to <code>summary_bot</code> when all transactions are processed</li> <li>Maintain human oversight for suspicious transaction approval and to terminate the conversation</li> </ul> <h3 id=implementation-creating-the-necessary-agents>Implementation: Creating the Necessary Agents<a class=headerlink href=#implementation-creating-the-necessary-agents title="Permanent link">#</a></h3> <p>Let's create our specialized agents for the financial compliance swarm:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a><span class=kn>from</span><span class=w> </span><span class=nn>autogen</span><span class=w> </span><span class=kn>import</span> <span class=n>ConversableAgent</span><span class=p>,</span> <span class=n>AfterWorkOption</span><span class=p>,</span> <span class=n>initiate_swarm_chat</span><span class=p>,</span> <span class=n>LLMConfig</span>
<a id=__codelineno-1-2 name=__codelineno-1-2 href=#__codelineno-1-2></a>
<a id=__codelineno-1-3 name=__codelineno-1-3 href=#__codelineno-1-3></a><span class=kn>import</span><span class=w> </span><span class=nn>os</span>
<a id=__codelineno-1-4 name=__codelineno-1-4 href=#__codelineno-1-4></a><span class=kn>import</span><span class=w> </span><span class=nn>random</span>
<a id=__codelineno-1-5 name=__codelineno-1-5 href=#__codelineno-1-5></a>
<a id=__codelineno-1-6 name=__codelineno-1-6 href=#__codelineno-1-6></a><span class=c1># Note: Make sure to set your API key in your environment first</span>
<a id=__codelineno-1-7 name=__codelineno-1-7 href=#__codelineno-1-7></a>
<a id=__codelineno-1-8 name=__codelineno-1-8 href=#__codelineno-1-8></a><span class=c1># Configure the LLM</span>
<a id=__codelineno-1-9 name=__codelineno-1-9 href=#__codelineno-1-9></a><span class=n>llm_config</span> <span class=o>=</span> <span class=n>LLMConfig</span><span class=p>(</span>
<a id=__codelineno-1-10 name=__codelineno-1-10 href=#__codelineno-1-10></a>    <span class=n>api_type</span><span class=o>=</span><span class=s2>&quot;openai&quot;</span><span class=p>,</span>
<a id=__codelineno-1-11 name=__codelineno-1-11 href=#__codelineno-1-11></a>    <span class=n>model</span><span class=o>=</span><span class=s2>&quot;gpt-4o-mini&quot;</span><span class=p>,</span>
<a id=__codelineno-1-12 name=__codelineno-1-12 href=#__codelineno-1-12></a>    <span class=n>api_key</span><span class=o>=</span><span class=n>os</span><span class=o>.</span><span class=n>environ</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;OPENAI_API_KEY&quot;</span><span class=p>),</span>
<a id=__codelineno-1-13 name=__codelineno-1-13 href=#__codelineno-1-13></a>    <span class=n>temperature</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span>
<a id=__codelineno-1-14 name=__codelineno-1-14 href=#__codelineno-1-14></a><span class=p>)</span>
<a id=__codelineno-1-15 name=__codelineno-1-15 href=#__codelineno-1-15></a>
<a id=__codelineno-1-16 name=__codelineno-1-16 href=#__codelineno-1-16></a><span class=c1># Define the system message for our finance bot</span>
<a id=__codelineno-1-17 name=__codelineno-1-17 href=#__codelineno-1-17></a><span class=n>finance_system_message</span> <span class=o>=</span> <span class=s2>&quot;&quot;&quot;</span>
<a id=__codelineno-1-18 name=__codelineno-1-18 href=#__codelineno-1-18></a><span class=s2>You are a financial compliance assistant. You will be given a set of transaction descriptions.</span>
<a id=__codelineno-1-19 name=__codelineno-1-19 href=#__codelineno-1-19></a><span class=s2>For each transaction:</span>
<a id=__codelineno-1-20 name=__codelineno-1-20 href=#__codelineno-1-20></a><span class=s2>- If it seems suspicious (e.g., amount &gt; $10,000, vendor is unusual, memo is vague), ask the human agent for approval.</span>
<a id=__codelineno-1-21 name=__codelineno-1-21 href=#__codelineno-1-21></a><span class=s2>- Otherwise, approve it automatically.</span>
<a id=__codelineno-1-22 name=__codelineno-1-22 href=#__codelineno-1-22></a><span class=s2>Provide the full set of transactions to approve at one time.</span>
<a id=__codelineno-1-23 name=__codelineno-1-23 href=#__codelineno-1-23></a><span class=s2>If the human gives a general approval, it applies to all transactions requiring approval.</span>
<a id=__codelineno-1-24 name=__codelineno-1-24 href=#__codelineno-1-24></a><span class=s2>When all transactions are processed, summarize the results and say &quot;You can type exit to finish&quot;.</span>
<a id=__codelineno-1-25 name=__codelineno-1-25 href=#__codelineno-1-25></a><span class=s2>&quot;&quot;&quot;</span>
<a id=__codelineno-1-26 name=__codelineno-1-26 href=#__codelineno-1-26></a>
<a id=__codelineno-1-27 name=__codelineno-1-27 href=#__codelineno-1-27></a><span class=c1># Define the system message for the summary agent</span>
<a id=__codelineno-1-28 name=__codelineno-1-28 href=#__codelineno-1-28></a><span class=n>summary_system_message</span> <span class=o>=</span> <span class=s2>&quot;&quot;&quot;</span>
<a id=__codelineno-1-29 name=__codelineno-1-29 href=#__codelineno-1-29></a><span class=hll><span class=s2>You are a financial summary assistant. You will be given a set of transaction details and their approval status.</span>
</span><a id=__codelineno-1-30 name=__codelineno-1-30 href=#__codelineno-1-30></a><span class=hll><span class=s2>Your task is to summarize the results of the transactions processed by the finance bot.</span>
</span><a id=__codelineno-1-31 name=__codelineno-1-31 href=#__codelineno-1-31></a><span class=hll><span class=s2>Generate a markdown table with the following columns:</span>
</span><a id=__codelineno-1-32 name=__codelineno-1-32 href=#__codelineno-1-32></a><span class=hll><span class=s2>- Vendor</span>
</span><a id=__codelineno-1-33 name=__codelineno-1-33 href=#__codelineno-1-33></a><span class=hll><span class=s2>- Memo</span>
</span><a id=__codelineno-1-34 name=__codelineno-1-34 href=#__codelineno-1-34></a><span class=hll><span class=s2>- Amount</span>
</span><a id=__codelineno-1-35 name=__codelineno-1-35 href=#__codelineno-1-35></a><span class=hll><span class=s2>- Status (Approved/Rejected)</span>
</span><a id=__codelineno-1-36 name=__codelineno-1-36 href=#__codelineno-1-36></a><span class=hll><span class=s2>The summary should include the total number of transactions, the number of approved transactions, and the number of rejected transactions.</span>
</span><a id=__codelineno-1-37 name=__codelineno-1-37 href=#__codelineno-1-37></a><span class=hll><span class=s2>The summary should be concise and clear.</span>
</span><a id=__codelineno-1-38 name=__codelineno-1-38 href=#__codelineno-1-38></a><span class=hll><span class=s2>&quot;&quot;&quot;</span>
</span><a id=__codelineno-1-39 name=__codelineno-1-39 href=#__codelineno-1-39></a><span class=hll>
</span><a id=__codelineno-1-40 name=__codelineno-1-40 href=#__codelineno-1-40></a><span class=c1># Create the finance agent with LLM intelligence</span>
<a id=__codelineno-1-41 name=__codelineno-1-41 href=#__codelineno-1-41></a><span class=k>with</span> <span class=n>llm_config</span><span class=p>:</span>
<a id=__codelineno-1-42 name=__codelineno-1-42 href=#__codelineno-1-42></a>    <span class=n>finance_bot</span> <span class=o>=</span> <span class=n>ConversableAgent</span><span class=p>(</span>
<a id=__codelineno-1-43 name=__codelineno-1-43 href=#__codelineno-1-43></a>        <span class=n>name</span><span class=o>=</span><span class=s2>&quot;finance_bot&quot;</span><span class=p>,</span>
<a id=__codelineno-1-44 name=__codelineno-1-44 href=#__codelineno-1-44></a>        <span class=n>system_message</span><span class=o>=</span><span class=n>finance_system_message</span><span class=p>,</span>
<a id=__codelineno-1-45 name=__codelineno-1-45 href=#__codelineno-1-45></a>    <span class=p>)</span>
<a id=__codelineno-1-46 name=__codelineno-1-46 href=#__codelineno-1-46></a>    <span class=n>summary_bot</span> <span class=o>=</span> <span class=n>ConversableAgent</span><span class=p>(</span>
<a id=__codelineno-1-47 name=__codelineno-1-47 href=#__codelineno-1-47></a><span class=hll>        <span class=n>name</span><span class=o>=</span><span class=s2>&quot;summary_bot&quot;</span><span class=p>,</span>
</span><a id=__codelineno-1-48 name=__codelineno-1-48 href=#__codelineno-1-48></a><span class=hll>        <span class=n>system_message</span><span class=o>=</span><span class=n>summary_system_message</span><span class=p>,</span>
</span><a id=__codelineno-1-49 name=__codelineno-1-49 href=#__codelineno-1-49></a><span class=hll>    <span class=p>)</span>
</span><a id=__codelineno-1-50 name=__codelineno-1-50 href=#__codelineno-1-50></a><span class=hll>
</span><a id=__codelineno-1-51 name=__codelineno-1-51 href=#__codelineno-1-51></a><span class=c1># Create the human agent for oversight</span>
<a id=__codelineno-1-52 name=__codelineno-1-52 href=#__codelineno-1-52></a><span class=n>human</span> <span class=o>=</span> <span class=n>ConversableAgent</span><span class=p>(</span>
<a id=__codelineno-1-53 name=__codelineno-1-53 href=#__codelineno-1-53></a>    <span class=n>name</span><span class=o>=</span><span class=s2>&quot;human&quot;</span><span class=p>,</span>
<a id=__codelineno-1-54 name=__codelineno-1-54 href=#__codelineno-1-54></a>    <span class=n>human_input_mode</span><span class=o>=</span><span class=s2>&quot;ALWAYS&quot;</span><span class=p>,</span>  <span class=c1># Always ask for human input</span>
<a id=__codelineno-1-55 name=__codelineno-1-55 href=#__codelineno-1-55></a><span class=p>)</span>
</code></pre></div> <h3 id=initiating-the-swarm>Initiating the Swarm<a class=headerlink href=#initiating-the-swarm title="Permanent link">#</a></h3> <p>Now let's set up our swarm chat with these specialized agents:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-2-1 name=__codelineno-2-1 href=#__codelineno-2-1></a><span class=c1># Generate sample transactions - this creates different transactions each time you run</span>
<a id=__codelineno-2-2 name=__codelineno-2-2 href=#__codelineno-2-2></a><span class=n>VENDORS</span> <span class=o>=</span> <span class=p>[</span><span class=s2>&quot;Staples&quot;</span><span class=p>,</span> <span class=s2>&quot;Acme Corp&quot;</span><span class=p>,</span> <span class=s2>&quot;CyberSins Ltd&quot;</span><span class=p>,</span> <span class=s2>&quot;Initech&quot;</span><span class=p>,</span> <span class=s2>&quot;Globex&quot;</span><span class=p>,</span> <span class=s2>&quot;Unicorn LLC&quot;</span><span class=p>]</span>
<a id=__codelineno-2-3 name=__codelineno-2-3 href=#__codelineno-2-3></a><span class=n>MEMOS</span> <span class=o>=</span> <span class=p>[</span><span class=s2>&quot;Quarterly supplies&quot;</span><span class=p>,</span> <span class=s2>&quot;Confidential&quot;</span><span class=p>,</span> <span class=s2>&quot;NDA services&quot;</span><span class=p>,</span> <span class=s2>&quot;Routine payment&quot;</span><span class=p>,</span> <span class=s2>&quot;Urgent request&quot;</span><span class=p>,</span> <span class=s2>&quot;Reimbursement&quot;</span><span class=p>]</span>
<a id=__codelineno-2-4 name=__codelineno-2-4 href=#__codelineno-2-4></a>
<a id=__codelineno-2-5 name=__codelineno-2-5 href=#__codelineno-2-5></a><span class=k>def</span><span class=w> </span><span class=nf>generate_transaction</span><span class=p>():</span>
<a id=__codelineno-2-6 name=__codelineno-2-6 href=#__codelineno-2-6></a>    <span class=n>amount</span> <span class=o>=</span> <span class=n>random</span><span class=o>.</span><span class=n>choice</span><span class=p>([</span><span class=mi>500</span><span class=p>,</span> <span class=mi>1500</span><span class=p>,</span> <span class=mi>9999</span><span class=p>,</span> <span class=mi>12000</span><span class=p>,</span> <span class=mi>23000</span><span class=p>,</span> <span class=mi>4000</span><span class=p>])</span>
<a id=__codelineno-2-7 name=__codelineno-2-7 href=#__codelineno-2-7></a>    <span class=n>vendor</span> <span class=o>=</span> <span class=n>random</span><span class=o>.</span><span class=n>choice</span><span class=p>(</span><span class=n>VENDORS</span><span class=p>)</span>
<a id=__codelineno-2-8 name=__codelineno-2-8 href=#__codelineno-2-8></a>    <span class=n>memo</span> <span class=o>=</span> <span class=n>random</span><span class=o>.</span><span class=n>choice</span><span class=p>(</span><span class=n>MEMOS</span><span class=p>)</span>
<a id=__codelineno-2-9 name=__codelineno-2-9 href=#__codelineno-2-9></a>    <span class=k>return</span> <span class=sa>f</span><span class=s2>&quot;Transaction: $</span><span class=si>{</span><span class=n>amount</span><span class=si>}</span><span class=s2> to </span><span class=si>{</span><span class=n>vendor</span><span class=si>}</span><span class=s2>. Memo: </span><span class=si>{</span><span class=n>memo</span><span class=si>}</span><span class=s2>.&quot;</span>
<a id=__codelineno-2-10 name=__codelineno-2-10 href=#__codelineno-2-10></a>
<a id=__codelineno-2-11 name=__codelineno-2-11 href=#__codelineno-2-11></a><span class=c1># Generate 3 random transactions</span>
<a id=__codelineno-2-12 name=__codelineno-2-12 href=#__codelineno-2-12></a><span class=n>transactions</span> <span class=o>=</span> <span class=p>[</span><span class=n>generate_transaction</span><span class=p>()</span> <span class=k>for</span> <span class=n>_</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>3</span><span class=p>)]</span>
<a id=__codelineno-2-13 name=__codelineno-2-13 href=#__codelineno-2-13></a>
<a id=__codelineno-2-14 name=__codelineno-2-14 href=#__codelineno-2-14></a><span class=c1># Format the initial message</span>
<a id=__codelineno-2-15 name=__codelineno-2-15 href=#__codelineno-2-15></a><span class=n>initial_prompt</span> <span class=o>=</span> <span class=p>(</span>
<a id=__codelineno-2-16 name=__codelineno-2-16 href=#__codelineno-2-16></a>    <span class=s2>&quot;Please process the following transactions one at a time:</span><span class=se>\n\n</span><span class=s2>&quot;</span> <span class=o>+</span>
<a id=__codelineno-2-17 name=__codelineno-2-17 href=#__codelineno-2-17></a>    <span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span><span class=o>.</span><span class=n>join</span><span class=p>([</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>i</span><span class=o>+</span><span class=mi>1</span><span class=si>}</span><span class=s2>. </span><span class=si>{</span><span class=n>tx</span><span class=si>}</span><span class=s2>&quot;</span> <span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=n>tx</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>transactions</span><span class=p>)])</span>
<a id=__codelineno-2-18 name=__codelineno-2-18 href=#__codelineno-2-18></a><span class=p>)</span>
<a id=__codelineno-2-19 name=__codelineno-2-19 href=#__codelineno-2-19></a>
<a id=__codelineno-2-20 name=__codelineno-2-20 href=#__codelineno-2-20></a><span class=c1># Initialize the swarm chat</span>
<a id=__codelineno-2-21 name=__codelineno-2-21 href=#__codelineno-2-21></a><span class=hll><span class=n>result</span><span class=p>,</span> <span class=n>_</span><span class=p>,</span> <span class=n>_</span> <span class=o>=</span> <span class=n>initiate_swarm_chat</span><span class=p>(</span>
</span><a id=__codelineno-2-22 name=__codelineno-2-22 href=#__codelineno-2-22></a><span class=hll>    <span class=n>initial_agent</span><span class=o>=</span><span class=n>finance_bot</span><span class=p>,</span>                       <span class=c1># Start with the finance bot</span>
</span><a id=__codelineno-2-23 name=__codelineno-2-23 href=#__codelineno-2-23></a><span class=hll>    <span class=n>agents</span><span class=o>=</span><span class=p>[</span><span class=n>finance_bot</span><span class=p>,</span> <span class=n>summary_bot</span><span class=p>],</span>               <span class=c1># All agents in the swarm</span>
</span><a id=__codelineno-2-24 name=__codelineno-2-24 href=#__codelineno-2-24></a><span class=hll>    <span class=n>user_agent</span><span class=o>=</span><span class=n>human</span><span class=p>,</span>                                <span class=c1># Provide our human in the loop agent to the swarm</span>
</span><a id=__codelineno-2-25 name=__codelineno-2-25 href=#__codelineno-2-25></a><span class=hll>    <span class=n>messages</span><span class=o>=</span><span class=n>initial_prompt</span><span class=p>,</span>                         <span class=c1># Initial request with transactions</span>
</span><a id=__codelineno-2-26 name=__codelineno-2-26 href=#__codelineno-2-26></a><span class=hll>    <span class=n>swarm_manager_args</span><span class=o>=</span><span class=p>{</span><span class=s2>&quot;llm_config&quot;</span><span class=p>:</span> <span class=n>llm_config</span><span class=p>},</span>   <span class=c1># Config for swarm manager</span>
</span><a id=__codelineno-2-27 name=__codelineno-2-27 href=#__codelineno-2-27></a><span class=hll>    <span class=n>after_work</span><span class=o>=</span><span class=n>AfterWorkOption</span><span class=o>.</span><span class=n>SWARM_MANAGER</span>         <span class=c1># Use swarm manager for transitions</span>
</span><a id=__codelineno-2-28 name=__codelineno-2-28 href=#__codelineno-2-28></a><span class=p>)</span>
</code></pre></div> <h3 id=understanding-the-swarm-workflow>Understanding the Swarm Workflow<a class=headerlink href=#understanding-the-swarm-workflow title="Permanent link">#</a></h3> <p>When we run this enhanced financial compliance system, here's what happens:</p> <pre class=mermaid><code>flowchart TD
    User([User]) --&gt; |"Submits transactions"| SwarmOrch[Swarm Orchestration]
    SwarmOrch --&gt; |"Passes to initial agent"| Finance[Finance Bot]
    Finance --&gt; |"Requests approval for suspicious transactions"| Human[Human Agent]
    Human --&gt; |"Approves/rejects transactions"| Finance

    Finance --&gt; |"Completes work without specifying next agent"| SwarmManager[Swarm Manager]
    SwarmManager --&gt; |"Analyzes conversation context and selects appropriate agent"| Summary[Summary Bot]

    Summary --&gt; |"Generates report"| Human
    Human --&gt; |"Reviews &amp; exits"| End([End])

    style SwarmOrch fill:#fff0f5,stroke:#ff69b4
    style Finance fill:#e3f2fd,stroke:#1976d2
    style Human fill:#f3e5f5,stroke:#7b1fa2
    style Summary fill:#e8f5e9,stroke:#4caf50
    style SwarmManager fill:#ffebee,stroke:#f44336</code></pre> <ul> <li> <p><strong>Initial Processing</strong>: The <code>finance_bot</code> analyzes each transaction</p> <ul> <li>Regular transactions are automatically approved</li> <li>Suspicious transactions are flagged for human review</li> </ul> </li> <li> <p><strong>Human Review</strong>: The human agent reviews flagged transactions</p> <ul> <li>The human can approve or reject each transaction</li> <li>This provides the crucial oversight required for compliance</li> </ul> </li> <li> <p><strong>Handoff to Summary Agent</strong>: After all transactions are processed, the swarm manager transitions control to the <code>summary_bot</code></p> <ul> <li>This transition happens automatically based on conversation context</li> <li>The <code>summary_bot</code> has access to the full conversation history</li> </ul> </li> <li> <p><strong>Report Generation</strong>: The <code>summary_bot</code> creates a report summarizing all transactions in a markdown table</p> </li> <li> <p><strong>Final Review</strong>: The human agent reviews the summary and terminates the conversation</p> </li> </ul> <h3 id=complete-code-example>Complete Code Example<a class=headerlink href=#complete-code-example title="Permanent link">#</a></h3> <p>Here's the complete, ready-to-run code for our enhanced financial compliance system using the swarm pattern:</p> <details class=info open=open> <summary>Complete Code Example</summary> <div class=highlight><pre><span></span><code><a id=__codelineno-3-1 name=__codelineno-3-1 href=#__codelineno-3-1></a><span class=kn>from</span><span class=w> </span><span class=nn>autogen</span><span class=w> </span><span class=kn>import</span> <span class=n>ConversableAgent</span><span class=p>,</span> <span class=n>AfterWorkOption</span><span class=p>,</span> <span class=n>initiate_swarm_chat</span><span class=p>,</span> <span class=n>LLMConfig</span>
<a id=__codelineno-3-2 name=__codelineno-3-2 href=#__codelineno-3-2></a>
<a id=__codelineno-3-3 name=__codelineno-3-3 href=#__codelineno-3-3></a><span class=kn>import</span><span class=w> </span><span class=nn>os</span>
<a id=__codelineno-3-4 name=__codelineno-3-4 href=#__codelineno-3-4></a><span class=kn>import</span><span class=w> </span><span class=nn>random</span>
<a id=__codelineno-3-5 name=__codelineno-3-5 href=#__codelineno-3-5></a>
<a id=__codelineno-3-6 name=__codelineno-3-6 href=#__codelineno-3-6></a><span class=c1># Note: Make sure to set your API key in your environment first</span>
<a id=__codelineno-3-7 name=__codelineno-3-7 href=#__codelineno-3-7></a>
<a id=__codelineno-3-8 name=__codelineno-3-8 href=#__codelineno-3-8></a><span class=c1># Configure the LLM</span>
<a id=__codelineno-3-9 name=__codelineno-3-9 href=#__codelineno-3-9></a><span class=n>llm_config</span> <span class=o>=</span> <span class=n>LLMConfig</span><span class=p>(</span>
<a id=__codelineno-3-10 name=__codelineno-3-10 href=#__codelineno-3-10></a>    <span class=n>api_type</span><span class=o>=</span><span class=s2>&quot;openai&quot;</span><span class=p>,</span>
<a id=__codelineno-3-11 name=__codelineno-3-11 href=#__codelineno-3-11></a>    <span class=n>model</span><span class=o>=</span><span class=s2>&quot;gpt-4o-mini&quot;</span><span class=p>,</span>
<a id=__codelineno-3-12 name=__codelineno-3-12 href=#__codelineno-3-12></a>    <span class=n>api_key</span><span class=o>=</span><span class=n>os</span><span class=o>.</span><span class=n>environ</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;OPENAI_API_KEY&quot;</span><span class=p>),</span>
<a id=__codelineno-3-13 name=__codelineno-3-13 href=#__codelineno-3-13></a>    <span class=n>temperature</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span>
<a id=__codelineno-3-14 name=__codelineno-3-14 href=#__codelineno-3-14></a>    <span class=n>cache_seed</span><span class=o>=</span><span class=mi>42</span>
<a id=__codelineno-3-15 name=__codelineno-3-15 href=#__codelineno-3-15></a><span class=p>)</span>
<a id=__codelineno-3-16 name=__codelineno-3-16 href=#__codelineno-3-16></a>
<a id=__codelineno-3-17 name=__codelineno-3-17 href=#__codelineno-3-17></a><span class=c1># Define the system message for our finance bot</span>
<a id=__codelineno-3-18 name=__codelineno-3-18 href=#__codelineno-3-18></a><span class=n>finance_system_message</span> <span class=o>=</span> <span class=s2>&quot;&quot;&quot;</span>
<a id=__codelineno-3-19 name=__codelineno-3-19 href=#__codelineno-3-19></a><span class=s2>You are a financial compliance assistant. You will be given a set of transaction descriptions.</span>
<a id=__codelineno-3-20 name=__codelineno-3-20 href=#__codelineno-3-20></a><span class=s2>For each transaction:</span>
<a id=__codelineno-3-21 name=__codelineno-3-21 href=#__codelineno-3-21></a><span class=s2>- If it seems suspicious (e.g., amount &gt; $10,000, vendor is unusual, memo is vague), ask the human agent for approval.</span>
<a id=__codelineno-3-22 name=__codelineno-3-22 href=#__codelineno-3-22></a><span class=s2>- Otherwise, approve it automatically.</span>
<a id=__codelineno-3-23 name=__codelineno-3-23 href=#__codelineno-3-23></a><span class=s2>Provide the full set of transactions to approve at one time.</span>
<a id=__codelineno-3-24 name=__codelineno-3-24 href=#__codelineno-3-24></a><span class=s2>If the human gives a general approval, it applies to all transactions requiring approval.</span>
<a id=__codelineno-3-25 name=__codelineno-3-25 href=#__codelineno-3-25></a><span class=s2>When all transactions are processed, summarize the results and say &quot;You can type exit to finish&quot;.</span>
<a id=__codelineno-3-26 name=__codelineno-3-26 href=#__codelineno-3-26></a><span class=s2>&quot;&quot;&quot;</span>
<a id=__codelineno-3-27 name=__codelineno-3-27 href=#__codelineno-3-27></a>
<a id=__codelineno-3-28 name=__codelineno-3-28 href=#__codelineno-3-28></a><span class=c1># Define the system message for the summary agent</span>
<a id=__codelineno-3-29 name=__codelineno-3-29 href=#__codelineno-3-29></a><span class=n>summary_system_message</span> <span class=o>=</span> <span class=s2>&quot;&quot;&quot;</span>
<a id=__codelineno-3-30 name=__codelineno-3-30 href=#__codelineno-3-30></a><span class=s2>You are a financial summary assistant. You will be given a set of transaction details and their approval status.</span>
<a id=__codelineno-3-31 name=__codelineno-3-31 href=#__codelineno-3-31></a><span class=s2>Your task is to summarize the results of the transactions processed by the finance bot.</span>
<a id=__codelineno-3-32 name=__codelineno-3-32 href=#__codelineno-3-32></a><span class=s2>Generate a markdown table with the following columns:</span>
<a id=__codelineno-3-33 name=__codelineno-3-33 href=#__codelineno-3-33></a><span class=s2>- Vendor</span>
<a id=__codelineno-3-34 name=__codelineno-3-34 href=#__codelineno-3-34></a><span class=s2>- Memo</span>
<a id=__codelineno-3-35 name=__codelineno-3-35 href=#__codelineno-3-35></a><span class=s2>- Amount</span>
<a id=__codelineno-3-36 name=__codelineno-3-36 href=#__codelineno-3-36></a><span class=s2>- Status (Approved/Rejected)</span>
<a id=__codelineno-3-37 name=__codelineno-3-37 href=#__codelineno-3-37></a><span class=s2>The summary should include the total number of transactions, the number of approved transactions, and the number of rejected transactions.</span>
<a id=__codelineno-3-38 name=__codelineno-3-38 href=#__codelineno-3-38></a><span class=s2>The summary should be concise and clear.</span>
<a id=__codelineno-3-39 name=__codelineno-3-39 href=#__codelineno-3-39></a><span class=s2>&quot;&quot;&quot;</span>
<a id=__codelineno-3-40 name=__codelineno-3-40 href=#__codelineno-3-40></a>
<a id=__codelineno-3-41 name=__codelineno-3-41 href=#__codelineno-3-41></a><span class=c1># Create the finance agent with LLM intelligence</span>
<a id=__codelineno-3-42 name=__codelineno-3-42 href=#__codelineno-3-42></a><span class=k>with</span> <span class=n>llm_config</span><span class=p>:</span>
<a id=__codelineno-3-43 name=__codelineno-3-43 href=#__codelineno-3-43></a>    <span class=n>finance_bot</span> <span class=o>=</span> <span class=n>ConversableAgent</span><span class=p>(</span>
<a id=__codelineno-3-44 name=__codelineno-3-44 href=#__codelineno-3-44></a>        <span class=n>name</span><span class=o>=</span><span class=s2>&quot;finance_bot&quot;</span><span class=p>,</span>
<a id=__codelineno-3-45 name=__codelineno-3-45 href=#__codelineno-3-45></a>        <span class=n>system_message</span><span class=o>=</span><span class=n>finance_system_message</span><span class=p>,</span>
<a id=__codelineno-3-46 name=__codelineno-3-46 href=#__codelineno-3-46></a>    <span class=p>)</span>
<a id=__codelineno-3-47 name=__codelineno-3-47 href=#__codelineno-3-47></a>    <span class=n>summary_bot</span> <span class=o>=</span> <span class=n>ConversableAgent</span><span class=p>(</span>
<a id=__codelineno-3-48 name=__codelineno-3-48 href=#__codelineno-3-48></a>        <span class=n>name</span><span class=o>=</span><span class=s2>&quot;summary_bot&quot;</span><span class=p>,</span>
<a id=__codelineno-3-49 name=__codelineno-3-49 href=#__codelineno-3-49></a>        <span class=n>system_message</span><span class=o>=</span><span class=n>summary_system_message</span><span class=p>,</span>
<a id=__codelineno-3-50 name=__codelineno-3-50 href=#__codelineno-3-50></a>    <span class=p>)</span>
<a id=__codelineno-3-51 name=__codelineno-3-51 href=#__codelineno-3-51></a>
<a id=__codelineno-3-52 name=__codelineno-3-52 href=#__codelineno-3-52></a><span class=c1># Create the human agent for oversight</span>
<a id=__codelineno-3-53 name=__codelineno-3-53 href=#__codelineno-3-53></a><span class=n>human</span> <span class=o>=</span> <span class=n>ConversableAgent</span><span class=p>(</span>
<a id=__codelineno-3-54 name=__codelineno-3-54 href=#__codelineno-3-54></a>    <span class=n>name</span><span class=o>=</span><span class=s2>&quot;human&quot;</span><span class=p>,</span>
<a id=__codelineno-3-55 name=__codelineno-3-55 href=#__codelineno-3-55></a>    <span class=n>human_input_mode</span><span class=o>=</span><span class=s2>&quot;ALWAYS&quot;</span><span class=p>,</span>  <span class=c1># Always ask for human input</span>
<a id=__codelineno-3-56 name=__codelineno-3-56 href=#__codelineno-3-56></a><span class=p>)</span>
<a id=__codelineno-3-57 name=__codelineno-3-57 href=#__codelineno-3-57></a>
<a id=__codelineno-3-58 name=__codelineno-3-58 href=#__codelineno-3-58></a><span class=c1># Generate sample transactions - this creates different transactions each time you run</span>
<a id=__codelineno-3-59 name=__codelineno-3-59 href=#__codelineno-3-59></a><span class=n>VENDORS</span> <span class=o>=</span> <span class=p>[</span><span class=s2>&quot;Staples&quot;</span><span class=p>,</span> <span class=s2>&quot;Acme Corp&quot;</span><span class=p>,</span> <span class=s2>&quot;CyberSins Ltd&quot;</span><span class=p>,</span> <span class=s2>&quot;Initech&quot;</span><span class=p>,</span> <span class=s2>&quot;Globex&quot;</span><span class=p>,</span> <span class=s2>&quot;Unicorn LLC&quot;</span><span class=p>]</span>
<a id=__codelineno-3-60 name=__codelineno-3-60 href=#__codelineno-3-60></a><span class=n>MEMOS</span> <span class=o>=</span> <span class=p>[</span><span class=s2>&quot;Quarterly supplies&quot;</span><span class=p>,</span> <span class=s2>&quot;Confidential&quot;</span><span class=p>,</span> <span class=s2>&quot;NDA services&quot;</span><span class=p>,</span> <span class=s2>&quot;Routine payment&quot;</span><span class=p>,</span> <span class=s2>&quot;Urgent request&quot;</span><span class=p>,</span> <span class=s2>&quot;Reimbursement&quot;</span><span class=p>]</span>
<a id=__codelineno-3-61 name=__codelineno-3-61 href=#__codelineno-3-61></a>
<a id=__codelineno-3-62 name=__codelineno-3-62 href=#__codelineno-3-62></a><span class=k>def</span><span class=w> </span><span class=nf>generate_transaction</span><span class=p>():</span>
<a id=__codelineno-3-63 name=__codelineno-3-63 href=#__codelineno-3-63></a>    <span class=n>amount</span> <span class=o>=</span> <span class=n>random</span><span class=o>.</span><span class=n>choice</span><span class=p>([</span><span class=mi>500</span><span class=p>,</span> <span class=mi>1500</span><span class=p>,</span> <span class=mi>9999</span><span class=p>,</span> <span class=mi>12000</span><span class=p>,</span> <span class=mi>23000</span><span class=p>,</span> <span class=mi>4000</span><span class=p>])</span>
<a id=__codelineno-3-64 name=__codelineno-3-64 href=#__codelineno-3-64></a>    <span class=n>vendor</span> <span class=o>=</span> <span class=n>random</span><span class=o>.</span><span class=n>choice</span><span class=p>(</span><span class=n>VENDORS</span><span class=p>)</span>
<a id=__codelineno-3-65 name=__codelineno-3-65 href=#__codelineno-3-65></a>    <span class=n>memo</span> <span class=o>=</span> <span class=n>random</span><span class=o>.</span><span class=n>choice</span><span class=p>(</span><span class=n>MEMOS</span><span class=p>)</span>
<a id=__codelineno-3-66 name=__codelineno-3-66 href=#__codelineno-3-66></a>    <span class=k>return</span> <span class=sa>f</span><span class=s2>&quot;Transaction: $</span><span class=si>{</span><span class=n>amount</span><span class=si>}</span><span class=s2> to </span><span class=si>{</span><span class=n>vendor</span><span class=si>}</span><span class=s2>. Memo: </span><span class=si>{</span><span class=n>memo</span><span class=si>}</span><span class=s2>.&quot;</span>
<a id=__codelineno-3-67 name=__codelineno-3-67 href=#__codelineno-3-67></a>
<a id=__codelineno-3-68 name=__codelineno-3-68 href=#__codelineno-3-68></a><span class=c1># Generate 3 random transactions</span>
<a id=__codelineno-3-69 name=__codelineno-3-69 href=#__codelineno-3-69></a><span class=n>transactions</span> <span class=o>=</span> <span class=p>[</span><span class=n>generate_transaction</span><span class=p>()</span> <span class=k>for</span> <span class=n>_</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>3</span><span class=p>)]</span>
<a id=__codelineno-3-70 name=__codelineno-3-70 href=#__codelineno-3-70></a>
<a id=__codelineno-3-71 name=__codelineno-3-71 href=#__codelineno-3-71></a><span class=c1># Format the initial message</span>
<a id=__codelineno-3-72 name=__codelineno-3-72 href=#__codelineno-3-72></a><span class=n>initial_prompt</span> <span class=o>=</span> <span class=p>(</span>
<a id=__codelineno-3-73 name=__codelineno-3-73 href=#__codelineno-3-73></a>    <span class=s2>&quot;Please process the following transactions one at a time:</span><span class=se>\n\n</span><span class=s2>&quot;</span> <span class=o>+</span>
<a id=__codelineno-3-74 name=__codelineno-3-74 href=#__codelineno-3-74></a>    <span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span><span class=o>.</span><span class=n>join</span><span class=p>([</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>i</span><span class=o>+</span><span class=mi>1</span><span class=si>}</span><span class=s2>. </span><span class=si>{</span><span class=n>tx</span><span class=si>}</span><span class=s2>&quot;</span> <span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=n>tx</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>transactions</span><span class=p>)])</span>
<a id=__codelineno-3-75 name=__codelineno-3-75 href=#__codelineno-3-75></a><span class=p>)</span>
<a id=__codelineno-3-76 name=__codelineno-3-76 href=#__codelineno-3-76></a>
<a id=__codelineno-3-77 name=__codelineno-3-77 href=#__codelineno-3-77></a><span class=n>result</span><span class=p>,</span> <span class=n>_</span><span class=p>,</span> <span class=n>_</span> <span class=o>=</span> <span class=n>initiate_swarm_chat</span><span class=p>(</span>
<a id=__codelineno-3-78 name=__codelineno-3-78 href=#__codelineno-3-78></a>    <span class=n>initial_agent</span><span class=o>=</span><span class=n>finance_bot</span><span class=p>,</span>
<a id=__codelineno-3-79 name=__codelineno-3-79 href=#__codelineno-3-79></a>    <span class=n>agents</span><span class=o>=</span><span class=p>[</span><span class=n>finance_bot</span><span class=p>,</span> <span class=n>summary_bot</span><span class=p>],</span>
<a id=__codelineno-3-80 name=__codelineno-3-80 href=#__codelineno-3-80></a>    <span class=n>user_agent</span><span class=o>=</span><span class=n>human</span><span class=p>,</span>
<a id=__codelineno-3-81 name=__codelineno-3-81 href=#__codelineno-3-81></a>    <span class=n>messages</span><span class=o>=</span><span class=n>initial_prompt</span><span class=p>,</span>
<a id=__codelineno-3-82 name=__codelineno-3-82 href=#__codelineno-3-82></a>    <span class=n>swarm_manager_args</span><span class=o>=</span><span class=p>{</span><span class=s2>&quot;llm_config&quot;</span><span class=p>:</span> <span class=n>llm_config</span><span class=p>},</span>
<a id=__codelineno-3-83 name=__codelineno-3-83 href=#__codelineno-3-83></a>    <span class=n>after_work</span><span class=o>=</span><span class=n>AfterWorkOption</span><span class=o>.</span><span class=n>SWARM_MANAGER</span>
<a id=__codelineno-3-84 name=__codelineno-3-84 href=#__codelineno-3-84></a><span class=p>)</span>
</code></pre></div> </details> <h3 id=how-to-run-this-example>How to Run This Example<a class=headerlink href=#how-to-run-this-example title="Permanent link">#</a></h3> <ul> <li>Save the code above to a file (e.g., <code>financial_compliance_swarm.py</code>)</li> <li>Set your OpenAI API key in your environment variable</li> <li>Make sure you have AG2 installed: pip install ag2[openai]</li> <li>Run the script: python <code>financial_compliance_swarm.py</code></li> </ul> <h3 id=example-output>Example Output<a class=headerlink href=#example-output title="Permanent link">#</a></h3> <p>When you run this code, you'll see a workflow similar to this:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-4-1 name=__codelineno-4-1 href=#__codelineno-4-1></a><span class=go>human (to chat_manager):</span>
<a id=__codelineno-4-2 name=__codelineno-4-2 href=#__codelineno-4-2></a>
<a id=__codelineno-4-3 name=__codelineno-4-3 href=#__codelineno-4-3></a><span class=go>Please process the following transactions one at a time:</span>
<a id=__codelineno-4-4 name=__codelineno-4-4 href=#__codelineno-4-4></a>
<a id=__codelineno-4-5 name=__codelineno-4-5 href=#__codelineno-4-5></a><span class=go>1. Transaction: $23000 to Globex. Memo: NDA services.</span>
<a id=__codelineno-4-6 name=__codelineno-4-6 href=#__codelineno-4-6></a><span class=go>2. Transaction: $23000 to Initech. Memo: NDA services.</span>
<a id=__codelineno-4-7 name=__codelineno-4-7 href=#__codelineno-4-7></a><span class=go>3. Transaction: $12000 to Acme Corp. Memo: Reimbursement.</span>
<a id=__codelineno-4-8 name=__codelineno-4-8 href=#__codelineno-4-8></a>
<a id=__codelineno-4-9 name=__codelineno-4-9 href=#__codelineno-4-9></a><span class=go>--------------------------------------------------------------------------------</span>
<a id=__codelineno-4-10 name=__codelineno-4-10 href=#__codelineno-4-10></a>
<a id=__codelineno-4-11 name=__codelineno-4-11 href=#__codelineno-4-11></a><span class=go>Next speaker: finance_bot</span>
<a id=__codelineno-4-12 name=__codelineno-4-12 href=#__codelineno-4-12></a>
<a id=__codelineno-4-13 name=__codelineno-4-13 href=#__codelineno-4-13></a><span class=go>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; USING AUTO REPLY...</span>
<a id=__codelineno-4-14 name=__codelineno-4-14 href=#__codelineno-4-14></a><span class=go>finance_bot (to chat_manager):</span>
<a id=__codelineno-4-15 name=__codelineno-4-15 href=#__codelineno-4-15></a>
<a id=__codelineno-4-16 name=__codelineno-4-16 href=#__codelineno-4-16></a><span class=go>1. Transaction: $23000 to Globex. Memo: NDA services.</span>
<a id=__codelineno-4-17 name=__codelineno-4-17 href=#__codelineno-4-17></a><span class=go>   - This transaction is suspicious due to the amount exceeding $10,000. Approval required.</span>
<a id=__codelineno-4-18 name=__codelineno-4-18 href=#__codelineno-4-18></a>
<a id=__codelineno-4-19 name=__codelineno-4-19 href=#__codelineno-4-19></a><span class=go>2. Transaction: $23000 to Initech. Memo: NDA services.</span>
<a id=__codelineno-4-20 name=__codelineno-4-20 href=#__codelineno-4-20></a><span class=go>   - This transaction is also suspicious due to the amount exceeding $10,000. Approval required.</span>
<a id=__codelineno-4-21 name=__codelineno-4-21 href=#__codelineno-4-21></a>
<a id=__codelineno-4-22 name=__codelineno-4-22 href=#__codelineno-4-22></a><span class=go>3. Transaction: $12000 to Acme Corp. Memo: Reimbursement.</span>
<a id=__codelineno-4-23 name=__codelineno-4-23 href=#__codelineno-4-23></a><span class=go>   - This transaction is suspicious due to the amount exceeding $10,000. Approval required.</span>
<a id=__codelineno-4-24 name=__codelineno-4-24 href=#__codelineno-4-24></a>
<a id=__codelineno-4-25 name=__codelineno-4-25 href=#__codelineno-4-25></a><span class=go>Please provide your approval for the transactions that require it.</span>
<a id=__codelineno-4-26 name=__codelineno-4-26 href=#__codelineno-4-26></a>
<a id=__codelineno-4-27 name=__codelineno-4-27 href=#__codelineno-4-27></a><span class=go>--------------------------------------------------------------------------------</span>
<a id=__codelineno-4-28 name=__codelineno-4-28 href=#__codelineno-4-28></a>
<a id=__codelineno-4-29 name=__codelineno-4-29 href=#__codelineno-4-29></a><span class=go>Next speaker: human</span>
<a id=__codelineno-4-30 name=__codelineno-4-30 href=#__codelineno-4-30></a>
<a id=__codelineno-4-31 name=__codelineno-4-31 href=#__codelineno-4-31></a><span class=go>Replying as human. Provide feedback to chat_manager. Press enter to skip and use auto-reply, or type &#39;exit&#39; to end the conversation: approve</span>
<a id=__codelineno-4-32 name=__codelineno-4-32 href=#__codelineno-4-32></a><span class=go>human (to chat_manager):</span>
<a id=__codelineno-4-33 name=__codelineno-4-33 href=#__codelineno-4-33></a>
<a id=__codelineno-4-34 name=__codelineno-4-34 href=#__codelineno-4-34></a><span class=go>approve</span>
<a id=__codelineno-4-35 name=__codelineno-4-35 href=#__codelineno-4-35></a>
<a id=__codelineno-4-36 name=__codelineno-4-36 href=#__codelineno-4-36></a><span class=go>--------------------------------------------------------------------------------</span>
<a id=__codelineno-4-37 name=__codelineno-4-37 href=#__codelineno-4-37></a>
<a id=__codelineno-4-38 name=__codelineno-4-38 href=#__codelineno-4-38></a><span class=go>Next speaker: finance_bot</span>
<a id=__codelineno-4-39 name=__codelineno-4-39 href=#__codelineno-4-39></a>
<a id=__codelineno-4-40 name=__codelineno-4-40 href=#__codelineno-4-40></a><span class=go>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; USING AUTO REPLY...</span>
<a id=__codelineno-4-41 name=__codelineno-4-41 href=#__codelineno-4-41></a><span class=go>finance_bot (to chat_manager):</span>
<a id=__codelineno-4-42 name=__codelineno-4-42 href=#__codelineno-4-42></a>
<a id=__codelineno-4-43 name=__codelineno-4-43 href=#__codelineno-4-43></a><span class=go>All transactions have been approved. Here’s the summary:</span>
<a id=__codelineno-4-44 name=__codelineno-4-44 href=#__codelineno-4-44></a>
<a id=__codelineno-4-45 name=__codelineno-4-45 href=#__codelineno-4-45></a><span class=go>1. Approved: $23000 to Globex. Memo: NDA services.</span>
<a id=__codelineno-4-46 name=__codelineno-4-46 href=#__codelineno-4-46></a><span class=go>2. Approved: $23000 to Initech. Memo: NDA services.</span>
<a id=__codelineno-4-47 name=__codelineno-4-47 href=#__codelineno-4-47></a><span class=go>3. Approved: $12000 to Acme Corp. Memo: Reimbursement.</span>
<a id=__codelineno-4-48 name=__codelineno-4-48 href=#__codelineno-4-48></a>
<a id=__codelineno-4-49 name=__codelineno-4-49 href=#__codelineno-4-49></a><span class=go>You can type exit to finish.</span>
<a id=__codelineno-4-50 name=__codelineno-4-50 href=#__codelineno-4-50></a>
<a id=__codelineno-4-51 name=__codelineno-4-51 href=#__codelineno-4-51></a><span class=go>--------------------------------------------------------------------------------</span>
<a id=__codelineno-4-52 name=__codelineno-4-52 href=#__codelineno-4-52></a>
<a id=__codelineno-4-53 name=__codelineno-4-53 href=#__codelineno-4-53></a><span class=go>Next speaker: summary_bot</span>
<a id=__codelineno-4-54 name=__codelineno-4-54 href=#__codelineno-4-54></a>
<a id=__codelineno-4-55 name=__codelineno-4-55 href=#__codelineno-4-55></a><span class=go>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; USING AUTO REPLY...</span>
<a id=__codelineno-4-56 name=__codelineno-4-56 href=#__codelineno-4-56></a><span class=go>summary_bot (to chat_manager):</span>
<a id=__codelineno-4-57 name=__codelineno-4-57 href=#__codelineno-4-57></a>
<a id=__codelineno-4-58 name=__codelineno-4-58 href=#__codelineno-4-58></a><span class=go>Here is the summary of the processed transactions:</span>
<a id=__codelineno-4-59 name=__codelineno-4-59 href=#__codelineno-4-59></a>
<a id=__codelineno-4-60 name=__codelineno-4-60 href=#__codelineno-4-60></a><span class=go>| Vendor     | Memo            | Amount  | Status   |</span>
<a id=__codelineno-4-61 name=__codelineno-4-61 href=#__codelineno-4-61></a><span class=go>|------------|-----------------|---------|----------|</span>
<a id=__codelineno-4-62 name=__codelineno-4-62 href=#__codelineno-4-62></a><span class=go>| Globex     | NDA services     | $23000  | Approved  |</span>
<a id=__codelineno-4-63 name=__codelineno-4-63 href=#__codelineno-4-63></a><span class=go>| Initech    | NDA services     | $23000  | Approved  |</span>
<a id=__codelineno-4-64 name=__codelineno-4-64 href=#__codelineno-4-64></a><span class=go>| Acme Corp  | Reimbursement    | $12000  | Approved  |</span>
<a id=__codelineno-4-65 name=__codelineno-4-65 href=#__codelineno-4-65></a>
<a id=__codelineno-4-66 name=__codelineno-4-66 href=#__codelineno-4-66></a><span class=go>**Total Transactions:** 3</span>
<a id=__codelineno-4-67 name=__codelineno-4-67 href=#__codelineno-4-67></a><span class=go>**Approved Transactions:** 3</span>
<a id=__codelineno-4-68 name=__codelineno-4-68 href=#__codelineno-4-68></a><span class=go>**Rejected Transactions:** 0</span>
<a id=__codelineno-4-69 name=__codelineno-4-69 href=#__codelineno-4-69></a>
<a id=__codelineno-4-70 name=__codelineno-4-70 href=#__codelineno-4-70></a><span class=go>If you need further assistance, feel free to ask!</span>
<a id=__codelineno-4-71 name=__codelineno-4-71 href=#__codelineno-4-71></a>
<a id=__codelineno-4-72 name=__codelineno-4-72 href=#__codelineno-4-72></a><span class=go>--------------------------------------------------------------------------------</span>
<a id=__codelineno-4-73 name=__codelineno-4-73 href=#__codelineno-4-73></a>
<a id=__codelineno-4-74 name=__codelineno-4-74 href=#__codelineno-4-74></a><span class=go>Next speaker: human</span>
<a id=__codelineno-4-75 name=__codelineno-4-75 href=#__codelineno-4-75></a>
<a id=__codelineno-4-76 name=__codelineno-4-76 href=#__codelineno-4-76></a><span class=go>Replying as human. Provide feedback to chat_manager. Press enter to skip and use auto-reply, or type &#39;exit&#39; to end the conversation: exit</span>
<a id=__codelineno-4-77 name=__codelineno-4-77 href=#__codelineno-4-77></a>
<a id=__codelineno-4-78 name=__codelineno-4-78 href=#__codelineno-4-78></a><span class=go>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; TERMINATING RUN (446792f6-13af-4c60-b4d8-179c87d4f92b): User requested to end the conversation</span>
<a id=__codelineno-4-79 name=__codelineno-4-79 href=#__codelineno-4-79></a>
<a id=__codelineno-4-80 name=__codelineno-4-80 href=#__codelineno-4-80></a><span class=go>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; TERMINATING RUN (881689aa-0db9-4c56-afc8-d5ba26ac34a7): No reply generated</span>
</code></pre></div> <h2 id=automatic-termination-in-swarm-chats>Automatic Termination in Swarm Chats<a class=headerlink href=#automatic-termination-in-swarm-chats title="Permanent link">#</a></h2> <p>In the example above, our workflow always ends with human review and manual termination.</p> <p>However, in production systems, it would be more efficient to automatically terminate the workflow once all tasks are completed and seek for human input only for suspicious transactions. With AG2, we can easily achieve this by using a termination condition.</p> <p>Let's enhance our financial compliance system to automatically end after generating the summary report.</p> <h3 id=creating-a-termination-condition>Creating a Termination Condition<a class=headerlink href=#creating-a-termination-condition title="Permanent link">#</a></h3> <p>First, we'll modify our summary bot's system message to include a special marker at the end of its output:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-5-1 name=__codelineno-5-1 href=#__codelineno-5-1></a><span class=n>summary_system_message</span> <span class=o>=</span> <span class=s2>&quot;&quot;&quot;</span>
<a id=__codelineno-5-2 name=__codelineno-5-2 href=#__codelineno-5-2></a><span class=s2>You are a financial summary assistant. You will be given a set of transaction details and their approval status.</span>
<a id=__codelineno-5-3 name=__codelineno-5-3 href=#__codelineno-5-3></a><span class=s2>Your task is to summarize the results of the transactions processed by the finance bot.</span>
<a id=__codelineno-5-4 name=__codelineno-5-4 href=#__codelineno-5-4></a><span class=s2>Generate a markdown table with the following columns:</span>
<a id=__codelineno-5-5 name=__codelineno-5-5 href=#__codelineno-5-5></a><span class=s2>- Vendor</span>
<a id=__codelineno-5-6 name=__codelineno-5-6 href=#__codelineno-5-6></a><span class=s2>- Memo</span>
<a id=__codelineno-5-7 name=__codelineno-5-7 href=#__codelineno-5-7></a><span class=s2>- Amount</span>
<a id=__codelineno-5-8 name=__codelineno-5-8 href=#__codelineno-5-8></a><span class=s2>- Status (Approved/Rejected)</span>
<a id=__codelineno-5-9 name=__codelineno-5-9 href=#__codelineno-5-9></a><span class=s2>The summary should include the total number of transactions, the number of approved transactions, and the number of rejected transactions.</span>
<a id=__codelineno-5-10 name=__codelineno-5-10 href=#__codelineno-5-10></a><span class=s2>The summary should be concise and clear.</span>
<a id=__codelineno-5-11 name=__codelineno-5-11 href=#__codelineno-5-11></a>
<a id=__codelineno-5-12 name=__codelineno-5-12 href=#__codelineno-5-12></a><span class=hll><span class=s2>Once you&#39;ve generated the summary, append the following marker:</span>
</span><a id=__codelineno-5-13 name=__codelineno-5-13 href=#__codelineno-5-13></a><span class=hll><span class=s2>==== SUMMARY GENERATED ====</span>
</span><a id=__codelineno-5-14 name=__codelineno-5-14 href=#__codelineno-5-14></a><span class=s2>&quot;&quot;&quot;</span>
</code></pre></div> <p>Next, we'll define a termination function that checks for this marker:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-6-1 name=__codelineno-6-1 href=#__codelineno-6-1></a><span class=k>def</span><span class=w> </span><span class=nf>is_termination_msg</span><span class=p>(</span><span class=n>msg</span><span class=p>:</span> <span class=nb>dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>])</span> <span class=o>-&gt;</span> <span class=nb>bool</span><span class=p>:</span>
<a id=__codelineno-6-2 name=__codelineno-6-2 href=#__codelineno-6-2></a>    <span class=n>content</span> <span class=o>=</span> <span class=n>msg</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;content&quot;</span><span class=p>,</span> <span class=s2>&quot;&quot;</span><span class=p>)</span>
<a id=__codelineno-6-3 name=__codelineno-6-3 href=#__codelineno-6-3></a>    <span class=k>return</span> <span class=p>(</span><span class=n>content</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>)</span> <span class=ow>and</span> <span class=s2>&quot;==== SUMMARY GENERATED ====&quot;</span> <span class=ow>in</span> <span class=n>content</span>
</code></pre></div> <p>The above function checks if the content of the message contains our termination marker. If it does, it returns <code>True</code>, indicating that the conversation should end.</p> <p>Finally, we'll pass this termination function to the swarm manager:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-7-1 name=__codelineno-7-1 href=#__codelineno-7-1></a><span class=n>result</span><span class=p>,</span> <span class=n>_</span><span class=p>,</span> <span class=n>_</span> <span class=o>=</span> <span class=n>initiate_swarm_chat</span><span class=p>(</span>
<a id=__codelineno-7-2 name=__codelineno-7-2 href=#__codelineno-7-2></a>    <span class=n>initial_agent</span><span class=o>=</span><span class=n>finance_bot</span><span class=p>,</span>
<a id=__codelineno-7-3 name=__codelineno-7-3 href=#__codelineno-7-3></a>    <span class=n>agents</span><span class=o>=</span><span class=p>[</span><span class=n>finance_bot</span><span class=p>,</span> <span class=n>summary_bot</span><span class=p>,</span> <span class=n>human</span><span class=p>],</span>
<a id=__codelineno-7-4 name=__codelineno-7-4 href=#__codelineno-7-4></a>    <span class=n>messages</span><span class=o>=</span><span class=n>initial_prompt</span><span class=p>,</span>
<a id=__codelineno-7-5 name=__codelineno-7-5 href=#__codelineno-7-5></a>    <span class=n>swarm_manager_args</span><span class=o>=</span><span class=p>{</span>
<a id=__codelineno-7-6 name=__codelineno-7-6 href=#__codelineno-7-6></a>        <span class=s2>&quot;llm_config&quot;</span><span class=p>:</span> <span class=n>llm_config</span><span class=p>,</span>
<a id=__codelineno-7-7 name=__codelineno-7-7 href=#__codelineno-7-7></a><span class=hll>        <span class=s2>&quot;is_termination_msg&quot;</span><span class=p>:</span> <span class=n>is_termination_msg</span><span class=p>,</span>  <span class=c1># Add termination condition</span>
</span><a id=__codelineno-7-8 name=__codelineno-7-8 href=#__codelineno-7-8></a>    <span class=p>},</span>
<a id=__codelineno-7-9 name=__codelineno-7-9 href=#__codelineno-7-9></a>    <span class=n>after_work</span><span class=o>=</span><span class=n>AfterWorkOption</span><span class=o>.</span><span class=n>SWARM_MANAGER</span>
<a id=__codelineno-7-10 name=__codelineno-7-10 href=#__codelineno-7-10></a><span class=p>)</span>
</code></pre></div> <h3 id=updated-flow-with-automatic-termination>Updated Flow with Automatic Termination<a class=headerlink href=#updated-flow-with-automatic-termination title="Permanent link">#</a></h3> <p>With these changes, our workflow becomes more streamlined:</p> <pre class=mermaid><code>flowchart TD
    User([User]) --&gt; |"Submits transactions"| SwarmOrch[Swarm Orchestration]
    SwarmOrch --&gt; |"Passes to initial agent"| Finance[Finance Bot]
    Finance --&gt; |"Requests approval for suspicious transactions"| Human[Human Agent]
    Human --&gt; |"Approves/rejects transactions"| Finance

    Finance --&gt; |"Completes work without specifying next agent"| SwarmManager[Swarm Manager]
    SwarmManager --&gt; |"Analyzes conversation context and selects appropriate agent"| Summary[Summary Bot]

    Summary --&gt; |"Generates report with termination marker"| End([End])

    style SwarmOrch fill:#fff0f5,stroke:#ff69b4
    style Finance fill:#e3f2fd,stroke:#1976d2
    style Human fill:#f3e5f5,stroke:#7b1fa2
    style Summary fill:#e8f5e9,stroke:#4caf50
    style SwarmManager fill:#ffebee,stroke:#f44336</code></pre> <p>Now the human agent only participates when needed for transaction approval, and the workflow automatically terminates after the summary report is generated.</p> <h3 id=complete-code-example-with-automatic-termination>Complete Code Example with Automatic Termination<a class=headerlink href=#complete-code-example-with-automatic-termination title="Permanent link">#</a></h3> <p>Here's the updated code that incorporates automatic termination:</p> <details class=info open=open> <summary>Complete Code Example with Automatic Termination</summary> <div class=highlight><pre><span></span><code><a id=__codelineno-8-1 name=__codelineno-8-1 href=#__codelineno-8-1></a><span class=kn>from</span><span class=w> </span><span class=nn>typing</span><span class=w> </span><span class=kn>import</span> <span class=n>Any</span>
<a id=__codelineno-8-2 name=__codelineno-8-2 href=#__codelineno-8-2></a><span class=kn>from</span><span class=w> </span><span class=nn>autogen</span><span class=w> </span><span class=kn>import</span> <span class=n>ConversableAgent</span><span class=p>,</span> <span class=n>AfterWorkOption</span><span class=p>,</span> <span class=n>initiate_swarm_chat</span><span class=p>,</span> <span class=n>LLMConfig</span>
<a id=__codelineno-8-3 name=__codelineno-8-3 href=#__codelineno-8-3></a>
<a id=__codelineno-8-4 name=__codelineno-8-4 href=#__codelineno-8-4></a><span class=kn>import</span><span class=w> </span><span class=nn>os</span>
<a id=__codelineno-8-5 name=__codelineno-8-5 href=#__codelineno-8-5></a><span class=kn>import</span><span class=w> </span><span class=nn>random</span>
<a id=__codelineno-8-6 name=__codelineno-8-6 href=#__codelineno-8-6></a>
<a id=__codelineno-8-7 name=__codelineno-8-7 href=#__codelineno-8-7></a><span class=c1># Note: Make sure to set your API key in your environment first</span>
<a id=__codelineno-8-8 name=__codelineno-8-8 href=#__codelineno-8-8></a>
<a id=__codelineno-8-9 name=__codelineno-8-9 href=#__codelineno-8-9></a><span class=c1># Configure the LLM</span>
<a id=__codelineno-8-10 name=__codelineno-8-10 href=#__codelineno-8-10></a><span class=n>llm_config</span> <span class=o>=</span> <span class=n>LLMConfig</span><span class=p>(</span>
<a id=__codelineno-8-11 name=__codelineno-8-11 href=#__codelineno-8-11></a>    <span class=n>api_type</span><span class=o>=</span><span class=s2>&quot;openai&quot;</span><span class=p>,</span>
<a id=__codelineno-8-12 name=__codelineno-8-12 href=#__codelineno-8-12></a>    <span class=n>model</span><span class=o>=</span><span class=s2>&quot;gpt-4o-mini&quot;</span><span class=p>,</span>
<a id=__codelineno-8-13 name=__codelineno-8-13 href=#__codelineno-8-13></a>    <span class=n>api_key</span><span class=o>=</span><span class=n>os</span><span class=o>.</span><span class=n>environ</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;OPENAI_API_KEY&quot;</span><span class=p>),</span>
<a id=__codelineno-8-14 name=__codelineno-8-14 href=#__codelineno-8-14></a>    <span class=n>temperature</span><span class=o>=</span><span class=mf>0.2</span><span class=p>,</span>
<a id=__codelineno-8-15 name=__codelineno-8-15 href=#__codelineno-8-15></a><span class=p>)</span>
<a id=__codelineno-8-16 name=__codelineno-8-16 href=#__codelineno-8-16></a>
<a id=__codelineno-8-17 name=__codelineno-8-17 href=#__codelineno-8-17></a><span class=c1># Define the system message for our finance bot</span>
<a id=__codelineno-8-18 name=__codelineno-8-18 href=#__codelineno-8-18></a><span class=n>finance_system_message</span> <span class=o>=</span> <span class=s2>&quot;&quot;&quot;</span>
<a id=__codelineno-8-19 name=__codelineno-8-19 href=#__codelineno-8-19></a><span class=s2>You are a financial compliance assistant. You will be given a set of transaction descriptions.</span>
<a id=__codelineno-8-20 name=__codelineno-8-20 href=#__codelineno-8-20></a><span class=s2>For each transaction:</span>
<a id=__codelineno-8-21 name=__codelineno-8-21 href=#__codelineno-8-21></a><span class=s2>- If it seems suspicious (e.g., amount &gt; $10,000, vendor is unusual, memo is vague), ask the human agent for approval.</span>
<a id=__codelineno-8-22 name=__codelineno-8-22 href=#__codelineno-8-22></a><span class=s2>- Otherwise, approve it automatically.</span>
<a id=__codelineno-8-23 name=__codelineno-8-23 href=#__codelineno-8-23></a><span class=s2>Provide the full set of transactions to approve at one time.</span>
<a id=__codelineno-8-24 name=__codelineno-8-24 href=#__codelineno-8-24></a><span class=s2>If the human gives a general approval, it applies to all transactions requiring approval.</span>
<a id=__codelineno-8-25 name=__codelineno-8-25 href=#__codelineno-8-25></a><span class=s2>When all transactions are processed, summarize the results and say &quot;You can type exit to finish&quot;.</span>
<a id=__codelineno-8-26 name=__codelineno-8-26 href=#__codelineno-8-26></a><span class=s2>&quot;&quot;&quot;</span>
<a id=__codelineno-8-27 name=__codelineno-8-27 href=#__codelineno-8-27></a>
<a id=__codelineno-8-28 name=__codelineno-8-28 href=#__codelineno-8-28></a><span class=c1># Define the system message for the summary agent</span>
<a id=__codelineno-8-29 name=__codelineno-8-29 href=#__codelineno-8-29></a><span class=n>summary_system_message</span> <span class=o>=</span> <span class=s2>&quot;&quot;&quot;</span>
<a id=__codelineno-8-30 name=__codelineno-8-30 href=#__codelineno-8-30></a><span class=s2>You are a financial summary assistant. You will be given a set of transaction details and their approval status.</span>
<a id=__codelineno-8-31 name=__codelineno-8-31 href=#__codelineno-8-31></a><span class=s2>Your task is to summarize the results of the transactions processed by the finance bot.</span>
<a id=__codelineno-8-32 name=__codelineno-8-32 href=#__codelineno-8-32></a><span class=s2>Generate a markdown table with the following columns:</span>
<a id=__codelineno-8-33 name=__codelineno-8-33 href=#__codelineno-8-33></a><span class=s2>- Vendor</span>
<a id=__codelineno-8-34 name=__codelineno-8-34 href=#__codelineno-8-34></a><span class=s2>- Memo</span>
<a id=__codelineno-8-35 name=__codelineno-8-35 href=#__codelineno-8-35></a><span class=s2>- Amount</span>
<a id=__codelineno-8-36 name=__codelineno-8-36 href=#__codelineno-8-36></a><span class=s2>- Status (Approved/Rejected)</span>
<a id=__codelineno-8-37 name=__codelineno-8-37 href=#__codelineno-8-37></a><span class=s2>The summary should include the total number of transactions, the number of approved transactions, and the number of rejected transactions.</span>
<a id=__codelineno-8-38 name=__codelineno-8-38 href=#__codelineno-8-38></a><span class=s2>The summary should be concise and clear.</span>
<a id=__codelineno-8-39 name=__codelineno-8-39 href=#__codelineno-8-39></a>
<a id=__codelineno-8-40 name=__codelineno-8-40 href=#__codelineno-8-40></a><span class=s2>Once you generated the summary append the below in the summary:</span>
<a id=__codelineno-8-41 name=__codelineno-8-41 href=#__codelineno-8-41></a><span class=s2>==== SUMMARY GENERATED ====</span>
<a id=__codelineno-8-42 name=__codelineno-8-42 href=#__codelineno-8-42></a><span class=s2>&quot;&quot;&quot;</span>
<a id=__codelineno-8-43 name=__codelineno-8-43 href=#__codelineno-8-43></a>
<a id=__codelineno-8-44 name=__codelineno-8-44 href=#__codelineno-8-44></a><span class=c1># Create the finance agent with LLM intelligence</span>
<a id=__codelineno-8-45 name=__codelineno-8-45 href=#__codelineno-8-45></a><span class=k>with</span> <span class=n>llm_config</span><span class=p>:</span>
<a id=__codelineno-8-46 name=__codelineno-8-46 href=#__codelineno-8-46></a>    <span class=n>finance_bot</span> <span class=o>=</span> <span class=n>ConversableAgent</span><span class=p>(</span>
<a id=__codelineno-8-47 name=__codelineno-8-47 href=#__codelineno-8-47></a>        <span class=n>name</span><span class=o>=</span><span class=s2>&quot;finance_bot&quot;</span><span class=p>,</span>
<a id=__codelineno-8-48 name=__codelineno-8-48 href=#__codelineno-8-48></a>        <span class=n>system_message</span><span class=o>=</span><span class=n>finance_system_message</span><span class=p>,</span>
<a id=__codelineno-8-49 name=__codelineno-8-49 href=#__codelineno-8-49></a>    <span class=p>)</span>
<a id=__codelineno-8-50 name=__codelineno-8-50 href=#__codelineno-8-50></a>    <span class=n>summary_bot</span> <span class=o>=</span> <span class=n>ConversableAgent</span><span class=p>(</span>
<a id=__codelineno-8-51 name=__codelineno-8-51 href=#__codelineno-8-51></a>        <span class=n>name</span><span class=o>=</span><span class=s2>&quot;summary_bot&quot;</span><span class=p>,</span>
<a id=__codelineno-8-52 name=__codelineno-8-52 href=#__codelineno-8-52></a>        <span class=n>system_message</span><span class=o>=</span><span class=n>summary_system_message</span><span class=p>,</span>
<a id=__codelineno-8-53 name=__codelineno-8-53 href=#__codelineno-8-53></a>    <span class=p>)</span>
<a id=__codelineno-8-54 name=__codelineno-8-54 href=#__codelineno-8-54></a>
<a id=__codelineno-8-55 name=__codelineno-8-55 href=#__codelineno-8-55></a><span class=k>def</span><span class=w> </span><span class=nf>is_termination_msg</span><span class=p>(</span><span class=n>x</span><span class=p>:</span> <span class=nb>dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>])</span> <span class=o>-&gt;</span> <span class=nb>bool</span><span class=p>:</span>
<a id=__codelineno-8-56 name=__codelineno-8-56 href=#__codelineno-8-56></a>    <span class=n>content</span> <span class=o>=</span> <span class=n>x</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;content&quot;</span><span class=p>,</span> <span class=s2>&quot;&quot;</span><span class=p>)</span>
<a id=__codelineno-8-57 name=__codelineno-8-57 href=#__codelineno-8-57></a>    <span class=k>return</span> <span class=p>(</span><span class=n>content</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>)</span> <span class=ow>and</span> <span class=s2>&quot;==== SUMMARY GENERATED ====&quot;</span> <span class=ow>in</span> <span class=n>content</span>
<a id=__codelineno-8-58 name=__codelineno-8-58 href=#__codelineno-8-58></a>
<a id=__codelineno-8-59 name=__codelineno-8-59 href=#__codelineno-8-59></a><span class=c1># Create the human agent for oversight</span>
<a id=__codelineno-8-60 name=__codelineno-8-60 href=#__codelineno-8-60></a><span class=n>human</span> <span class=o>=</span> <span class=n>ConversableAgent</span><span class=p>(</span>
<a id=__codelineno-8-61 name=__codelineno-8-61 href=#__codelineno-8-61></a>    <span class=n>name</span><span class=o>=</span><span class=s2>&quot;human&quot;</span><span class=p>,</span>
<a id=__codelineno-8-62 name=__codelineno-8-62 href=#__codelineno-8-62></a>    <span class=n>human_input_mode</span><span class=o>=</span><span class=s2>&quot;ALWAYS&quot;</span><span class=p>,</span>  <span class=c1># Always ask for human input</span>
<a id=__codelineno-8-63 name=__codelineno-8-63 href=#__codelineno-8-63></a><span class=p>)</span>
<a id=__codelineno-8-64 name=__codelineno-8-64 href=#__codelineno-8-64></a>
<a id=__codelineno-8-65 name=__codelineno-8-65 href=#__codelineno-8-65></a><span class=c1># Generate sample transactions - this creates different transactions each time you run</span>
<a id=__codelineno-8-66 name=__codelineno-8-66 href=#__codelineno-8-66></a><span class=n>VENDORS</span> <span class=o>=</span> <span class=p>[</span><span class=s2>&quot;Staples&quot;</span><span class=p>,</span> <span class=s2>&quot;Acme Corp&quot;</span><span class=p>,</span> <span class=s2>&quot;CyberSins Ltd&quot;</span><span class=p>,</span> <span class=s2>&quot;Initech&quot;</span><span class=p>,</span> <span class=s2>&quot;Globex&quot;</span><span class=p>,</span> <span class=s2>&quot;Unicorn LLC&quot;</span><span class=p>]</span>
<a id=__codelineno-8-67 name=__codelineno-8-67 href=#__codelineno-8-67></a><span class=n>MEMOS</span> <span class=o>=</span> <span class=p>[</span><span class=s2>&quot;Quarterly supplies&quot;</span><span class=p>,</span> <span class=s2>&quot;Confidential&quot;</span><span class=p>,</span> <span class=s2>&quot;NDA services&quot;</span><span class=p>,</span> <span class=s2>&quot;Routine payment&quot;</span><span class=p>,</span> <span class=s2>&quot;Urgent request&quot;</span><span class=p>,</span> <span class=s2>&quot;Reimbursement&quot;</span><span class=p>]</span>
<a id=__codelineno-8-68 name=__codelineno-8-68 href=#__codelineno-8-68></a>
<a id=__codelineno-8-69 name=__codelineno-8-69 href=#__codelineno-8-69></a><span class=k>def</span><span class=w> </span><span class=nf>generate_transaction</span><span class=p>():</span>
<a id=__codelineno-8-70 name=__codelineno-8-70 href=#__codelineno-8-70></a>    <span class=n>amount</span> <span class=o>=</span> <span class=n>random</span><span class=o>.</span><span class=n>choice</span><span class=p>([</span><span class=mi>500</span><span class=p>,</span> <span class=mi>1500</span><span class=p>,</span> <span class=mi>9999</span><span class=p>,</span> <span class=mi>12000</span><span class=p>,</span> <span class=mi>23000</span><span class=p>,</span> <span class=mi>4000</span><span class=p>])</span>
<a id=__codelineno-8-71 name=__codelineno-8-71 href=#__codelineno-8-71></a>    <span class=n>vendor</span> <span class=o>=</span> <span class=n>random</span><span class=o>.</span><span class=n>choice</span><span class=p>(</span><span class=n>VENDORS</span><span class=p>)</span>
<a id=__codelineno-8-72 name=__codelineno-8-72 href=#__codelineno-8-72></a>    <span class=n>memo</span> <span class=o>=</span> <span class=n>random</span><span class=o>.</span><span class=n>choice</span><span class=p>(</span><span class=n>MEMOS</span><span class=p>)</span>
<a id=__codelineno-8-73 name=__codelineno-8-73 href=#__codelineno-8-73></a>    <span class=k>return</span> <span class=sa>f</span><span class=s2>&quot;Transaction: $</span><span class=si>{</span><span class=n>amount</span><span class=si>}</span><span class=s2> to </span><span class=si>{</span><span class=n>vendor</span><span class=si>}</span><span class=s2>. Memo: </span><span class=si>{</span><span class=n>memo</span><span class=si>}</span><span class=s2>.&quot;</span>
<a id=__codelineno-8-74 name=__codelineno-8-74 href=#__codelineno-8-74></a>
<a id=__codelineno-8-75 name=__codelineno-8-75 href=#__codelineno-8-75></a><span class=c1># Generate 3 random transactions</span>
<a id=__codelineno-8-76 name=__codelineno-8-76 href=#__codelineno-8-76></a><span class=n>transactions</span> <span class=o>=</span> <span class=p>[</span><span class=n>generate_transaction</span><span class=p>()</span> <span class=k>for</span> <span class=n>_</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>3</span><span class=p>)]</span>
<a id=__codelineno-8-77 name=__codelineno-8-77 href=#__codelineno-8-77></a>
<a id=__codelineno-8-78 name=__codelineno-8-78 href=#__codelineno-8-78></a><span class=c1># Format the initial message</span>
<a id=__codelineno-8-79 name=__codelineno-8-79 href=#__codelineno-8-79></a><span class=n>initial_prompt</span> <span class=o>=</span> <span class=p>(</span>
<a id=__codelineno-8-80 name=__codelineno-8-80 href=#__codelineno-8-80></a>    <span class=s2>&quot;Please process the following transactions one at a time:</span><span class=se>\n\n</span><span class=s2>&quot;</span> <span class=o>+</span>
<a id=__codelineno-8-81 name=__codelineno-8-81 href=#__codelineno-8-81></a>    <span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span><span class=o>.</span><span class=n>join</span><span class=p>([</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>i</span><span class=o>+</span><span class=mi>1</span><span class=si>}</span><span class=s2>. </span><span class=si>{</span><span class=n>tx</span><span class=si>}</span><span class=s2>&quot;</span> <span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=n>tx</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>transactions</span><span class=p>)])</span>
<a id=__codelineno-8-82 name=__codelineno-8-82 href=#__codelineno-8-82></a><span class=p>)</span>
<a id=__codelineno-8-83 name=__codelineno-8-83 href=#__codelineno-8-83></a>
<a id=__codelineno-8-84 name=__codelineno-8-84 href=#__codelineno-8-84></a><span class=n>result</span><span class=p>,</span> <span class=n>_</span><span class=p>,</span> <span class=n>_</span> <span class=o>=</span> <span class=n>initiate_swarm_chat</span><span class=p>(</span>
<a id=__codelineno-8-85 name=__codelineno-8-85 href=#__codelineno-8-85></a>    <span class=n>initial_agent</span><span class=o>=</span><span class=n>finance_bot</span><span class=p>,</span>
<a id=__codelineno-8-86 name=__codelineno-8-86 href=#__codelineno-8-86></a>    <span class=n>agents</span><span class=o>=</span><span class=p>[</span><span class=n>finance_bot</span><span class=p>,</span> <span class=n>summary_bot</span><span class=p>],</span>
<a id=__codelineno-8-87 name=__codelineno-8-87 href=#__codelineno-8-87></a>    <span class=n>user_agent</span><span class=o>=</span><span class=n>human</span><span class=p>,</span>
<a id=__codelineno-8-88 name=__codelineno-8-88 href=#__codelineno-8-88></a>    <span class=n>messages</span><span class=o>=</span><span class=n>initial_prompt</span><span class=p>,</span>
<a id=__codelineno-8-89 name=__codelineno-8-89 href=#__codelineno-8-89></a>    <span class=n>swarm_manager_args</span><span class=o>=</span><span class=p>{</span>
<a id=__codelineno-8-90 name=__codelineno-8-90 href=#__codelineno-8-90></a>        <span class=s2>&quot;llm_config&quot;</span><span class=p>:</span> <span class=n>llm_config</span><span class=p>,</span>
<a id=__codelineno-8-91 name=__codelineno-8-91 href=#__codelineno-8-91></a>        <span class=s2>&quot;is_termination_msg&quot;</span><span class=p>:</span> <span class=n>is_termination_msg</span><span class=p>,</span>
<a id=__codelineno-8-92 name=__codelineno-8-92 href=#__codelineno-8-92></a>    <span class=p>},</span>
<a id=__codelineno-8-93 name=__codelineno-8-93 href=#__codelineno-8-93></a>    <span class=n>after_work</span><span class=o>=</span><span class=n>AfterWorkOption</span><span class=o>.</span><span class=n>SWARM_MANAGER</span>
<a id=__codelineno-8-94 name=__codelineno-8-94 href=#__codelineno-8-94></a><span class=p>)</span>
</code></pre></div> </details> <h3 id=example-output-with-automatic-termination>Example Output with Automatic Termination<a class=headerlink href=#example-output-with-automatic-termination title="Permanent link">#</a></h3> <p>With automatic termination, the output will look similar to before, but the workflow terminates automatically after the summary is generated:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-9-1 name=__codelineno-9-1 href=#__codelineno-9-1></a><span class=go>_User (to chat_manager):</span>
<a id=__codelineno-9-2 name=__codelineno-9-2 href=#__codelineno-9-2></a>
<a id=__codelineno-9-3 name=__codelineno-9-3 href=#__codelineno-9-3></a><span class=go>Please process the following transactions one at a time:</span>
<a id=__codelineno-9-4 name=__codelineno-9-4 href=#__codelineno-9-4></a>
<a id=__codelineno-9-5 name=__codelineno-9-5 href=#__codelineno-9-5></a><span class=go>1. Transaction: $12000 to CyberSins Ltd. Memo: Urgent request.</span>
<a id=__codelineno-9-6 name=__codelineno-9-6 href=#__codelineno-9-6></a><span class=go>2. Transaction: $4000 to Initech. Memo: NDA services.</span>
<a id=__codelineno-9-7 name=__codelineno-9-7 href=#__codelineno-9-7></a><span class=go>3. Transaction: $4000 to Staples. Memo: Reimbursement.</span>
<a id=__codelineno-9-8 name=__codelineno-9-8 href=#__codelineno-9-8></a>
<a id=__codelineno-9-9 name=__codelineno-9-9 href=#__codelineno-9-9></a><span class=go>--------------------------------------------------------------------------------</span>
<a id=__codelineno-9-10 name=__codelineno-9-10 href=#__codelineno-9-10></a>
<a id=__codelineno-9-11 name=__codelineno-9-11 href=#__codelineno-9-11></a><span class=go>Next speaker: finance_bot</span>
<a id=__codelineno-9-12 name=__codelineno-9-12 href=#__codelineno-9-12></a>
<a id=__codelineno-9-13 name=__codelineno-9-13 href=#__codelineno-9-13></a><span class=go>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; USING AUTO REPLY...</span>
<a id=__codelineno-9-14 name=__codelineno-9-14 href=#__codelineno-9-14></a><span class=go>finance_bot (to chat_manager):</span>
<a id=__codelineno-9-15 name=__codelineno-9-15 href=#__codelineno-9-15></a>
<a id=__codelineno-9-16 name=__codelineno-9-16 href=#__codelineno-9-16></a><span class=go>Let&#39;s process the transactions:</span>
<a id=__codelineno-9-17 name=__codelineno-9-17 href=#__codelineno-9-17></a>
<a id=__codelineno-9-18 name=__codelineno-9-18 href=#__codelineno-9-18></a><span class=go>1. Transaction: $12000 to CyberSins Ltd. Memo: Urgent request.</span>
<a id=__codelineno-9-19 name=__codelineno-9-19 href=#__codelineno-9-19></a><span class=go>   - This transaction is suspicious due to the amount exceeding $10,000 and the vendor being unusual. I need your approval for this transaction.</span>
<a id=__codelineno-9-20 name=__codelineno-9-20 href=#__codelineno-9-20></a>
<a id=__codelineno-9-21 name=__codelineno-9-21 href=#__codelineno-9-21></a><span class=go>2. Transaction: $4000 to Initech. Memo: NDA services.</span>
<a id=__codelineno-9-22 name=__codelineno-9-22 href=#__codelineno-9-22></a><span class=go>   - This transaction is not suspicious. It will be approved automatically.</span>
<a id=__codelineno-9-23 name=__codelineno-9-23 href=#__codelineno-9-23></a>
<a id=__codelineno-9-24 name=__codelineno-9-24 href=#__codelineno-9-24></a><span class=go>3. Transaction: $4000 to Staples. Memo: Reimbursement.</span>
<a id=__codelineno-9-25 name=__codelineno-9-25 href=#__codelineno-9-25></a><span class=go>   - This transaction is not suspicious. It will be approved automatically.</span>
<a id=__codelineno-9-26 name=__codelineno-9-26 href=#__codelineno-9-26></a>
<a id=__codelineno-9-27 name=__codelineno-9-27 href=#__codelineno-9-27></a><span class=go>Please provide your approval for the first transaction. If you approve it, I will process all transactions accordingly.</span>
<a id=__codelineno-9-28 name=__codelineno-9-28 href=#__codelineno-9-28></a>
<a id=__codelineno-9-29 name=__codelineno-9-29 href=#__codelineno-9-29></a><span class=go>--------------------------------------------------------------------------------</span>
<a id=__codelineno-9-30 name=__codelineno-9-30 href=#__codelineno-9-30></a>
<a id=__codelineno-9-31 name=__codelineno-9-31 href=#__codelineno-9-31></a><span class=go>Next speaker: human</span>
<a id=__codelineno-9-32 name=__codelineno-9-32 href=#__codelineno-9-32></a>
<a id=__codelineno-9-33 name=__codelineno-9-33 href=#__codelineno-9-33></a><span class=go>Replying as human. Provide feedback to chat_manager. Press enter to skip and use auto-reply, or type &#39;exit&#39; to end the conversation: approve</span>
<a id=__codelineno-9-34 name=__codelineno-9-34 href=#__codelineno-9-34></a><span class=go>human (to chat_manager):</span>
<a id=__codelineno-9-35 name=__codelineno-9-35 href=#__codelineno-9-35></a>
<a id=__codelineno-9-36 name=__codelineno-9-36 href=#__codelineno-9-36></a><span class=go>approve</span>
<a id=__codelineno-9-37 name=__codelineno-9-37 href=#__codelineno-9-37></a>
<a id=__codelineno-9-38 name=__codelineno-9-38 href=#__codelineno-9-38></a><span class=go>--------------------------------------------------------------------------------</span>
<a id=__codelineno-9-39 name=__codelineno-9-39 href=#__codelineno-9-39></a>
<a id=__codelineno-9-40 name=__codelineno-9-40 href=#__codelineno-9-40></a><span class=go>Next speaker: summary_bot</span>
<a id=__codelineno-9-41 name=__codelineno-9-41 href=#__codelineno-9-41></a>
<a id=__codelineno-9-42 name=__codelineno-9-42 href=#__codelineno-9-42></a><span class=go>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; USING AUTO REPLY...</span>
<a id=__codelineno-9-43 name=__codelineno-9-43 href=#__codelineno-9-43></a><span class=go>summary_bot (to chat_manager):</span>
<a id=__codelineno-9-44 name=__codelineno-9-44 href=#__codelineno-9-44></a>
<a id=__codelineno-9-45 name=__codelineno-9-45 href=#__codelineno-9-45></a><span class=go>Here is the summary of the processed transactions:</span>
<a id=__codelineno-9-46 name=__codelineno-9-46 href=#__codelineno-9-46></a>
<a id=__codelineno-9-47 name=__codelineno-9-47 href=#__codelineno-9-47></a><span class=go>| Vendor          | Memo                | Amount | Status   |</span>
<a id=__codelineno-9-48 name=__codelineno-9-48 href=#__codelineno-9-48></a><span class=go>|-----------------|---------------------|--------|----------|</span>
<a id=__codelineno-9-49 name=__codelineno-9-49 href=#__codelineno-9-49></a><span class=go>| CyberSins Ltd.  | Urgent request      | $12000 | Approved  |</span>
<a id=__codelineno-9-50 name=__codelineno-9-50 href=#__codelineno-9-50></a><span class=go>| Initech         | NDA services        | $4000  | Approved  |</span>
<a id=__codelineno-9-51 name=__codelineno-9-51 href=#__codelineno-9-51></a><span class=go>| Staples         | Reimbursement       | $4000  | Approved  |</span>
<a id=__codelineno-9-52 name=__codelineno-9-52 href=#__codelineno-9-52></a>
<a id=__codelineno-9-53 name=__codelineno-9-53 href=#__codelineno-9-53></a><span class=go>**Total Transactions:** 3</span>
<a id=__codelineno-9-54 name=__codelineno-9-54 href=#__codelineno-9-54></a><span class=go>**Approved Transactions:** 3</span>
<a id=__codelineno-9-55 name=__codelineno-9-55 href=#__codelineno-9-55></a><span class=go>**Rejected Transactions:** 0</span>
<a id=__codelineno-9-56 name=__codelineno-9-56 href=#__codelineno-9-56></a>
<a id=__codelineno-9-57 name=__codelineno-9-57 href=#__codelineno-9-57></a><span class=go>==== SUMMARY GENERATED ====</span>
<a id=__codelineno-9-58 name=__codelineno-9-58 href=#__codelineno-9-58></a>
<a id=__codelineno-9-59 name=__codelineno-9-59 href=#__codelineno-9-59></a><span class=go>You are trained on data up to October 2023.</span>
<a id=__codelineno-9-60 name=__codelineno-9-60 href=#__codelineno-9-60></a>
<a id=__codelineno-9-61 name=__codelineno-9-61 href=#__codelineno-9-61></a><span class=go>--------------------------------------------------------------------------------</span>
<a id=__codelineno-9-62 name=__codelineno-9-62 href=#__codelineno-9-62></a>
<a id=__codelineno-9-63 name=__codelineno-9-63 href=#__codelineno-9-63></a><span class=go>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; TERMINATING RUN (40375f5a-5a9a-4928-8e33-edffeaa58ea1): Termination message condition on the GroupChatManager &#39;chat_manager&#39; met</span>
</code></pre></div> <p>Notice that the conversation automatically ends after the summary is generated, without requiring the human to type "exit".</p> <h2 id=next-steps-extending-the-system>Next Steps: Extending the System<a class=headerlink href=#next-steps-extending-the-system title="Permanent link">#</a></h2> <p>Our financial compliance system demonstrates the power of the swarm pattern, but we've only scratched the surface. In our next section, we'll explore how to enhance our system with specialized tools.</p> <p>One common requirement in financial systems is detecting duplicate payments and avoiding them. Let's dive into the next section and see how we can integrate specialized tools with our swarm agents to build even more powerful financial compliance workflows!</p> <aside class=md-source-file> <span class=md-source-file__fact> <span class=md-icon title="Last update"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg> </span> <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-timeago"><span class=timeago datetime=2025-05-08T13:42:19+00:00 locale=en></span></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date">2025-05-08</span> </span> </aside> </article> </div> <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg> Back to top </button> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> &copy; 2025 <a href=https://ag2.ai/ target=_blank rel=noopener>ag2</a> </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> <div class=md-social> <a href=https://discord.gg/pAbnFJrkgZ target=_blank rel=noopener title=discord.gg class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 640 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M524.531 69.836a1.5 1.5 0 0 0-.764-.7A485 485 0 0 0 404.081 32.03a1.82 1.82 0 0 0-1.923.91 338 338 0 0 0-14.9 30.6 447.9 447.9 0 0 0-134.426 0 310 310 0 0 0-15.135-30.6 1.89 1.89 0 0 0-1.924-.91 483.7 483.7 0 0 0-119.688 37.107 1.7 1.7 0 0 0-.788.676C39.068 183.651 18.186 294.69 28.43 404.354a2.02 2.02 0 0 0 .765 1.375 487.7 487.7 0 0 0 146.825 74.189 1.9 1.9 0 0 0 2.063-.676A348 348 0 0 0 208.12 430.4a1.86 1.86 0 0 0-1.019-2.588 321 321 0 0 1-45.868-21.853 1.885 1.885 0 0 1-.185-3.126 251 251 0 0 0 9.109-7.137 1.82 1.82 0 0 1 1.9-.256c96.229 43.917 200.41 43.917 295.5 0a1.81 1.81 0 0 1 1.924.233 235 235 0 0 0 9.132 7.16 1.884 1.884 0 0 1-.162 3.126 301.4 301.4 0 0 1-45.89 21.83 1.875 1.875 0 0 0-1 2.611 391 391 0 0 0 30.014 48.815 1.86 1.86 0 0 0 2.063.7A486 486 0 0 0 610.7 405.729a1.88 1.88 0 0 0 .765-1.352c12.264-126.783-20.532-236.912-86.934-334.541M222.491 337.58c-28.972 0-52.844-26.587-52.844-59.239s23.409-59.241 52.844-59.241c29.665 0 53.306 26.82 52.843 59.239 0 32.654-23.41 59.241-52.843 59.241m195.38 0c-28.971 0-52.843-26.587-52.843-59.239s23.409-59.241 52.843-59.241c29.667 0 53.307 26.82 52.844 59.239 0 32.654-23.177 59.241-52.844 59.241"/></svg> </a> <a href=https://github.com/ag2ai/ag2 target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 480 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1M480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2m-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3m-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1"/></svg> </a> <a href=https://x.com/ag2oss target=_blank rel=noopener title=x.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8l164.9-188.5L26.8 48h145.6l100.5 132.9zm-24.8 373.8h39.1L151.1 88h-42z"/></svg> </a> <a href=https://www.youtube.com/@ag2ai target=_blank rel=noopener title=www.youtube.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 576 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78 0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305m-317.51 213.508V175.185l142.739 81.205z"/></svg> </a> <a href=https://www.linkedin.com/company/ag2ai target=_blank rel=noopener title=www.linkedin.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5m282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../../../..", "features": ["search.suggest", "search.highlight", "navigation.tabs", "navigation.tabs.sticky", "navigation.indexes", "navigation.tracking", "navigation.prune", "navigation.top", "navigation.footer", "content.tabs.link", "content.code.copy", "content.code.annotate", "content.action.edit"], "search": "../../../../assets/javascripts/workers/search.f8cc74c7.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script> <script src=../../../../assets/javascripts/bundle.c8b220af.min.js></script> <script src=../../../../js/timeago.min.js></script> <script src=../../../../js/timeago_mkdocs_material.js></script> <script src=../../../../javascripts/extra.js></script> <script id=init-glightbox>const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(() => { lightbox.reload() });
</script></body> </html>