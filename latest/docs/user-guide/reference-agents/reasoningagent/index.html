<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="A programming framework for agentic AI"><meta name=author content="Chi Wang & Qingyun Wu"><link href=https://docs.ag2.ai/latest/docs/user-guide/reference-agents/reasoningagent/ rel=canonical><link href=../docagent-performance/ rel=prev><link href=../deepresearchagent/ rel=next><link rel=icon href=../../../../assets/images/favicon.png><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.6.12"><title>ReasoningAgent - AG2</title><link rel=stylesheet href=../../../../assets/stylesheets/main.2afb09e1.min.css><link rel=stylesheet href=../../../../assets/stylesheets/palette.06af60db.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Inter:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Inter";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../../../css/timeago.css><link rel=stylesheet href=../../../../assets/_mkdocstrings.css><link rel=stylesheet href=../../../../stylesheets/extra.ff0633.min.css><script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><script id=__analytics>function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-2GN2KN2CE4"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-2GN2KN2CE4",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-2GN2KN2CE4",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script><script>"undefined"!=typeof __md_analytics&&__md_analytics()</script><meta http-equiv=Cache-Control content="no-cache, no-store, must-revalidate"><meta property=og:type content=website><meta property=og:title content="AG2 - ReasoningAgent"><meta property=og:description content="A programming framework for agentic AI"><meta content=https://docs.ag2.ai/latest/docs/user-guide/reference-agents/reasoningagent/ property=og:url><meta property=og:image content=https://opengraph.githubassets.com/1671805243.560327/ag2ai/ag2><meta property=og:image:type content=image/png><meta property=og:image:width content=1200><meta property=og:image:height content=630><meta name=twitter:card content=summary_large_image><meta name=twitter:title content="AG2 - ReasoningAgent"><meta name=twitter:description content="A programming framework for agentic AI"><meta name=twitter:image content=https://opengraph.githubassets.com/1671805243.560327/ag2ai/ag2><link rel=icon href=https://docs.ag2.ai/latest/assets/img/favicon.svg type=image/x-icon><link rel=icon href=https://docs.ag2.ai/latest/assets/img/favicon-dark.svg type=image/x-icon media="(prefers-color-scheme: light)"><link rel=icon href=https://docs.ag2.ai/latest/assets/img/favicon.svg type=image/x-icon media="(prefers-color-scheme: dark)"><link href=../../../../assets/stylesheets/glightbox.min.css rel=stylesheet><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }
    .gscrollbar-fixer { padding-right: 15px; }
    .gdesc-inner { font-size: 0.75rem; }
    body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
    body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
    body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}</style><script src=../../../../assets/javascripts/glightbox.min.js></script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=custom data-md-color-accent=indigo> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#search-strategies class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <div data-md-color-scheme=default data-md-component=outdated hidden> <aside class="md-banner md-banner--warning"> <div class="md-banner__inner md-grid md-typeset"> You're not viewing the latest version. <a href=../../../../..> <strong>Click here to go to latest.</strong> </a> </div> <script>var el=document.querySelector("[data-md-component=outdated]"),base=new URL("../../../.."),outdated=__md_get("__outdated",sessionStorage,base);!0===outdated&&el&&(el.hidden=!1)</script> </aside> </div> <header class="md-header md-header--shadow md-header--lifted" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../../../.. title=AG2 class="md-header__button md-logo" aria-label=AG2 data-md-component=logo> <img src=../../../../assets/img/logo.svg alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> AG2 </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> ReasoningAgent </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme=default data-md-color-primary=custom data-md-color-accent=indigo aria-label="Switch to dark mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=custom data-md-color-accent=indigo aria-label="Switch to light mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg> </label> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/ag2ai/ag2 title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </div> <div class=md-source__repository> ag2ai/ag2 </div> </a> </div> </nav> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../../../quick-start/ class=md-tabs__link> Quick Start </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a href=../../basic-concepts/installing-ag2/ class=md-tabs__link> User Guide </a> </li> <li class=md-tabs__item> <a href=../../../api-reference/autogen/Agent/ class=md-tabs__link> API References </a> </li> <li class=md-tabs__item> <a href=../../../contributor-guide/contributing/ class=md-tabs__link> Contributor Guide </a> </li> <li class=md-tabs__item> <a href=../../../ecosystem/agentops/ class=md-tabs__link> Ecosystem </a> </li> <li class=md-tabs__item> <a href=../../../use-cases/use-cases/customer-service/ class=md-tabs__link> Use Cases </a> </li> <li class=md-tabs__item> <a href=../../../user-stories/2025-04-30-Cegid-Pulse-OS/cegid_pulse_os/ class=md-tabs__link> Community Insights </a> </li> <li class=md-tabs__item> <a href=../../../blog/ class=md-tabs__link> Blog </a> </li> </ul> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../../../.. title=AG2 class="md-nav__button md-logo" aria-label=AG2 data-md-component=logo> <img src=../../../../assets/img/logo.svg alt=logo> </a> AG2 </label> <div class=md-nav__source> <a href=https://github.com/ag2ai/ag2 title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </div> <div class=md-source__repository> ag2ai/ag2 </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../quick-start/ class=md-nav__link> <span class=md-ellipsis> Quick Start </span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2 checked> <label class=md-nav__link for=__nav_2 id=__nav_2_label tabindex> <span class=md-ellipsis> User Guide </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=true> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> User Guide </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../basic-concepts/installing-ag2/ class=md-nav__link> <span class=md-ellipsis> Installing AG2 </span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../basic-concepts/overview/ class=md-nav__link> <span class=md-ellipsis> Basic Concepts </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../advanced-concepts/llm-configuration-deep-dive/ class=md-nav__link> <span class=md-ellipsis> Advanced Concepts </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../models/amazon-bedrock/ class=md-nav__link> <span class=md-ellipsis> Model Providers </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_5 checked> <div class="md-nav__link md-nav__container"> <a href=../ class="md-nav__link "> <span class=md-ellipsis> Reference Agents </span> </a> <label class="md-nav__link " for=__nav_2_5 id=__nav_2_5_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_5_label aria-expanded=true> <label class=md-nav__title for=__nav_2_5> <span class="md-nav__icon md-icon"></span> Reference Agents </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../captainagent/ class=md-nav__link> <span class=md-ellipsis> CaptainAgent </span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../communication-platforms/overview/ class=md-nav__link> <span class=md-ellipsis> Communication Platforms </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class=md-nav__item> <a href=../docagent/ class=md-nav__link> <span class=md-ellipsis> DocAgent </span> </a> </li> <li class=md-nav__item> <a href=../docagent-performance/ class=md-nav__link> <span class=md-ellipsis> DocAgent Performance </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> ReasoningAgent </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> ReasoningAgent </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#search-strategies class=md-nav__link> <span class=md-ellipsis> Search Strategies </span> </a> <nav class=md-nav aria-label="Search Strategies"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#1-beam-search-default class=md-nav__link> <span class=md-ellipsis> 1. Beam Search (Default) </span> </a> </li> <li class=md-nav__item> <a href=#2-monte-carlo-tree-search-mcts class=md-nav__link> <span class=md-ellipsis> 2. Monte Carlo Tree Search (MCTS) </span> </a> </li> <li class=md-nav__item> <a href=#3-language-agent-tree-search-lats class=md-nav__link> <span class=md-ellipsis> 3. Language Agent Tree Search (LATS) </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#core-components class=md-nav__link> <span class=md-ellipsis> Core Components </span> </a> </li> <li class=md-nav__item> <a href=#configuration-options class=md-nav__link> <span class=md-ellipsis> Configuration Options </span> </a> </li> <li class=md-nav__item> <a href=#chain-of-thought-reasoning-with-dfs class=md-nav__link> <span class=md-ellipsis> Chain-of-Thought Reasoning with DFS </span> </a> </li> <li class=md-nav__item> <a href=#beam-search-in-tree-of-thought class=md-nav__link> <span class=md-ellipsis> Beam Search in Tree of Thought </span> </a> <nav class=md-nav aria-label="Beam Search in Tree of Thought"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#beam-search-with-batch-grading class=md-nav__link> <span class=md-ellipsis> Beam Search with Batch Grading </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#mcts class=md-nav__link> <span class=md-ellipsis> MCTS </span> </a> </li> <li class=md-nav__item> <a href=#lats class=md-nav__link> <span class=md-ellipsis> LATS </span> </a> </li> <li class=md-nav__item> <a href=#interim-execution-during-reasoning class=md-nav__link> <span class=md-ellipsis> Interim Execution During Reasoning </span> </a> </li> <li class=md-nav__item> <a href=#code-execution-during-reasoning class=md-nav__link> <span class=md-ellipsis> Code Execution During Reasoning </span> </a> </li> <li class=md-nav__item> <a href=#visualizing-the-reasoning-tree class=md-nav__link> <span class=md-ellipsis> Visualizing the Reasoning Tree </span> </a> <nav class=md-nav aria-label="Visualizing the Reasoning Tree"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#installation-of-graphviz class=md-nav__link> <span class=md-ellipsis> Installation of Graphviz </span> </a> </li> <li class=md-nav__item> <a href=#to-save-the-visualization-as-tree_of_thoughtspng-run-the-following-command class=md-nav__link> <span class=md-ellipsis> To save the visualization as "tree_of_thoughts.png", run the following command: </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#utilizing-reasoningagent-for-nested-chat-interactions class=md-nav__link> <span class=md-ellipsis> Utilizing ReasoningAgent for Nested Chat Interactions </span> </a> <nav class=md-nav aria-label="Utilizing ReasoningAgent for Nested Chat Interactions"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#task-writing-a-blog-post-on-nvidia class=md-nav__link> <span class=md-ellipsis> Task: Writing a Blog Post on NVIDIA </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#use-a-different-model-for-grading class=md-nav__link> <span class=md-ellipsis> Use a different Model for Grading </span> </a> </li> <li class=md-nav__item> <a href=#save-data-to-future-training class=md-nav__link> <span class=md-ellipsis> Save data to future training </span> </a> </li> <li class=md-nav__item> <a href=#utilizing-ground-truth-to-enhance-training-data-generation class=md-nav__link> <span class=md-ellipsis> Utilizing Ground Truth to Enhance Training Data Generation </span> </a> </li> <li class=md-nav__item> <a href=#forest-of-thoughts class=md-nav__link> <span class=md-ellipsis> Forest of Thoughts </span> </a> </li> <li class=md-nav__item> <a href=#scope class=md-nav__link> <span class=md-ellipsis> Scope </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../deepresearchagent/ class=md-nav__link> <span class=md-ellipsis> DeepResearchAgent </span> </a> </li> <li class=md-nav__item> <a href=../websurferagent/ class=md-nav__link> <span class=md-ellipsis> WebSurferAgent </span> </a> </li> <li class=md-nav__item> <a href=../wikipediaagent/ class=md-nav__link> <span class=md-ellipsis> WikipediaAgent </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../reference-tools/ class=md-nav__link> <span class=md-ellipsis> Reference Tools </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class=md-nav__item> <a href=../../../faq/FAQ/ class=md-nav__link> <span class=md-ellipsis> FAQ </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../api-reference/autogen/Agent/ class=md-nav__link> <span class=md-ellipsis> API References </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../contributor-guide/contributing/ class=md-nav__link> <span class=md-ellipsis> Contributor Guide </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../ecosystem/agentops/ class=md-nav__link> <span class=md-ellipsis> Ecosystem </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../use-cases/use-cases/customer-service/ class=md-nav__link> <span class=md-ellipsis> Use Cases </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../user-stories/2025-04-30-Cegid-Pulse-OS/cegid_pulse_os/ class=md-nav__link> <span class=md-ellipsis> Community Insights </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../blog/ class=md-nav__link> <span class=md-ellipsis> Blog </span> <span class="md-nav__icon md-icon"></span> </a> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#search-strategies class=md-nav__link> <span class=md-ellipsis> Search Strategies </span> </a> <nav class=md-nav aria-label="Search Strategies"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#1-beam-search-default class=md-nav__link> <span class=md-ellipsis> 1. Beam Search (Default) </span> </a> </li> <li class=md-nav__item> <a href=#2-monte-carlo-tree-search-mcts class=md-nav__link> <span class=md-ellipsis> 2. Monte Carlo Tree Search (MCTS) </span> </a> </li> <li class=md-nav__item> <a href=#3-language-agent-tree-search-lats class=md-nav__link> <span class=md-ellipsis> 3. Language Agent Tree Search (LATS) </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#core-components class=md-nav__link> <span class=md-ellipsis> Core Components </span> </a> </li> <li class=md-nav__item> <a href=#configuration-options class=md-nav__link> <span class=md-ellipsis> Configuration Options </span> </a> </li> <li class=md-nav__item> <a href=#chain-of-thought-reasoning-with-dfs class=md-nav__link> <span class=md-ellipsis> Chain-of-Thought Reasoning with DFS </span> </a> </li> <li class=md-nav__item> <a href=#beam-search-in-tree-of-thought class=md-nav__link> <span class=md-ellipsis> Beam Search in Tree of Thought </span> </a> <nav class=md-nav aria-label="Beam Search in Tree of Thought"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#beam-search-with-batch-grading class=md-nav__link> <span class=md-ellipsis> Beam Search with Batch Grading </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#mcts class=md-nav__link> <span class=md-ellipsis> MCTS </span> </a> </li> <li class=md-nav__item> <a href=#lats class=md-nav__link> <span class=md-ellipsis> LATS </span> </a> </li> <li class=md-nav__item> <a href=#interim-execution-during-reasoning class=md-nav__link> <span class=md-ellipsis> Interim Execution During Reasoning </span> </a> </li> <li class=md-nav__item> <a href=#code-execution-during-reasoning class=md-nav__link> <span class=md-ellipsis> Code Execution During Reasoning </span> </a> </li> <li class=md-nav__item> <a href=#visualizing-the-reasoning-tree class=md-nav__link> <span class=md-ellipsis> Visualizing the Reasoning Tree </span> </a> <nav class=md-nav aria-label="Visualizing the Reasoning Tree"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#installation-of-graphviz class=md-nav__link> <span class=md-ellipsis> Installation of Graphviz </span> </a> </li> <li class=md-nav__item> <a href=#to-save-the-visualization-as-tree_of_thoughtspng-run-the-following-command class=md-nav__link> <span class=md-ellipsis> To save the visualization as "tree_of_thoughts.png", run the following command: </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#utilizing-reasoningagent-for-nested-chat-interactions class=md-nav__link> <span class=md-ellipsis> Utilizing ReasoningAgent for Nested Chat Interactions </span> </a> <nav class=md-nav aria-label="Utilizing ReasoningAgent for Nested Chat Interactions"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#task-writing-a-blog-post-on-nvidia class=md-nav__link> <span class=md-ellipsis> Task: Writing a Blog Post on NVIDIA </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#use-a-different-model-for-grading class=md-nav__link> <span class=md-ellipsis> Use a different Model for Grading </span> </a> </li> <li class=md-nav__item> <a href=#save-data-to-future-training class=md-nav__link> <span class=md-ellipsis> Save data to future training </span> </a> </li> <li class=md-nav__item> <a href=#utilizing-ground-truth-to-enhance-training-data-generation class=md-nav__link> <span class=md-ellipsis> Utilizing Ground Truth to Enhance Training Data Generation </span> </a> </li> <li class=md-nav__item> <a href=#forest-of-thoughts class=md-nav__link> <span class=md-ellipsis> Forest of Thoughts </span> </a> </li> <li class=md-nav__item> <a href=#scope class=md-nav__link> <span class=md-ellipsis> Scope </span> </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <a href=https://github.com/ag2ai/ag2/edit/main/website/docs/user-guide/reference-agents/reasoningagent.md title="Edit this page" class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="m7 14.94 6.06-6.06 2.06 2.06L9.06 17H7zM12 20a8 8 0 0 0 8-8 8 8 0 0 0-8-8 8 8 0 0 0-8 8 8 8 0 0 0 8 8m4.7-10.65-1 1-2.05-2.05 1-1c.21-.22.56-.22.77 0l1.28 1.28c.22.21.22.56 0 .77M12 2a10 10 0 0 1 10 10 10 10 0 0 1-10 10A10 10 0 0 1 2 12 10 10 0 0 1 12 2"/></svg> </a> <h1>ReasoningAgent</h1> <p><a href=../../../api-reference/autogen/agents/experimental/ReasoningAgent><code>ReasoningAgent</code></a> is designed to enhance language models' reasoning capabilities through systematic exploration of thought processes. By implementing the Tree of Thoughts (ToT) framework, it enables LLMs like GPT-4 and Llama to break down complex problems into manageable steps and explore multiple solution paths simultaneously.</p> <p>Here, we demonstrate the key features and capabilities of the <a href=../../../api-reference/autogen/agents/experimental/ReasoningAgent><code>ReasoningAgent</code></a>, showing how it can effectively reason about problems.</p> <h2 id=search-strategies>Search Strategies<a class=headerlink href=#search-strategies title="Permanent link">#</a></h2> <p>The <a href=../../../api-reference/autogen/agents/experimental/ReasoningAgent><code>ReasoningAgent</code></a> supports multiple search strategies for exploring the reasoning space:</p> <h3 id=1-beam-search-default>1. Beam Search (Default)<a class=headerlink href=#1-beam-search-default title="Permanent link">#</a></h3> <ul> <li>Maintains the top <code>k</code> most promising paths at each step</li> <li>Efficient for problems with clear evaluation criteria</li> <li>Configurable beam width to balance exploration vs computation</li> <li>Special case: DFS mode (beam size = 1) for linear reasoning similar to Chain-of-Thought</li> </ul> <h3 id=2-monte-carlo-tree-search-mcts>2. Monte Carlo Tree Search (MCTS)<a class=headerlink href=#2-monte-carlo-tree-search-mcts title="Permanent link">#</a></h3> <ul> <li>Balances exploration and exploitation using UCT formula</li> <li>Particularly effective for problems with delayed rewards</li> <li>Stochastic exploration helps avoid local optima</li> <li>Configurable number of simulations and exploration constant</li> </ul> <h3 id=3-language-agent-tree-search-lats>3. Language Agent Tree Search (LATS)<a class=headerlink href=#3-language-agent-tree-search-lats title="Permanent link">#</a></h3> <ul> <li>Provides immediate reflection feedback before the next simulation</li> <li>Helps identify poor reasoning paths early for future improvement</li> <li>Especially useful for complex multi-step reasoning</li> </ul> <h2 id=core-components>Core Components<a class=headerlink href=#core-components title="Permanent link">#</a></h2> <ol> <li><strong>Thinker Agent</strong>: Generates potential next steps in the reasoning process</li> <li><strong>Grader Agent</strong>: Evaluates the quality of each reasoning step</li> <li><strong>Interim Execution</strong>: Option to execute the selected steps, enabling stepwise reasoning.</li> <li><strong>Code Execution</strong>: a child user agent will execute code automatically during reasoning</li> <li><strong>Tree Structure</strong>: Organizes thoughts hierarchically for systematic exploration</li> <li><strong>Visualization Tools</strong>: Built-in Graphviz support for analyzing reasoning paths</li> <li><strong>Logging Features</strong>: Log and save thinking trajectories to finetune the language model</li> <li><strong>Configuration Options</strong>: The agent is highly configurable through a single <code>reason_config</code> dictionary</li> <li><strong>Customizabilty with scope</strong>: Define task-specific context to guide the agentâ€™s reasoning.</li> </ol> <h2 id=configuration-options>Configuration Options<a class=headerlink href=#configuration-options title="Permanent link">#</a></h2> <p>The agent is highly configurable through a single <code>reason_config</code> dictionary:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=kn>import</span><span class=w> </span><span class=nn>random</span>
<a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a>
<a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a><span class=kn>from</span><span class=w> </span><span class=nn>autogen.agents.experimental</span><span class=w> </span><span class=kn>import</span> <span class=n>ReasoningAgent</span><span class=p>,</span> <span class=n>ThinkNode</span>
<a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a><span class=kn>from</span><span class=w> </span><span class=nn>autogen</span><span class=w> </span><span class=kn>import</span> <span class=n>AssistantAgent</span><span class=p>,</span> <span class=n>UserProxyAgent</span><span class=p>,</span> <span class=n>LLMConfig</span>
<a id=__codelineno-0-5 name=__codelineno-0-5 href=#__codelineno-0-5></a>
<a id=__codelineno-0-6 name=__codelineno-0-6 href=#__codelineno-0-6></a><span class=c1># Put your key in the OPENAI_API_KEY environment variable</span>
<a id=__codelineno-0-7 name=__codelineno-0-7 href=#__codelineno-0-7></a><span class=n>llm_config</span> <span class=o>=</span> <span class=n>LLMConfig</span><span class=p>(</span><span class=n>api_type</span><span class=o>=</span><span class=s2>&quot;openai&quot;</span><span class=p>,</span> <span class=n>model</span><span class=o>=</span><span class=s2>&quot;gpt-4o-mini&quot;</span><span class=p>)</span>
<a id=__codelineno-0-8 name=__codelineno-0-8 href=#__codelineno-0-8></a>
<a id=__codelineno-0-9 name=__codelineno-0-9 href=#__codelineno-0-9></a><span class=n>verbose</span> <span class=o>=</span> <span class=kc>True</span>
<a id=__codelineno-0-10 name=__codelineno-0-10 href=#__codelineno-0-10></a>
<a id=__codelineno-0-11 name=__codelineno-0-11 href=#__codelineno-0-11></a><span class=n>question</span> <span class=o>=</span> <span class=s2>&quot;What is the expected maximum dice value if you can roll a 6-sided dice three times?&quot;</span>
<a id=__codelineno-0-12 name=__codelineno-0-12 href=#__codelineno-0-12></a><span class=n>random</span><span class=o>.</span><span class=n>seed</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>  <span class=c1># setup seed for reproducibility</span>
<a id=__codelineno-0-13 name=__codelineno-0-13 href=#__codelineno-0-13></a>
<a id=__codelineno-0-14 name=__codelineno-0-14 href=#__codelineno-0-14></a><span class=k>def</span><span class=w> </span><span class=nf>last_meaningful_msg</span><span class=p>(</span><span class=n>sender</span><span class=p>,</span> <span class=n>recipient</span><span class=p>,</span> <span class=n>summary_args</span><span class=p>):</span>
<a id=__codelineno-0-15 name=__codelineno-0-15 href=#__codelineno-0-15></a>    <span class=kn>import</span><span class=w> </span><span class=nn>warnings</span>
<a id=__codelineno-0-16 name=__codelineno-0-16 href=#__codelineno-0-16></a>
<a id=__codelineno-0-17 name=__codelineno-0-17 href=#__codelineno-0-17></a>    <span class=k>if</span> <span class=n>sender</span> <span class=o>==</span> <span class=n>recipient</span><span class=p>:</span>
<a id=__codelineno-0-18 name=__codelineno-0-18 href=#__codelineno-0-18></a>        <span class=k>return</span> <span class=s2>&quot;TERMINATE&quot;</span>
<a id=__codelineno-0-19 name=__codelineno-0-19 href=#__codelineno-0-19></a>
<a id=__codelineno-0-20 name=__codelineno-0-20 href=#__codelineno-0-20></a>    <span class=n>summary</span> <span class=o>=</span> <span class=s2>&quot;&quot;</span>
<a id=__codelineno-0-21 name=__codelineno-0-21 href=#__codelineno-0-21></a>    <span class=n>chat_messages</span> <span class=o>=</span> <span class=n>recipient</span><span class=o>.</span><span class=n>chat_messages</span><span class=p>[</span><span class=n>sender</span><span class=p>]</span>
<a id=__codelineno-0-22 name=__codelineno-0-22 href=#__codelineno-0-22></a>
<a id=__codelineno-0-23 name=__codelineno-0-23 href=#__codelineno-0-23></a>    <span class=k>for</span> <span class=n>msg</span> <span class=ow>in</span> <span class=nb>reversed</span><span class=p>(</span><span class=n>chat_messages</span><span class=p>):</span>
<a id=__codelineno-0-24 name=__codelineno-0-24 href=#__codelineno-0-24></a>        <span class=k>try</span><span class=p>:</span>
<a id=__codelineno-0-25 name=__codelineno-0-25 href=#__codelineno-0-25></a>            <span class=n>content</span> <span class=o>=</span> <span class=n>msg</span><span class=p>[</span><span class=s2>&quot;content&quot;</span><span class=p>]</span>
<a id=__codelineno-0-26 name=__codelineno-0-26 href=#__codelineno-0-26></a>            <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>content</span><span class=p>,</span> <span class=nb>str</span><span class=p>):</span>
<a id=__codelineno-0-27 name=__codelineno-0-27 href=#__codelineno-0-27></a>                <span class=n>summary</span> <span class=o>=</span> <span class=n>content</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=s2>&quot;TERMINATE&quot;</span><span class=p>,</span> <span class=s2>&quot;&quot;</span><span class=p>)</span>
<a id=__codelineno-0-28 name=__codelineno-0-28 href=#__codelineno-0-28></a>            <span class=k>elif</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>content</span><span class=p>,</span> <span class=nb>list</span><span class=p>):</span>
<a id=__codelineno-0-29 name=__codelineno-0-29 href=#__codelineno-0-29></a>                <span class=c1># Remove the `TERMINATE` word in the content list.</span>
<a id=__codelineno-0-30 name=__codelineno-0-30 href=#__codelineno-0-30></a>                <span class=n>summary</span> <span class=o>=</span> <span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span>
<a id=__codelineno-0-31 name=__codelineno-0-31 href=#__codelineno-0-31></a>                    <span class=n>x</span><span class=p>[</span><span class=s2>&quot;text&quot;</span><span class=p>]</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=s2>&quot;TERMINATE&quot;</span><span class=p>,</span> <span class=s2>&quot;&quot;</span><span class=p>)</span> <span class=k>for</span> <span class=n>x</span> <span class=ow>in</span> <span class=n>content</span> <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=nb>dict</span><span class=p>)</span> <span class=ow>and</span> <span class=s2>&quot;text&quot;</span> <span class=ow>in</span> <span class=n>x</span>
<a id=__codelineno-0-32 name=__codelineno-0-32 href=#__codelineno-0-32></a>                <span class=p>)</span>
<a id=__codelineno-0-33 name=__codelineno-0-33 href=#__codelineno-0-33></a>            <span class=k>if</span> <span class=n>summary</span><span class=o>.</span><span class=n>strip</span><span class=p>()</span><span class=o>.</span><span class=n>rstrip</span><span class=p>():</span>
<a id=__codelineno-0-34 name=__codelineno-0-34 href=#__codelineno-0-34></a>                <span class=k>return</span> <span class=n>summary</span>
<a id=__codelineno-0-35 name=__codelineno-0-35 href=#__codelineno-0-35></a>        <span class=k>except</span> <span class=p>(</span><span class=ne>IndexError</span><span class=p>,</span> <span class=ne>AttributeError</span><span class=p>)</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
<a id=__codelineno-0-36 name=__codelineno-0-36 href=#__codelineno-0-36></a>            <span class=n>warnings</span><span class=o>.</span><span class=n>warn</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Cannot extract summary using last_msg: </span><span class=si>{</span><span class=n>e</span><span class=si>}</span><span class=s2>. Using an empty str as summary.&quot;</span><span class=p>,</span> <span class=ne>UserWarning</span><span class=p>)</span>
<a id=__codelineno-0-37 name=__codelineno-0-37 href=#__codelineno-0-37></a>    <span class=k>return</span> <span class=n>summary</span>
<a id=__codelineno-0-38 name=__codelineno-0-38 href=#__codelineno-0-38></a>
<a id=__codelineno-0-39 name=__codelineno-0-39 href=#__codelineno-0-39></a>    <span class=n>user_proxy</span> <span class=o>=</span> <span class=n>UserProxyAgent</span><span class=p>(</span>
<a id=__codelineno-0-40 name=__codelineno-0-40 href=#__codelineno-0-40></a>      <span class=n>name</span><span class=o>=</span><span class=s2>&quot;user_proxy&quot;</span><span class=p>,</span>
<a id=__codelineno-0-41 name=__codelineno-0-41 href=#__codelineno-0-41></a>      <span class=n>human_input_mode</span><span class=o>=</span><span class=s2>&quot;NEVER&quot;</span><span class=p>,</span>
<a id=__codelineno-0-42 name=__codelineno-0-42 href=#__codelineno-0-42></a>      <span class=n>code_execution_config</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span>
<a id=__codelineno-0-43 name=__codelineno-0-43 href=#__codelineno-0-43></a>      <span class=n>is_termination_msg</span><span class=o>=</span><span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=kc>True</span><span class=p>,</span> <span class=c1># terminate when reasoning agent responds</span>
<a id=__codelineno-0-44 name=__codelineno-0-44 href=#__codelineno-0-44></a>   <span class=p>)</span>
</code></pre></div> <h2 id=chain-of-thought-reasoning-with-dfs>Chain-of-Thought Reasoning with DFS<a class=headerlink href=#chain-of-thought-reasoning-with-dfs title="Permanent link">#</a></h2> <p>The simplest form of tree-based reasoning uses depth-first search (DFS) to explore a single path, similar to OpenAI's O1 feature. By setting <code>method="dfs"</code> in the reason_config, the agent will: 1. Generate one reasoning step at a time 2. Follow that single path until reaching a conclusion 3. Never explore alternative branches</p> <p>Note: The effectiveness depends on the underlying model's training. Models not specifically trained for step-by-step reasoning may show limited improvement with this approach.</p> <p>Note 2: To enable the execution of each selected step before generating the next step suggestions, pass <code>"interim_execution": True</code> in reason_config.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a><span class=k>with</span> <span class=n>llm_config</span><span class=p>:</span>
<a id=__codelineno-1-2 name=__codelineno-1-2 href=#__codelineno-1-2></a>    <span class=n>reason_agent</span> <span class=o>=</span> <span class=n>ReasoningAgent</span><span class=p>(</span>
<a id=__codelineno-1-3 name=__codelineno-1-3 href=#__codelineno-1-3></a>        <span class=n>name</span><span class=o>=</span><span class=s2>&quot;reason_agent&quot;</span><span class=p>,</span>
<a id=__codelineno-1-4 name=__codelineno-1-4 href=#__codelineno-1-4></a>        <span class=n>system_message</span><span class=o>=</span><span class=s2>&quot;answer math questions&quot;</span><span class=p>,</span>
<a id=__codelineno-1-5 name=__codelineno-1-5 href=#__codelineno-1-5></a>        <span class=n>reason_config</span><span class=o>=</span><span class=p>{</span><span class=s2>&quot;method&quot;</span><span class=p>:</span> <span class=s2>&quot;dfs&quot;</span><span class=p>,</span> <span class=s2>&quot;max_depth&quot;</span><span class=p>:</span> <span class=mi>3</span><span class=p>},</span>  <span class=c1># Using DFS</span>
<a id=__codelineno-1-6 name=__codelineno-1-6 href=#__codelineno-1-6></a>        <span class=n>silent</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span>
<a id=__codelineno-1-7 name=__codelineno-1-7 href=#__codelineno-1-7></a>        <span class=c1># NOTE: it is equivalent to use beam size 1 for O1-style reasoning</span>
<a id=__codelineno-1-8 name=__codelineno-1-8 href=#__codelineno-1-8></a>        <span class=c1># reason_config={&quot;method&quot;: &quot;beam_search&quot;, &quot;beam_size&quot;: 1, &quot;max_depth&quot;: 3},</span>
<a id=__codelineno-1-9 name=__codelineno-1-9 href=#__codelineno-1-9></a>    <span class=p>)</span>
<a id=__codelineno-1-10 name=__codelineno-1-10 href=#__codelineno-1-10></a>
<a id=__codelineno-1-11 name=__codelineno-1-11 href=#__codelineno-1-11></a><span class=n>ans</span> <span class=o>=</span> <span class=n>user_proxy</span><span class=o>.</span><span class=n>initiate_chat</span><span class=p>(</span><span class=n>reason_agent</span><span class=p>,</span> <span class=n>message</span><span class=o>=</span><span class=n>question</span><span class=p>,</span> <span class=n>summary_method</span><span class=o>=</span><span class=n>last_meaningful_msg</span><span class=p>)</span>
<a id=__codelineno-1-12 name=__codelineno-1-12 href=#__codelineno-1-12></a>
<a id=__codelineno-1-13 name=__codelineno-1-13 href=#__codelineno-1-13></a><span class=nb>print</span><span class=p>(</span><span class=n>ans</span><span class=o>.</span><span class=n>summary</span><span class=p>)</span>
</code></pre></div> <div class=highlight><pre><span></span><code><a id=__codelineno-2-1 name=__codelineno-2-1 href=#__codelineno-2-1></a><span class=go>To predict the expected maximum value of rolling a 6-sided dice three times, we can utilize statistical techniques and concepts from probability theory, specifically order statistics. Here is the detailed solution:</span>
<a id=__codelineno-2-2 name=__codelineno-2-2 href=#__codelineno-2-2></a>
<a id=__codelineno-2-3 name=__codelineno-2-3 href=#__codelineno-2-3></a><span class=gp>#</span><span class=c1>## Probabilistic Approach Using Order Statistics</span>
<a id=__codelineno-2-4 name=__codelineno-2-4 href=#__codelineno-2-4></a>
<a id=__codelineno-2-5 name=__codelineno-2-5 href=#__codelineno-2-5></a><span class=go>1. **Probability Distribution**: The value from a single roll of a fair 6-sided dice ranges uniformly from 1 to 6, each with probability \( \frac{1}{6} \).</span>
<a id=__codelineno-2-6 name=__codelineno-2-6 href=#__codelineno-2-6></a>
<a id=__codelineno-2-7 name=__codelineno-2-7 href=#__codelineno-2-7></a><span class=go>2. **Order Statistics**:</span>
<a id=__codelineno-2-8 name=__codelineno-2-8 href=#__codelineno-2-8></a><span class=go>   - When rolling the dice three times, we are interested in the distribution of the maximum value.</span>
<a id=__codelineno-2-9 name=__codelineno-2-9 href=#__codelineno-2-9></a><span class=go>   - For a 6-sided dice, given \( n \) rolls, the cumulative distribution function (CDF) represents the probability that the maximum value is less than or equal to \( k \).</span>
<a id=__codelineno-2-10 name=__codelineno-2-10 href=#__codelineno-2-10></a>
<a id=__codelineno-2-11 name=__codelineno-2-11 href=#__codelineno-2-11></a><span class=go>3. **Cumulative Distribution Function (CDF)**:</span>
<a id=__codelineno-2-12 name=__codelineno-2-12 href=#__codelineno-2-12></a><span class=go>   - Let \( X_{max} \) be the maximum value from the three rolls.</span>
<a id=__codelineno-2-13 name=__codelineno-2-13 href=#__codelineno-2-13></a><span class=go>   - The probability that \( X_{max} \leq k \):</span>
<a id=__codelineno-2-14 name=__codelineno-2-14 href=#__codelineno-2-14></a><span class=go>     \[</span>
<a id=__codelineno-2-15 name=__codelineno-2-15 href=#__codelineno-2-15></a><span class=go>     P(X_{max} \leq k) = \left(\frac{k}{6}\right)^3</span>
<a id=__codelineno-2-16 name=__codelineno-2-16 href=#__codelineno-2-16></a><span class=go>     \]</span>
<a id=__codelineno-2-17 name=__codelineno-2-17 href=#__codelineno-2-17></a><span class=go>   - This represents that all three dice rolls result in values less than or equal to \( k \).</span>
<a id=__codelineno-2-18 name=__codelineno-2-18 href=#__codelineno-2-18></a>
<a id=__codelineno-2-19 name=__codelineno-2-19 href=#__codelineno-2-19></a><span class=go>4. **Probability Mass Function (PMF)**:</span>
<a id=__codelineno-2-20 name=__codelineno-2-20 href=#__codelineno-2-20></a><span class=go>   - The probability that \( X_{max} = k \) can be found by considering the probabilities that the maximum value is less than or equal to \( k \) but greater than \( k-1 \):</span>
<a id=__codelineno-2-21 name=__codelineno-2-21 href=#__codelineno-2-21></a><span class=go>     \[</span>
<a id=__codelineno-2-22 name=__codelineno-2-22 href=#__codelineno-2-22></a><span class=go>     P(X_{max} = k) = P(X_{max} \leq k) - P(X_{max} \leq k-1) = \left(\frac{k}{6}\right)^3 - \left(\frac{k-1}{6}\right)^3</span>
<a id=__codelineno-2-23 name=__codelineno-2-23 href=#__codelineno-2-23></a><span class=go>     \]</span>
<a id=__codelineno-2-24 name=__codelineno-2-24 href=#__codelineno-2-24></a>
<a id=__codelineno-2-25 name=__codelineno-2-25 href=#__codelineno-2-25></a><span class=go>5. **Expected Value Calculation**:</span>
<a id=__codelineno-2-26 name=__codelineno-2-26 href=#__codelineno-2-26></a><span class=go>   - The expected maximum value can be calculated using:</span>
<a id=__codelineno-2-27 name=__codelineno-2-27 href=#__codelineno-2-27></a><span class=go>     \[</span>
<a id=__codelineno-2-28 name=__codelineno-2-28 href=#__codelineno-2-28></a><span class=go>     E[X_{max}] = \sum_{k=1}^{6} k \cdot P(X_{max} = k)</span>
<a id=__codelineno-2-29 name=__codelineno-2-29 href=#__codelineno-2-29></a><span class=go>     \]</span>
<a id=__codelineno-2-30 name=__codelineno-2-30 href=#__codelineno-2-30></a><span class=go>   - Plugging in the PMF:</span>
<a id=__codelineno-2-31 name=__codelineno-2-31 href=#__codelineno-2-31></a><span class=go>     \[</span>
<a id=__codelineno-2-32 name=__codelineno-2-32 href=#__codelineno-2-32></a><span class=go>     E[X_{max}] = \sum_{k=1}^{6} k \left[\left(\frac{k}{6}\right)^3 - \left(\frac{k-1}{6}\right)^3 \right]</span>
<a id=__codelineno-2-33 name=__codelineno-2-33 href=#__codelineno-2-33></a><span class=go>     \]</span>
<a id=__codelineno-2-34 name=__codelineno-2-34 href=#__codelineno-2-34></a>
<a id=__codelineno-2-35 name=__codelineno-2-35 href=#__codelineno-2-35></a><span class=go>6. **Computational Evaluation**:</span>
<a id=__codelineno-2-36 name=__codelineno-2-36 href=#__codelineno-2-36></a><span class=go>   - Perform the summation:</span>
<a id=__codelineno-2-37 name=__codelineno-2-37 href=#__codelineno-2-37></a><span class=go>     \[</span>
<a id=__codelineno-2-38 name=__codelineno-2-38 href=#__codelineno-2-38></a><span class=go>     E[X_{max}] = 1 \left[\left(\frac{1}{6}\right)^3 - \left(0\right)^3 \right] + 2 \left[\left(\frac{2}{6}\right)^3 - \left(\frac{1}{6}\right)^3 \right] + \ldots + 6 \left[\left(\frac{6}{6}\right)^3 - \left(\frac{5}{6}\right)^3 \right]</span>
<a id=__codelineno-2-39 name=__codelineno-2-39 href=#__codelineno-2-39></a><span class=go>     \]</span>
<a id=__codelineno-2-40 name=__codelineno-2-40 href=#__codelineno-2-40></a>
<a id=__codelineno-2-41 name=__codelineno-2-41 href=#__codelineno-2-41></a><span class=go>By evaluating this sum numerically, you get:</span>
<a id=__codelineno-2-42 name=__codelineno-2-42 href=#__codelineno-2-42></a>
<a id=__codelineno-2-43 name=__codelineno-2-43 href=#__codelineno-2-43></a><span class=go>\[</span>
<a id=__codelineno-2-44 name=__codelineno-2-44 href=#__codelineno-2-44></a><span class=go>E[X_{max}] \approx 4.47</span>
<a id=__codelineno-2-45 name=__codelineno-2-45 href=#__codelineno-2-45></a><span class=go>\]</span>
<a id=__codelineno-2-46 name=__codelineno-2-46 href=#__codelineno-2-46></a>
<a id=__codelineno-2-47 name=__codelineno-2-47 href=#__codelineno-2-47></a><span class=go>Thus, the expected maximum value if you roll a 6-sided dice three times is approximately \( \mathbf{4.47} \).</span>
</code></pre></div> <h2 id=beam-search-in-tree-of-thought>Beam Search in Tree of Thought<a class=headerlink href=#beam-search-in-tree-of-thought title="Permanent link">#</a></h2> <p>Beam Search is a powerful technique used in tree-based reasoning that allows the agent to explore multiple paths simultaneously. By setting <code>beam_size</code> greater than 1, the agent can maintain several candidate solutions at each step, evaluating them based on their potential to lead to the best final answer. This method is particularly effective when the solution space is large and complex, as it balances exploration and exploitation, ensuring that promising paths are prioritized while still considering alternative options.</p> <p>In this approach, the agent generates multiple reasoning steps in parallel, allowing it to compare different trajectories and select the most promising ones for further exploration. This can lead to more robust and accurate conclusions, especially in scenarios where intermediate evaluations are critical to the final outcome.</p> <p><div class=highlight><pre><span></span><code><a id=__codelineno-3-1 name=__codelineno-3-1 href=#__codelineno-3-1></a><span class=k>with</span> <span class=n>llm_config</span><span class=p>:</span>
<a id=__codelineno-3-2 name=__codelineno-3-2 href=#__codelineno-3-2></a>    <span class=n>reason_agent</span> <span class=o>=</span> <span class=n>ReasoningAgent</span><span class=p>(</span>
<a id=__codelineno-3-3 name=__codelineno-3-3 href=#__codelineno-3-3></a>        <span class=n>name</span><span class=o>=</span><span class=s2>&quot;reason_agent&quot;</span><span class=p>,</span>
<a id=__codelineno-3-4 name=__codelineno-3-4 href=#__codelineno-3-4></a>        <span class=n>reason_config</span><span class=o>=</span><span class=p>{</span><span class=s2>&quot;method&quot;</span><span class=p>:</span> <span class=s2>&quot;beam_search&quot;</span><span class=p>,</span> <span class=s2>&quot;beam_size&quot;</span><span class=p>:</span> <span class=mi>3</span><span class=p>}</span>
<a id=__codelineno-3-5 name=__codelineno-3-5 href=#__codelineno-3-5></a>    <span class=p>)</span>
<a id=__codelineno-3-6 name=__codelineno-3-6 href=#__codelineno-3-6></a>
<a id=__codelineno-3-7 name=__codelineno-3-7 href=#__codelineno-3-7></a><span class=n>ans</span> <span class=o>=</span> <span class=n>user_proxy</span><span class=o>.</span><span class=n>initiate_chat</span><span class=p>(</span><span class=n>reason_agent</span><span class=p>,</span> <span class=n>message</span><span class=o>=</span><span class=n>question</span><span class=p>,</span> <span class=n>summary_method</span><span class=o>=</span><span class=n>last_meaningful_msg</span><span class=p>)</span>
<a id=__codelineno-3-8 name=__codelineno-3-8 href=#__codelineno-3-8></a>
<a id=__codelineno-3-9 name=__codelineno-3-9 href=#__codelineno-3-9></a><span class=nb>print</span><span class=p>(</span><span class=n>ans</span><span class=o>.</span><span class=n>summary</span><span class=p>)</span>
</code></pre></div> <div class=highlight><pre><span></span><code><a id=__codelineno-4-1 name=__codelineno-4-1 href=#__codelineno-4-1></a><span class=go>To find the expected maximum dice value if you can roll a 6-sided dice three times, we can approach this problem using probability theory and the concept of order statistics.</span>
<a id=__codelineno-4-2 name=__codelineno-4-2 href=#__codelineno-4-2></a>
<a id=__codelineno-4-3 name=__codelineno-4-3 href=#__codelineno-4-3></a><span class=gp>#</span><span class=c1>## Plan</span>
<a id=__codelineno-4-4 name=__codelineno-4-4 href=#__codelineno-4-4></a><span class=go>1. **Derive Probability Distribution**: Determine the probability distribution of the maximum value when rolling three 6-sided dice.</span>
<a id=__codelineno-4-5 name=__codelineno-4-5 href=#__codelineno-4-5></a><span class=go>2. **Calculate Expected Value**: Use the probability distribution to calculate the expected value of the maximum roll.</span>
<a id=__codelineno-4-6 name=__codelineno-4-6 href=#__codelineno-4-6></a>
<a id=__codelineno-4-7 name=__codelineno-4-7 href=#__codelineno-4-7></a><span class=gp>#</span><span class=c1>## Derivation</span>
<a id=__codelineno-4-8 name=__codelineno-4-8 href=#__codelineno-4-8></a><span class=go>1. A 6-sided die has outcomes {1, 2, 3, 4, 5, 6}.</span>
<a id=__codelineno-4-9 name=__codelineno-4-9 href=#__codelineno-4-9></a><span class=go>2. For each possible maximum value \( x \), we need to find the probability \( P(\text{max} = x) \).</span>
<a id=__codelineno-4-10 name=__codelineno-4-10 href=#__codelineno-4-10></a>
<a id=__codelineno-4-11 name=__codelineno-4-11 href=#__codelineno-4-11></a><span class=go>Let \( X_i \) be the result of roll i.</span>
<a id=__codelineno-4-12 name=__codelineno-4-12 href=#__codelineno-4-12></a>
<a id=__codelineno-4-13 name=__codelineno-4-13 href=#__codelineno-4-13></a><span class=go>The probability that the maximum value is \( x \), \( P(\text{max} = x) \) is:</span>
<a id=__codelineno-4-14 name=__codelineno-4-14 href=#__codelineno-4-14></a><span class=go>\[ P(\max(X_1, X_2, X_3) = x) = P(\max(X_1, X_2, X_3) \leq x) - P(\max(X_1, X_2, X_3) \leq x-1) \]</span>
<a id=__codelineno-4-15 name=__codelineno-4-15 href=#__codelineno-4-15></a>
<a id=__codelineno-4-16 name=__codelineno-4-16 href=#__codelineno-4-16></a><span class=go>Using the complement rule and the fact that the rolls are independent:</span>
<a id=__codelineno-4-17 name=__codelineno-4-17 href=#__codelineno-4-17></a><span class=go>\[ P(\max(X_1, X_2, X_3) \leq x) = (P(X_1 \leq x) \cdot P(X_2 \leq x) \cdot P(X_3 \leq x)) = (x/6)^3 \]</span>
<a id=__codelineno-4-18 name=__codelineno-4-18 href=#__codelineno-4-18></a><span class=go>\[ P(\max(X_1, X_2, X_3) \leq x-1) = ((x-1)/6)^3 \]</span>
<a id=__codelineno-4-19 name=__codelineno-4-19 href=#__codelineno-4-19></a>
<a id=__codelineno-4-20 name=__codelineno-4-20 href=#__codelineno-4-20></a><span class=go>Therefore,</span>
<a id=__codelineno-4-21 name=__codelineno-4-21 href=#__codelineno-4-21></a><span class=go>\[ P(\text{max} = x) = (x/6)^3 - ((x-1)/6)^3 \]</span>
<a id=__codelineno-4-22 name=__codelineno-4-22 href=#__codelineno-4-22></a>
<a id=__codelineno-4-23 name=__codelineno-4-23 href=#__codelineno-4-23></a><span class=go>3. **Calculate Expected Value**:</span>
<a id=__codelineno-4-24 name=__codelineno-4-24 href=#__codelineno-4-24></a><span class=go>\[ E[\text{max}] = \sum_{x=1}^{6} x \cdot P(\text{max} = x) \]</span>
<a id=__codelineno-4-25 name=__codelineno-4-25 href=#__codelineno-4-25></a>
<a id=__codelineno-4-26 name=__codelineno-4-26 href=#__codelineno-4-26></a><span class=gp>#</span><span class=c1>## Python Code</span>
<a id=__codelineno-4-27 name=__codelineno-4-27 href=#__codelineno-4-27></a><span class=go>We can implement the above calculations in Python to find the expected value.</span>
<a id=__codelineno-4-28 name=__codelineno-4-28 href=#__codelineno-4-28></a>
<a id=__codelineno-4-29 name=__codelineno-4-29 href=#__codelineno-4-29></a><span class=go>```python</span>
<a id=__codelineno-4-30 name=__codelineno-4-30 href=#__codelineno-4-30></a><span class=gp># </span>filename:<span class=w> </span>expected_max_dice_value.py
<a id=__codelineno-4-31 name=__codelineno-4-31 href=#__codelineno-4-31></a><span class=go>import numpy as np</span>
<a id=__codelineno-4-32 name=__codelineno-4-32 href=#__codelineno-4-32></a>
<a id=__codelineno-4-33 name=__codelineno-4-33 href=#__codelineno-4-33></a><span class=gp># </span>Calculate<span class=w> </span>the<span class=w> </span>probabilities
<a id=__codelineno-4-34 name=__codelineno-4-34 href=#__codelineno-4-34></a><span class=go>prob_max = [(i / 6) ** 3 - ((i - 1) / 6) ** 3 for i in range(1, 7)]</span>
<a id=__codelineno-4-35 name=__codelineno-4-35 href=#__codelineno-4-35></a>
<a id=__codelineno-4-36 name=__codelineno-4-36 href=#__codelineno-4-36></a><span class=gp># </span>Expected<span class=w> </span>value<span class=w> </span>computation
<a id=__codelineno-4-37 name=__codelineno-4-37 href=#__codelineno-4-37></a><span class=go>expected_max = sum(i * prob for i, prob in enumerate(prob_max, start=1))</span>
<a id=__codelineno-4-38 name=__codelineno-4-38 href=#__codelineno-4-38></a>
<a id=__codelineno-4-39 name=__codelineno-4-39 href=#__codelineno-4-39></a><span class=go>print(f&#39;The expected maximum value when rolling a 6-sided dice three times is: {expected_max}&#39;)</span>
<a id=__codelineno-4-40 name=__codelineno-4-40 href=#__codelineno-4-40></a><span class=go>```</span>
<a id=__codelineno-4-41 name=__codelineno-4-41 href=#__codelineno-4-41></a>
<a id=__codelineno-4-42 name=__codelineno-4-42 href=#__codelineno-4-42></a><span class=go>Execute this script to compute the expected value using the derived probabilities. This will provide the precise expected maximum value when rolling a 6-sided dice three times.</span>
</code></pre></div></p> <p>We can see that in this case the agent suggests to execute a script. Later, we will see how it can do this internally.</p> <h3 id=beam-search-with-batch-grading>Beam Search with Batch Grading<a class=headerlink href=#beam-search-with-batch-grading title="Permanent link">#</a></h3> <p>By default, node grading is performed one at a time. While this approach is often sufficient, certain applications benefit from a batched grading approach on each beam expansion. In other words, instead of grading all nodes across the entire search in a single pass, we group each beam's newly expanded nodes into a single batch for grading. This yields:</p> <ol> <li><strong>Context-aware evaluation</strong>: Within a single beam iteration, the grader can compare and contrast multiple node expansions at once.</li> <li><strong>Improved efficiency</strong>: Combining multiple evaluations into one request per beam iteration can reduce the total number of LLM calls.</li> </ol> <p>To enable batch grading, set <code>"batch_grading": True</code> in the <code>reason_config</code>. By default, <code>batch_grading</code> is set to <code>False</code>, meaning individual node grading is performed without batching.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-5-1 name=__codelineno-5-1 href=#__codelineno-5-1></a><span class=k>with</span> <span class=n>llm_config</span><span class=p>:</span>
<a id=__codelineno-5-2 name=__codelineno-5-2 href=#__codelineno-5-2></a>    <span class=n>reason_agent</span> <span class=o>=</span> <span class=n>ReasoningAgent</span><span class=p>(</span>
<a id=__codelineno-5-3 name=__codelineno-5-3 href=#__codelineno-5-3></a>        <span class=n>name</span><span class=o>=</span><span class=s2>&quot;reason_agent&quot;</span><span class=p>,</span> <span class=n>reason_config</span><span class=o>=</span><span class=p>{</span><span class=s2>&quot;method&quot;</span><span class=p>:</span> <span class=s2>&quot;beam_search&quot;</span><span class=p>,</span> <span class=s2>&quot;beam_size&quot;</span><span class=p>:</span> <span class=mi>3</span><span class=p>,</span> <span class=s2>&quot;batch_grading&quot;</span><span class=p>:</span> <span class=kc>True</span><span class=p>}</span>
<a id=__codelineno-5-4 name=__codelineno-5-4 href=#__codelineno-5-4></a>    <span class=p>)</span>
<a id=__codelineno-5-5 name=__codelineno-5-5 href=#__codelineno-5-5></a>
<a id=__codelineno-5-6 name=__codelineno-5-6 href=#__codelineno-5-6></a><span class=n>ans</span> <span class=o>=</span> <span class=n>user_proxy</span><span class=o>.</span><span class=n>initiate_chat</span><span class=p>(</span><span class=n>reason_agent</span><span class=p>,</span> <span class=n>message</span><span class=o>=</span><span class=n>question</span><span class=p>,</span> <span class=n>summary_method</span><span class=o>=</span><span class=n>last_meaningful_msg</span><span class=p>)</span>
<a id=__codelineno-5-7 name=__codelineno-5-7 href=#__codelineno-5-7></a>
<a id=__codelineno-5-8 name=__codelineno-5-8 href=#__codelineno-5-8></a><span class=nb>print</span><span class=p>(</span><span class=n>ans</span><span class=o>.</span><span class=n>summary</span><span class=p>)</span>
</code></pre></div> <div class=highlight><pre><span></span><code><a id=__codelineno-6-1 name=__codelineno-6-1 href=#__codelineno-6-1></a><span class=go>To determine the expected maximum value when rolling a 6-sided dice three times, we need to follow the steps below:</span>
<a id=__codelineno-6-2 name=__codelineno-6-2 href=#__codelineno-6-2></a>
<a id=__codelineno-6-3 name=__codelineno-6-3 href=#__codelineno-6-3></a><span class=gp>#</span><span class=c1>## Step 1: Determine cumulative distribution function (CDF)</span>
<a id=__codelineno-6-4 name=__codelineno-6-4 href=#__codelineno-6-4></a><span class=go>First, identify the probability that the maximum roll is less than or equal to each possible value (from 1 to 6).</span>
<a id=__codelineno-6-5 name=__codelineno-6-5 href=#__codelineno-6-5></a>
<a id=__codelineno-6-6 name=__codelineno-6-6 href=#__codelineno-6-6></a><span class=gp>#</span><span class=c1>## Step 2: Derive probabilities for each possible maximum in three rolls</span>
<a id=__codelineno-6-7 name=__codelineno-6-7 href=#__codelineno-6-7></a><span class=go>Next, use the cumulative distribution function to calculate the probabilities of obtaining a specific maximum outcome.</span>
<a id=__codelineno-6-8 name=__codelineno-6-8 href=#__codelineno-6-8></a>
<a id=__codelineno-6-9 name=__codelineno-6-9 href=#__codelineno-6-9></a><span class=gp>#</span><span class=c1>## Step 3: Compute the expectation</span>
<a id=__codelineno-6-10 name=__codelineno-6-10 href=#__codelineno-6-10></a><span class=go>Calculate the expected maximum value by taking the weighted sum of possible maximum values and their corresponding probabilities.</span>
<a id=__codelineno-6-11 name=__codelineno-6-11 href=#__codelineno-6-11></a>
<a id=__codelineno-6-12 name=__codelineno-6-12 href=#__codelineno-6-12></a><span class=gp>#</span><span class=c1>## Step 4: Detailed Expected Value Calculation</span>
<a id=__codelineno-6-13 name=__codelineno-6-13 href=#__codelineno-6-13></a><span class=go>Calculate the expected maximum dice value with detailed intermediate steps.</span>
<a id=__codelineno-6-14 name=__codelineno-6-14 href=#__codelineno-6-14></a>
<a id=__codelineno-6-15 name=__codelineno-6-15 href=#__codelineno-6-15></a><span class=go>Here&#39;s the Python code to accomplish the task:</span>
<a id=__codelineno-6-16 name=__codelineno-6-16 href=#__codelineno-6-16></a>
<a id=__codelineno-6-17 name=__codelineno-6-17 href=#__codelineno-6-17></a><span class=go>```python</span>
<a id=__codelineno-6-18 name=__codelineno-6-18 href=#__codelineno-6-18></a><span class=go>import numpy as np</span>
<a id=__codelineno-6-19 name=__codelineno-6-19 href=#__codelineno-6-19></a>
<a id=__codelineno-6-20 name=__codelineno-6-20 href=#__codelineno-6-20></a><span class=gp># </span>Number<span class=w> </span>of<span class=w> </span>sides<span class=w> </span>on<span class=w> </span>the<span class=w> </span>dice
<a id=__codelineno-6-21 name=__codelineno-6-21 href=#__codelineno-6-21></a><span class=go>n_sides = 6</span>
<a id=__codelineno-6-22 name=__codelineno-6-22 href=#__codelineno-6-22></a><span class=gp># </span>Number<span class=w> </span>of<span class=w> </span>rolls
<a id=__codelineno-6-23 name=__codelineno-6-23 href=#__codelineno-6-23></a><span class=go>n_rolls = 3</span>
<a id=__codelineno-6-24 name=__codelineno-6-24 href=#__codelineno-6-24></a>
<a id=__codelineno-6-25 name=__codelineno-6-25 href=#__codelineno-6-25></a><span class=gp># </span>Function<span class=w> </span>to<span class=w> </span>calculate<span class=w> </span>the<span class=w> </span>probability<span class=w> </span>of<span class=w> </span>the<span class=w> </span>maximum<span class=w> </span>roll<span class=w> </span>being<span class=w> </span>k
<a id=__codelineno-6-26 name=__codelineno-6-26 href=#__codelineno-6-26></a><span class=go>def prob_max_is_k(k, n_sides, n_rolls):</span>
<a id=__codelineno-6-27 name=__codelineno-6-27 href=#__codelineno-6-27></a><span class=go>    return (k**n_rolls - (k-1)**n_rolls) / n_sides**n_rolls</span>
<a id=__codelineno-6-28 name=__codelineno-6-28 href=#__codelineno-6-28></a>
<a id=__codelineno-6-29 name=__codelineno-6-29 href=#__codelineno-6-29></a><span class=gp># </span>Calculate<span class=w> </span>probabilities<span class=w> </span><span class=k>for</span><span class=w> </span>each<span class=w> </span>maximum<span class=w> </span>value
<a id=__codelineno-6-30 name=__codelineno-6-30 href=#__codelineno-6-30></a><span class=go>probabilities = [prob_max_is_k(k, n_sides, n_rolls) for k in range(1, n_sides + 1)]</span>
<a id=__codelineno-6-31 name=__codelineno-6-31 href=#__codelineno-6-31></a>
<a id=__codelineno-6-32 name=__codelineno-6-32 href=#__codelineno-6-32></a><span class=gp># </span>Calculate<span class=w> </span>expected<span class=w> </span>maximum<span class=w> </span>value
<a id=__codelineno-6-33 name=__codelineno-6-33 href=#__codelineno-6-33></a><span class=go>expected_max_value = sum(k * prob for k, prob in enumerate(probabilities, 1))</span>
<a id=__codelineno-6-34 name=__codelineno-6-34 href=#__codelineno-6-34></a>
<a id=__codelineno-6-35 name=__codelineno-6-35 href=#__codelineno-6-35></a><span class=go>print(f&quot;Probabilities for each maximum value: {probabilities}&quot;)</span>
<a id=__codelineno-6-36 name=__codelineno-6-36 href=#__codelineno-6-36></a><span class=go>print(f&quot;Expected maximum value: {expected_max_value}&quot;)</span>
<a id=__codelineno-6-37 name=__codelineno-6-37 href=#__codelineno-6-37></a><span class=go>```</span>
<a id=__codelineno-6-38 name=__codelineno-6-38 href=#__codelineno-6-38></a>
<a id=__codelineno-6-39 name=__codelineno-6-39 href=#__codelineno-6-39></a><span class=go>Execute the code to get the result and follow through step-by-step calculations.</span>
</code></pre></div> <h2 id=mcts>MCTS<a class=headerlink href=#mcts title="Permanent link">#</a></h2> <p>This section demonstrates how to use Monte Carlo Tree Search (MCTS) with <a href=../../../api-reference/autogen/agents/experimental/ReasoningAgent><code>ReasoningAgent</code></a> for complex reasoning tasks. MCTS provides several advantages over beam search when:</p> <ol> <li>Ground truth evaluation is available</li> <li>LLM-based evaluation is expensive</li> <li>You want to generate diverse, high-quality training data</li> </ol> <div class=highlight><pre><span></span><code><a id=__codelineno-7-1 name=__codelineno-7-1 href=#__codelineno-7-1></a><span class=k>with</span> <span class=n>llm_config</span><span class=p>:</span>
<a id=__codelineno-7-2 name=__codelineno-7-2 href=#__codelineno-7-2></a>    <span class=n>mcts_agent</span> <span class=o>=</span> <span class=n>ReasoningAgent</span><span class=p>(</span>
<a id=__codelineno-7-3 name=__codelineno-7-3 href=#__codelineno-7-3></a>        <span class=n>name</span><span class=o>=</span><span class=s2>&quot;mcts_agent&quot;</span><span class=p>,</span>
<a id=__codelineno-7-4 name=__codelineno-7-4 href=#__codelineno-7-4></a>        <span class=n>system_message</span><span class=o>=</span><span class=s2>&quot;answer math questions&quot;</span><span class=p>,</span>
<a id=__codelineno-7-5 name=__codelineno-7-5 href=#__codelineno-7-5></a>        <span class=c1># setup small depth and simulations for conciseness.</span>
<a id=__codelineno-7-6 name=__codelineno-7-6 href=#__codelineno-7-6></a>        <span class=n>reason_config</span><span class=o>=</span><span class=p>{</span><span class=s2>&quot;method&quot;</span><span class=p>:</span> <span class=s2>&quot;mcts&quot;</span><span class=p>,</span> <span class=s2>&quot;nsim&quot;</span><span class=p>:</span> <span class=mi>3</span><span class=p>,</span> <span class=s2>&quot;max_depth&quot;</span><span class=p>:</span> <span class=mi>4</span><span class=p>},</span>
<a id=__codelineno-7-7 name=__codelineno-7-7 href=#__codelineno-7-7></a>    <span class=p>)</span>
<a id=__codelineno-7-8 name=__codelineno-7-8 href=#__codelineno-7-8></a>
<a id=__codelineno-7-9 name=__codelineno-7-9 href=#__codelineno-7-9></a><span class=n>ans</span> <span class=o>=</span> <span class=n>user_proxy</span><span class=o>.</span><span class=n>initiate_chat</span><span class=p>(</span><span class=n>mcts_agent</span><span class=p>,</span> <span class=n>message</span><span class=o>=</span><span class=n>question</span><span class=p>,</span> <span class=n>summary_method</span><span class=o>=</span><span class=n>last_meaningful_msg</span><span class=p>)</span>
<a id=__codelineno-7-10 name=__codelineno-7-10 href=#__codelineno-7-10></a>
<a id=__codelineno-7-11 name=__codelineno-7-11 href=#__codelineno-7-11></a><span class=nb>print</span><span class=p>(</span><span class=n>ans</span><span class=o>.</span><span class=n>summary</span><span class=p>)</span>
</code></pre></div> <div class=highlight><pre><span></span><code><a id=__codelineno-8-1 name=__codelineno-8-1 href=#__codelineno-8-1></a><span class=go>Let&#39;s break down the problem step by step, using the trajectory described:</span>
<a id=__codelineno-8-2 name=__codelineno-8-2 href=#__codelineno-8-2></a>
<a id=__codelineno-8-3 name=__codelineno-8-3 href=#__codelineno-8-3></a><span class=gp>#</span><span class=c1>## Step 1: Statistical Properties</span>
<a id=__codelineno-8-4 name=__codelineno-8-4 href=#__codelineno-8-4></a>
<a id=__codelineno-8-5 name=__codelineno-8-5 href=#__codelineno-8-5></a><span class=go>Consider a 6-sided die with faces numbered from 1 to 6. We want to find the expected maximum value when rolling the die three times.</span>
<a id=__codelineno-8-6 name=__codelineno-8-6 href=#__codelineno-8-6></a>
<a id=__codelineno-8-7 name=__codelineno-8-7 href=#__codelineno-8-7></a><span class=gp>#</span><span class=c1>## Step 2: Probability Distribution</span>
<a id=__codelineno-8-8 name=__codelineno-8-8 href=#__codelineno-8-8></a>
<a id=__codelineno-8-9 name=__codelineno-8-9 href=#__codelineno-8-9></a><span class=go>To calculate the expected maximum value, we need to determine the probability distribution for the maximum value when rolling three times:</span>
<a id=__codelineno-8-10 name=__codelineno-8-10 href=#__codelineno-8-10></a>
<a id=__codelineno-8-11 name=__codelineno-8-11 href=#__codelineno-8-11></a><span class=go>- The probability that the maximum value is 1: All three rolls must be 1.</span>
<a id=__codelineno-8-12 name=__codelineno-8-12 href=#__codelineno-8-12></a><span class=go>  \[</span>
<a id=__codelineno-8-13 name=__codelineno-8-13 href=#__codelineno-8-13></a><span class=go>  P(\text{max}=1) = \left(\frac{1}{6}\right)^3 = \frac{1}{216}</span>
<a id=__codelineno-8-14 name=__codelineno-8-14 href=#__codelineno-8-14></a><span class=go>  \]</span>
<a id=__codelineno-8-15 name=__codelineno-8-15 href=#__codelineno-8-15></a>
<a id=__codelineno-8-16 name=__codelineno-8-16 href=#__codelineno-8-16></a><span class=go>- The probability that the maximum value is 2: At least one roll must be 2, and no roll can be greater than 2.</span>
<a id=__codelineno-8-17 name=__codelineno-8-17 href=#__codelineno-8-17></a><span class=go>  \[</span>
<a id=__codelineno-8-18 name=__codelineno-8-18 href=#__codelineno-8-18></a><span class=go>  P(\text{max}=2) = \left(\frac{2}{6}\right)^3 - \left(\frac{1}{6}\right)^3 = \frac{8}{216} - \frac{1}{216} = \frac{7}{216}</span>
<a id=__codelineno-8-19 name=__codelineno-8-19 href=#__codelineno-8-19></a><span class=go>  \]</span>
<a id=__codelineno-8-20 name=__codelineno-8-20 href=#__codelineno-8-20></a>
<a id=__codelineno-8-21 name=__codelineno-8-21 href=#__codelineno-8-21></a><span class=go>- The probability that the maximum value is 3: At least one roll must be 3, and no roll can be greater than 3.</span>
<a id=__codelineno-8-22 name=__codelineno-8-22 href=#__codelineno-8-22></a><span class=go>  \[</span>
<a id=__codelineno-8-23 name=__codelineno-8-23 href=#__codelineno-8-23></a><span class=go>  P(\text{max}=3) = \left(\frac{3}{6}\right)^3 - \left(\frac{2}{6}\right)^3 = \frac{27}{216} - \frac{8}{216} = \frac{19}{216}</span>
<a id=__codelineno-8-24 name=__codelineno-8-24 href=#__codelineno-8-24></a><span class=go>  \]</span>
<a id=__codelineno-8-25 name=__codelineno-8-25 href=#__codelineno-8-25></a>
<a id=__codelineno-8-26 name=__codelineno-8-26 href=#__codelineno-8-26></a><span class=go>- The probability that the maximum value is 4: At least one roll must be 4, and no roll can be greater than 4.</span>
<a id=__codelineno-8-27 name=__codelineno-8-27 href=#__codelineno-8-27></a><span class=go>  \[</span>
<a id=__codelineno-8-28 name=__codelineno-8-28 href=#__codelineno-8-28></a><span class=go>  P(\text{max}=4) = \left(\frac{4}{6}\right)^3 - \left(\frac{3}{6}\right)^3 = \frac{64}{216} - \frac{27}{216} = \frac{37}{216}</span>
<a id=__codelineno-8-29 name=__codelineno-8-29 href=#__codelineno-8-29></a><span class=go>  \]</span>
<a id=__codelineno-8-30 name=__codelineno-8-30 href=#__codelineno-8-30></a>
<a id=__codelineno-8-31 name=__codelineno-8-31 href=#__codelineno-8-31></a><span class=go>- The probability that the maximum value is 5: At least one roll must be 5, and no roll can be greater than 5.</span>
<a id=__codelineno-8-32 name=__codelineno-8-32 href=#__codelineno-8-32></a><span class=go>  \[</span>
<a id=__codelineno-8-33 name=__codelineno-8-33 href=#__codelineno-8-33></a><span class=go>  P(\text{max}=5) = \left(\frac{5}{6}\right)^3 - \left(\frac{4}{6}\right)^3 = \frac{125}{216} - \frac{64}{216} = \frac{61}{216}</span>
<a id=__codelineno-8-34 name=__codelineno-8-34 href=#__codelineno-8-34></a><span class=go>  \]</span>
<a id=__codelineno-8-35 name=__codelineno-8-35 href=#__codelineno-8-35></a>
<a id=__codelineno-8-36 name=__codelineno-8-36 href=#__codelineno-8-36></a><span class=go>- The probability that the maximum value is 6: At least one roll must be 6.</span>
<a id=__codelineno-8-37 name=__codelineno-8-37 href=#__codelineno-8-37></a><span class=go>  \[</span>
<a id=__codelineno-8-38 name=__codelineno-8-38 href=#__codelineno-8-38></a><span class=go>  P(\text{max}=6) = 1 - \left(\frac{5}{6}\right)^3 = 1 - \frac{125}{216} = \frac{91}{216}</span>
<a id=__codelineno-8-39 name=__codelineno-8-39 href=#__codelineno-8-39></a><span class=go>  \]</span>
<a id=__codelineno-8-40 name=__codelineno-8-40 href=#__codelineno-8-40></a>
<a id=__codelineno-8-41 name=__codelineno-8-41 href=#__codelineno-8-41></a><span class=gp>#</span><span class=c1>## Step 3: Expected Maximum Value</span>
<a id=__codelineno-8-42 name=__codelineno-8-42 href=#__codelineno-8-42></a>
<a id=__codelineno-8-43 name=__codelineno-8-43 href=#__codelineno-8-43></a><span class=go>To find the expected maximum value, we multiply each possible maximum value by its probability and sum the results:</span>
<a id=__codelineno-8-44 name=__codelineno-8-44 href=#__codelineno-8-44></a>
<a id=__codelineno-8-45 name=__codelineno-8-45 href=#__codelineno-8-45></a><span class=go>\[</span>
<a id=__codelineno-8-46 name=__codelineno-8-46 href=#__codelineno-8-46></a><span class=go>E[\text{max}] = 1 \cdot \frac{1}{216} + 2 \cdot \frac{7}{216} + 3 \cdot \frac{19}{216} + 4 \cdot \frac{37}{216} + 5 \cdot \frac{61}{216} + 6 \cdot \frac{91}{216}</span>
<a id=__codelineno-8-47 name=__codelineno-8-47 href=#__codelineno-8-47></a><span class=go>\]</span>
<a id=__codelineno-8-48 name=__codelineno-8-48 href=#__codelineno-8-48></a>
<a id=__codelineno-8-49 name=__codelineno-8-49 href=#__codelineno-8-49></a><span class=go>Calculating these products:</span>
<a id=__codelineno-8-50 name=__codelineno-8-50 href=#__codelineno-8-50></a>
<a id=__codelineno-8-51 name=__codelineno-8-51 href=#__codelineno-8-51></a><span class=go>\[</span>
<a id=__codelineno-8-52 name=__codelineno-8-52 href=#__codelineno-8-52></a><span class=go>E[\text{max}] = \frac{1}{216} + \frac{14}{216} + \frac{57}{216} + \frac{148}{216} + \frac{305}{216} + \frac{546}{216}</span>
<a id=__codelineno-8-53 name=__codelineno-8-53 href=#__codelineno-8-53></a><span class=go>\]</span>
<a id=__codelineno-8-54 name=__codelineno-8-54 href=#__codelineno-8-54></a>
<a id=__codelineno-8-55 name=__codelineno-8-55 href=#__codelineno-8-55></a><span class=go>Summing them up:</span>
<a id=__codelineno-8-56 name=__codelineno-8-56 href=#__codelineno-8-56></a>
<a id=__codelineno-8-57 name=__codelineno-8-57 href=#__codelineno-8-57></a><span class=go>\[</span>
<a id=__codelineno-8-58 name=__codelineno-8-58 href=#__codelineno-8-58></a><span class=go>E[\text{max}] = \frac{1 + 14 + 57 + 148 + 305 + 546}{216} = \frac{1071}{216} \approx 4.96</span>
<a id=__codelineno-8-59 name=__codelineno-8-59 href=#__codelineno-8-59></a><span class=go>\]</span>
<a id=__codelineno-8-60 name=__codelineno-8-60 href=#__codelineno-8-60></a>
<a id=__codelineno-8-61 name=__codelineno-8-61 href=#__codelineno-8-61></a><span class=gp>#</span><span class=c1>## Final Answer</span>
<a id=__codelineno-8-62 name=__codelineno-8-62 href=#__codelineno-8-62></a>
<a id=__codelineno-8-63 name=__codelineno-8-63 href=#__codelineno-8-63></a><span class=go>The expected maximum value when rolling a 6-sided die three times is approximately 4.96.</span>
</code></pre></div> <h2 id=lats>LATS<a class=headerlink href=#lats title="Permanent link">#</a></h2> <p>It is important to note that our reasoning agent operates based on "process" and lacks direct access to the environment. In contrast, the LATS approach relies on feedback from the environment. To address this, we utilize our existing grader agent to generate pseudo-rewards and provide feedback. The major difference between our LATS implementation and our MCTS implementation is that the LATS approach incorporate the reflection into prompt context before next round of simulation. You can define the agent using the LATS approach as follows.</p> <p><div class=highlight><pre><span></span><code><a id=__codelineno-9-1 name=__codelineno-9-1 href=#__codelineno-9-1></a><span class=k>with</span> <span class=n>llm_config</span><span class=p>:</span>
<a id=__codelineno-9-2 name=__codelineno-9-2 href=#__codelineno-9-2></a>    <span class=n>lats_agent</span> <span class=o>=</span> <span class=n>ReasoningAgent</span><span class=p>(</span>
<a id=__codelineno-9-3 name=__codelineno-9-3 href=#__codelineno-9-3></a>        <span class=n>name</span><span class=o>=</span><span class=s2>&quot;mcts_agent&quot;</span><span class=p>,</span>
<a id=__codelineno-9-4 name=__codelineno-9-4 href=#__codelineno-9-4></a>        <span class=n>system_message</span><span class=o>=</span><span class=s2>&quot;answer math questions&quot;</span><span class=p>,</span>
<a id=__codelineno-9-5 name=__codelineno-9-5 href=#__codelineno-9-5></a>        <span class=c1># setup small depth and simulations for conciseness.</span>
<a id=__codelineno-9-6 name=__codelineno-9-6 href=#__codelineno-9-6></a>        <span class=n>reason_config</span><span class=o>=</span><span class=p>{</span><span class=s2>&quot;method&quot;</span><span class=p>:</span> <span class=s2>&quot;lats&quot;</span><span class=p>,</span> <span class=s2>&quot;nsim&quot;</span><span class=p>:</span> <span class=mi>3</span><span class=p>,</span> <span class=s2>&quot;max_depth&quot;</span><span class=p>:</span> <span class=mi>4</span><span class=p>},</span>
<a id=__codelineno-9-7 name=__codelineno-9-7 href=#__codelineno-9-7></a>    <span class=p>)</span>
<a id=__codelineno-9-8 name=__codelineno-9-8 href=#__codelineno-9-8></a>
<a id=__codelineno-9-9 name=__codelineno-9-9 href=#__codelineno-9-9></a><span class=n>ans</span> <span class=o>=</span> <span class=n>user_proxy</span><span class=o>.</span><span class=n>initiate_chat</span><span class=p>(</span><span class=n>lats_agent</span><span class=p>,</span> <span class=n>message</span><span class=o>=</span><span class=n>question</span><span class=p>,</span> <span class=n>summary_method</span><span class=o>=</span><span class=n>last_meaningful_msg</span><span class=p>)</span>
<a id=__codelineno-9-10 name=__codelineno-9-10 href=#__codelineno-9-10></a>
<a id=__codelineno-9-11 name=__codelineno-9-11 href=#__codelineno-9-11></a><span class=nb>print</span><span class=p>(</span><span class=n>ans</span><span class=o>.</span><span class=n>summary</span><span class=p>)</span>
</code></pre></div> <div class=highlight><pre><span></span><code><a id=__codelineno-10-1 name=__codelineno-10-1 href=#__codelineno-10-1></a><span class=go>Let&#39;s break down the problem step by step, using the trajectory described:</span>
<a id=__codelineno-10-2 name=__codelineno-10-2 href=#__codelineno-10-2></a>
<a id=__codelineno-10-3 name=__codelineno-10-3 href=#__codelineno-10-3></a><span class=gp>#</span><span class=c1>## Step 1: Statistical Properties</span>
<a id=__codelineno-10-4 name=__codelineno-10-4 href=#__codelineno-10-4></a>
<a id=__codelineno-10-5 name=__codelineno-10-5 href=#__codelineno-10-5></a><span class=go>Consider a 6-sided die with faces numbered from 1 to 6. We want to find the expected maximum value when rolling the die three times.</span>
<a id=__codelineno-10-6 name=__codelineno-10-6 href=#__codelineno-10-6></a>
<a id=__codelineno-10-7 name=__codelineno-10-7 href=#__codelineno-10-7></a><span class=gp>#</span><span class=c1>## Step 2: Probability Distribution</span>
<a id=__codelineno-10-8 name=__codelineno-10-8 href=#__codelineno-10-8></a>
<a id=__codelineno-10-9 name=__codelineno-10-9 href=#__codelineno-10-9></a><span class=go>To calculate the expected maximum value, we need to determine the probability distribution for the maximum value when rolling three times:</span>
<a id=__codelineno-10-10 name=__codelineno-10-10 href=#__codelineno-10-10></a>
<a id=__codelineno-10-11 name=__codelineno-10-11 href=#__codelineno-10-11></a><span class=go>- The probability that the maximum value is 1: All three rolls must be 1.</span>
<a id=__codelineno-10-12 name=__codelineno-10-12 href=#__codelineno-10-12></a><span class=go>  \[</span>
<a id=__codelineno-10-13 name=__codelineno-10-13 href=#__codelineno-10-13></a><span class=go>  P(\text{max}=1) = \left(\frac{1}{6}\right)^3 = \frac{1}{216}</span>
<a id=__codelineno-10-14 name=__codelineno-10-14 href=#__codelineno-10-14></a><span class=go>  \]</span>
<a id=__codelineno-10-15 name=__codelineno-10-15 href=#__codelineno-10-15></a>
<a id=__codelineno-10-16 name=__codelineno-10-16 href=#__codelineno-10-16></a><span class=go>- The probability that the maximum value is 2: At least one roll must be 2, and no roll can be greater than 2.</span>
<a id=__codelineno-10-17 name=__codelineno-10-17 href=#__codelineno-10-17></a><span class=go>  \[</span>
<a id=__codelineno-10-18 name=__codelineno-10-18 href=#__codelineno-10-18></a><span class=go>  P(\text{max}=2) = \left(\frac{2}{6}\right)^3 - \left(\frac{1}{6}\right)^3 = \frac{8}{216} - \frac{1}{216} = \frac{7}{216}</span>
<a id=__codelineno-10-19 name=__codelineno-10-19 href=#__codelineno-10-19></a><span class=go>  \]</span>
<a id=__codelineno-10-20 name=__codelineno-10-20 href=#__codelineno-10-20></a>
<a id=__codelineno-10-21 name=__codelineno-10-21 href=#__codelineno-10-21></a><span class=go>- The probability that the maximum value is 3: At least one roll must be 3, and no roll can be greater than 3.</span>
<a id=__codelineno-10-22 name=__codelineno-10-22 href=#__codelineno-10-22></a><span class=go>  \[</span>
<a id=__codelineno-10-23 name=__codelineno-10-23 href=#__codelineno-10-23></a><span class=go>  P(\text{max}=3) = \left(\frac{3}{6}\right)^3 - \left(\frac{2}{6}\right)^3 = \frac{27}{216} - \frac{8}{216} = \frac{19}{216}</span>
<a id=__codelineno-10-24 name=__codelineno-10-24 href=#__codelineno-10-24></a><span class=go>  \]</span>
<a id=__codelineno-10-25 name=__codelineno-10-25 href=#__codelineno-10-25></a>
<a id=__codelineno-10-26 name=__codelineno-10-26 href=#__codelineno-10-26></a><span class=go>- The probability that the maximum value is 4: At least one roll must be 4, and no roll can be greater than 4.</span>
<a id=__codelineno-10-27 name=__codelineno-10-27 href=#__codelineno-10-27></a><span class=go>  \[</span>
<a id=__codelineno-10-28 name=__codelineno-10-28 href=#__codelineno-10-28></a><span class=go>  P(\text{max}=4) = \left(\frac{4}{6}\right)^3 - \left(\frac{3}{6}\right)^3 = \frac{64}{216} - \frac{27}{216} = \frac{37}{216}</span>
<a id=__codelineno-10-29 name=__codelineno-10-29 href=#__codelineno-10-29></a><span class=go>  \]</span>
<a id=__codelineno-10-30 name=__codelineno-10-30 href=#__codelineno-10-30></a>
<a id=__codelineno-10-31 name=__codelineno-10-31 href=#__codelineno-10-31></a><span class=go>- The probability that the maximum value is 5: At least one roll must be 5, and no roll can be greater than 5.</span>
<a id=__codelineno-10-32 name=__codelineno-10-32 href=#__codelineno-10-32></a><span class=go>  \[</span>
<a id=__codelineno-10-33 name=__codelineno-10-33 href=#__codelineno-10-33></a><span class=go>  P(\text{max}=5) = \left(\frac{5}{6}\right)^3 - \left(\frac{4}{6}\right)^3 = \frac{125}{216} - \frac{64}{216} = \frac{61}{216}</span>
<a id=__codelineno-10-34 name=__codelineno-10-34 href=#__codelineno-10-34></a><span class=go>  \]</span>
<a id=__codelineno-10-35 name=__codelineno-10-35 href=#__codelineno-10-35></a>
<a id=__codelineno-10-36 name=__codelineno-10-36 href=#__codelineno-10-36></a><span class=go>- The probability that the maximum value is 6: At least one roll must be 6.</span>
<a id=__codelineno-10-37 name=__codelineno-10-37 href=#__codelineno-10-37></a><span class=go>  \[</span>
<a id=__codelineno-10-38 name=__codelineno-10-38 href=#__codelineno-10-38></a><span class=go>  P(\text{max}=6) = 1 - \left(\frac{5}{6}\right)^3 = 1 - \frac{125}{216} = \frac{91}{216}</span>
<a id=__codelineno-10-39 name=__codelineno-10-39 href=#__codelineno-10-39></a><span class=go>  \]</span>
<a id=__codelineno-10-40 name=__codelineno-10-40 href=#__codelineno-10-40></a>
<a id=__codelineno-10-41 name=__codelineno-10-41 href=#__codelineno-10-41></a><span class=gp>#</span><span class=c1>## Step 3: Expected Maximum Value</span>
<a id=__codelineno-10-42 name=__codelineno-10-42 href=#__codelineno-10-42></a>
<a id=__codelineno-10-43 name=__codelineno-10-43 href=#__codelineno-10-43></a><span class=go>To find the expected maximum value, we multiply each possible maximum value by its probability and sum the results:</span>
<a id=__codelineno-10-44 name=__codelineno-10-44 href=#__codelineno-10-44></a>
<a id=__codelineno-10-45 name=__codelineno-10-45 href=#__codelineno-10-45></a><span class=go>\[</span>
<a id=__codelineno-10-46 name=__codelineno-10-46 href=#__codelineno-10-46></a><span class=go>E[\text{max}] = 1 \cdot \frac{1}{216} + 2 \cdot \frac{7}{216} + 3 \cdot \frac{19}{216} + 4 \cdot \frac{37}{216} + 5 \cdot \frac{61}{216} + 6 \cdot \frac{91}{216}</span>
<a id=__codelineno-10-47 name=__codelineno-10-47 href=#__codelineno-10-47></a><span class=go>\]</span>
<a id=__codelineno-10-48 name=__codelineno-10-48 href=#__codelineno-10-48></a>
<a id=__codelineno-10-49 name=__codelineno-10-49 href=#__codelineno-10-49></a><span class=go>Calculating these products:</span>
<a id=__codelineno-10-50 name=__codelineno-10-50 href=#__codelineno-10-50></a>
<a id=__codelineno-10-51 name=__codelineno-10-51 href=#__codelineno-10-51></a><span class=go>\[</span>
<a id=__codelineno-10-52 name=__codelineno-10-52 href=#__codelineno-10-52></a><span class=go>E[\text{max}] = \frac{1}{216} + \frac{14}{216} + \frac{57}{216} + \frac{148}{216} + \frac{305}{216} + \frac{546}{216}</span>
<a id=__codelineno-10-53 name=__codelineno-10-53 href=#__codelineno-10-53></a><span class=go>\]</span>
<a id=__codelineno-10-54 name=__codelineno-10-54 href=#__codelineno-10-54></a>
<a id=__codelineno-10-55 name=__codelineno-10-55 href=#__codelineno-10-55></a><span class=go>Summing them up:</span>
<a id=__codelineno-10-56 name=__codelineno-10-56 href=#__codelineno-10-56></a>
<a id=__codelineno-10-57 name=__codelineno-10-57 href=#__codelineno-10-57></a><span class=go>\[</span>
<a id=__codelineno-10-58 name=__codelineno-10-58 href=#__codelineno-10-58></a><span class=go>E[\text{max}] = \frac{1 + 14 + 57 + 148 + 305 + 546}{216} = \frac{1071}{216} \approx 4.96</span>
<a id=__codelineno-10-59 name=__codelineno-10-59 href=#__codelineno-10-59></a><span class=go>\]</span>
<a id=__codelineno-10-60 name=__codelineno-10-60 href=#__codelineno-10-60></a>
<a id=__codelineno-10-61 name=__codelineno-10-61 href=#__codelineno-10-61></a><span class=gp>#</span><span class=c1>## Final Answer</span>
<a id=__codelineno-10-62 name=__codelineno-10-62 href=#__codelineno-10-62></a>
<a id=__codelineno-10-63 name=__codelineno-10-63 href=#__codelineno-10-63></a><span class=go>The expected maximum value when rolling a 6-sided die three times is approximately 4.96.</span>
</code></pre></div></p> <h2 id=interim-execution-during-reasoning>Interim Execution During Reasoning<a class=headerlink href=#interim-execution-during-reasoning title="Permanent link">#</a></h2> <p>You can enable <code>interim_execution</code> by setting it to <code>True</code> in <code>reason_config</code>. This allows intermediate steps to be executed during the reasoning process, promoting more effective step-by-step thinking and enabling future steps to be informed by the outputs of earlier ones. By default <code>interim_execution</code> is <code>False</code> which means that the selected steps won't be executed during reasoning.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-11-1 name=__codelineno-11-1 href=#__codelineno-11-1></a><span class=k>with</span> <span class=n>llm_config</span><span class=p>:</span>
<a id=__codelineno-11-2 name=__codelineno-11-2 href=#__codelineno-11-2></a>    <span class=n>lats_agent</span> <span class=o>=</span> <span class=n>ReasoningAgent</span><span class=p>(</span>
<a id=__codelineno-11-3 name=__codelineno-11-3 href=#__codelineno-11-3></a>        <span class=n>name</span><span class=o>=</span><span class=s2>&quot;mcts_agent&quot;</span><span class=p>,</span>
<a id=__codelineno-11-4 name=__codelineno-11-4 href=#__codelineno-11-4></a>        <span class=n>system_message</span><span class=o>=</span><span class=s2>&quot;answer math questions&quot;</span><span class=p>,</span>
<a id=__codelineno-11-5 name=__codelineno-11-5 href=#__codelineno-11-5></a>        <span class=n>reason_config</span><span class=o>=</span><span class=p>{</span><span class=s2>&quot;method&quot;</span><span class=p>:</span> <span class=s2>&quot;lats&quot;</span><span class=p>,</span> <span class=s2>&quot;nsim&quot;</span><span class=p>:</span> <span class=mi>3</span><span class=p>,</span> <span class=s2>&quot;max_depth&quot;</span><span class=p>:</span> <span class=mi>4</span><span class=p>,</span> <span class=s2>&quot;interim_execution&quot;</span><span class=p>:</span> <span class=kc>True</span><span class=p>},</span>
<a id=__codelineno-11-6 name=__codelineno-11-6 href=#__codelineno-11-6></a>    <span class=p>)</span>
<a id=__codelineno-11-7 name=__codelineno-11-7 href=#__codelineno-11-7></a>
<a id=__codelineno-11-8 name=__codelineno-11-8 href=#__codelineno-11-8></a><span class=n>ans</span> <span class=o>=</span> <span class=n>user_proxy</span><span class=o>.</span><span class=n>initiate_chat</span><span class=p>(</span><span class=n>lats_agent</span><span class=p>,</span> <span class=n>message</span><span class=o>=</span><span class=n>question</span><span class=p>,</span> <span class=n>summary_method</span><span class=o>=</span><span class=n>last_meaningful_msg</span><span class=p>)</span>
<a id=__codelineno-11-9 name=__codelineno-11-9 href=#__codelineno-11-9></a>
<a id=__codelineno-11-10 name=__codelineno-11-10 href=#__codelineno-11-10></a><span class=nb>print</span><span class=p>(</span><span class=n>ans</span><span class=o>.</span><span class=n>summary</span><span class=p>)</span>
</code></pre></div> <div class=highlight><pre><span></span><code><a id=__codelineno-12-1 name=__codelineno-12-1 href=#__codelineno-12-1></a><span class=go>Given a thinking process, you have to provide a complete response to a user&#39;s question.</span>
<a id=__codelineno-12-2 name=__codelineno-12-2 href=#__codelineno-12-2></a><span class=go>Question:</span>
<a id=__codelineno-12-3 name=__codelineno-12-3 href=#__codelineno-12-3></a><span class=go>What is the expected maximum dice value if you can roll a 6-sided dice three times?</span>
<a id=__codelineno-12-4 name=__codelineno-12-4 href=#__codelineno-12-4></a>
<a id=__codelineno-12-5 name=__codelineno-12-5 href=#__codelineno-12-5></a><span class=go>Thinking process:</span>
<a id=__codelineno-12-6 name=__codelineno-12-6 href=#__codelineno-12-6></a><span class=gp># </span>Question:
<a id=__codelineno-12-7 name=__codelineno-12-7 href=#__codelineno-12-7></a><span class=go>Content: What is the expected maximum dice value if you can roll a 6-sided dice three times?</span>
<a id=__codelineno-12-8 name=__codelineno-12-8 href=#__codelineno-12-8></a><span class=go>---</span>
<a id=__codelineno-12-9 name=__codelineno-12-9 href=#__codelineno-12-9></a><span class=gp># </span>Trajectory:
<a id=__codelineno-12-10 name=__codelineno-12-10 href=#__codelineno-12-10></a>
<a id=__codelineno-12-11 name=__codelineno-12-11 href=#__codelineno-12-11></a><span class=go>Step 1:</span>
<a id=__codelineno-12-12 name=__codelineno-12-12 href=#__codelineno-12-12></a><span class=go>Content: Identify the process</span>
<a id=__codelineno-12-13 name=__codelineno-12-13 href=#__codelineno-12-13></a><span class=go>To determine the expected maximum dice value, we need to calculate the probability for each possible maximum value (1 through 6) across three rolls and compute the expected value using these probabilities.</span>
<a id=__codelineno-12-14 name=__codelineno-12-14 href=#__codelineno-12-14></a>
<a id=__codelineno-12-15 name=__codelineno-12-15 href=#__codelineno-12-15></a><span class=go>Step 2:</span>
<a id=__codelineno-12-16 name=__codelineno-12-16 href=#__codelineno-12-16></a><span class=go>Content: Probability calculation</span>
<a id=__codelineno-12-17 name=__codelineno-12-17 href=#__codelineno-12-17></a><span class=go>Calculate the probability of each possible maximum value (1 through 6) for three rolls. The probability that the maximum value is exactly \( k \) can be computed using the formula:</span>
<a id=__codelineno-12-18 name=__codelineno-12-18 href=#__codelineno-12-18></a><span class=go>\[ P(\text{max} = k) = \left( \frac{k}{6} \right)^3 - \left( \frac{k-1}{6} \right)^3 \]</span>
<a id=__codelineno-12-19 name=__codelineno-12-19 href=#__codelineno-12-19></a>
<a id=__codelineno-12-20 name=__codelineno-12-20 href=#__codelineno-12-20></a><span class=go>Step 3:</span>
<a id=__codelineno-12-21 name=__codelineno-12-21 href=#__codelineno-12-21></a><span class=go>Content: Expected value calculation</span>
<a id=__codelineno-12-22 name=__codelineno-12-22 href=#__codelineno-12-22></a><span class=go>Combine probabilities calculated for individual maximum values to determine the expected maximum value:</span>
<a id=__codelineno-12-23 name=__codelineno-12-23 href=#__codelineno-12-23></a><span class=go>\[ E(\text{max}) = \sum_{k=1}^{6} k \cdot P(\text{max} = k) \]</span>
<a id=__codelineno-12-24 name=__codelineno-12-24 href=#__codelineno-12-24></a>
<a id=__codelineno-12-25 name=__codelineno-12-25 href=#__codelineno-12-25></a><span class=go>Step 4:</span>
<a id=__codelineno-12-26 name=__codelineno-12-26 href=#__codelineno-12-26></a><span class=go>Content: Compute individual probabilities and sum the results</span>
<a id=__codelineno-12-27 name=__codelineno-12-27 href=#__codelineno-12-27></a><span class=go>Calculate each probability \( P(\text{max} = k) \) for \( k \) from 1 to 6. Use these probabilities to sum up the expected value:</span>
<a id=__codelineno-12-28 name=__codelineno-12-28 href=#__codelineno-12-28></a><span class=go>\[ E(\text{max}) = \sum_{k=1}^{6} k \left( \left( \frac{k}{6} \right)^3 - \left( \frac{k-1}{6} \right)^3 \right) \]</span>
<a id=__codelineno-12-29 name=__codelineno-12-29 href=#__codelineno-12-29></a>
<a id=__codelineno-12-30 name=__codelineno-12-30 href=#__codelineno-12-30></a><span class=go>Step 5:</span>
<a id=__codelineno-12-31 name=__codelineno-12-31 href=#__codelineno-12-31></a><span class=go>Content: Final result</span>
<a id=__codelineno-12-32 name=__codelineno-12-32 href=#__codelineno-12-32></a><span class=go>Compute the numerical value of the expected maximum.</span>
<a id=__codelineno-12-33 name=__codelineno-12-33 href=#__codelineno-12-33></a>
<a id=__codelineno-12-34 name=__codelineno-12-34 href=#__codelineno-12-34></a><span class=go>Final Answer:</span>
<a id=__codelineno-12-35 name=__codelineno-12-35 href=#__codelineno-12-35></a><span class=go>Let&#39;s perform the calculations step-by-step.</span>
<a id=__codelineno-12-36 name=__codelineno-12-36 href=#__codelineno-12-36></a>
<a id=__codelineno-12-37 name=__codelineno-12-37 href=#__codelineno-12-37></a><span class=go>The probability that the maximum value after rolling three times is less than or equal to \( k \) is:</span>
<a id=__codelineno-12-38 name=__codelineno-12-38 href=#__codelineno-12-38></a><span class=go>\[ P(\text{max} \le k) = \left( \frac{k}{6} \right)^3 \]</span>
<a id=__codelineno-12-39 name=__codelineno-12-39 href=#__codelineno-12-39></a>
<a id=__codelineno-12-40 name=__codelineno-12-40 href=#__codelineno-12-40></a><span class=go>Therefore, the probability that the maximum value is exactly \( k \) is:</span>
<a id=__codelineno-12-41 name=__codelineno-12-41 href=#__codelineno-12-41></a><span class=go>\[ P(\text{max} = k) = P(\text{max} \le k) - P(\text{max} \le k-1) = \left( \frac{k}{6} \right)^3 - \left( \frac{k-1}{6} \right)^3 \]</span>
<a id=__codelineno-12-42 name=__codelineno-12-42 href=#__codelineno-12-42></a>
<a id=__codelineno-12-43 name=__codelineno-12-43 href=#__codelineno-12-43></a><span class=go>We can calculate the expected value using these probabilities:</span>
<a id=__codelineno-12-44 name=__codelineno-12-44 href=#__codelineno-12-44></a><span class=go>\[</span>
<a id=__codelineno-12-45 name=__codelineno-12-45 href=#__codelineno-12-45></a><span class=go>E(\text{max}) = \sum_{k=1}^{6} k \cdot P(\text{max} = k)</span>
<a id=__codelineno-12-46 name=__codelineno-12-46 href=#__codelineno-12-46></a><span class=go>\]</span>
<a id=__codelineno-12-47 name=__codelineno-12-47 href=#__codelineno-12-47></a><span class=go>Substituting the probabilities, we get:</span>
<a id=__codelineno-12-48 name=__codelineno-12-48 href=#__codelineno-12-48></a><span class=go>\[</span>
<a id=__codelineno-12-49 name=__codelineno-12-49 href=#__codelineno-12-49></a><span class=go>E(\text{max}) = \sum_{k=1}^{6} k \left( \left( \frac{k}{6} \right)^3 - \left( \frac{k-1}{6} \right)^3 \right)</span>
<a id=__codelineno-12-50 name=__codelineno-12-50 href=#__codelineno-12-50></a><span class=go>\]</span>
<a id=__codelineno-12-51 name=__codelineno-12-51 href=#__codelineno-12-51></a>
<a id=__codelineno-12-52 name=__codelineno-12-52 href=#__codelineno-12-52></a><span class=go>Let&#39;s calculate each term:</span>
<a id=__codelineno-12-53 name=__codelineno-12-53 href=#__codelineno-12-53></a><span class=go>\[</span>
<a id=__codelineno-12-54 name=__codelineno-12-54 href=#__codelineno-12-54></a><span class=go>P(\text{max}=1) = \left( \frac{1}{6} \right)^3 - \left( \frac{0}{6} \right)^3 = \frac{1}{216}</span>
<a id=__codelineno-12-55 name=__codelineno-12-55 href=#__codelineno-12-55></a><span class=go>\]</span>
<a id=__codelineno-12-56 name=__codelineno-12-56 href=#__codelineno-12-56></a><span class=go>\[</span>
<a id=__codelineno-12-57 name=__codelineno-12-57 href=#__codelineno-12-57></a><span class=go>P(\text{max}=2) = \left( \frac{2}{6} \right)^3 - \left( \frac{1}{6} \right)^3 = \frac{8}{216} - \frac{1}{216} = \frac{7}{216}</span>
<a id=__codelineno-12-58 name=__codelineno-12-58 href=#__codelineno-12-58></a><span class=go>\]</span>
<a id=__codelineno-12-59 name=__codelineno-12-59 href=#__codelineno-12-59></a><span class=go>\[</span>
<a id=__codelineno-12-60 name=__codelineno-12-60 href=#__codelineno-12-60></a><span class=go>P(\text{max}=3) = \left( \frac{3}{6} \right)^3 - \left( \frac{2}{6} \right)^3 = \frac{27}{216} - \frac{8}{216} = \frac{19}{216}</span>
<a id=__codelineno-12-61 name=__codelineno-12-61 href=#__codelineno-12-61></a><span class=go>\]</span>
<a id=__codelineno-12-62 name=__codelineno-12-62 href=#__codelineno-12-62></a><span class=go>\[</span>
<a id=__codelineno-12-63 name=__codelineno-12-63 href=#__codelineno-12-63></a><span class=go>P(\text{max}=4) = \left( \frac{4}{6} \right)^3 - \left( \frac{3}{6} \right)^3 = \frac{64}{216} - \frac{27}{216} = \frac{37}{216}</span>
<a id=__codelineno-12-64 name=__codelineno-12-64 href=#__codelineno-12-64></a><span class=go>\]</span>
<a id=__codelineno-12-65 name=__codelineno-12-65 href=#__codelineno-12-65></a><span class=go>\[</span>
<a id=__codelineno-12-66 name=__codelineno-12-66 href=#__codelineno-12-66></a><span class=go>P(\text{max}=5) = \left( \frac{5}{6} \right)^3 - \left( \frac{4}{6} \right)^3 = \frac{125}{216} - \frac{64}{216} = \frac{61}{216}</span>
<a id=__codelineno-12-67 name=__codelineno-12-67 href=#__codelineno-12-67></a><span class=go>\]</span>
<a id=__codelineno-12-68 name=__codelineno-12-68 href=#__codelineno-12-68></a><span class=go>\[</span>
<a id=__codelineno-12-69 name=__codelineno-12-69 href=#__codelineno-12-69></a><span class=go>P(\text{max}=6) = \left( \frac{6}{6} \right)^3 - \left( \frac{5}{6} \right)^3 = 1 - \frac{125}{216} = \frac{91}{216}</span>
<a id=__codelineno-12-70 name=__codelineno-12-70 href=#__codelineno-12-70></a><span class=go>\]</span>
<a id=__codelineno-12-71 name=__codelineno-12-71 href=#__codelineno-12-71></a>
<a id=__codelineno-12-72 name=__codelineno-12-72 href=#__codelineno-12-72></a><span class=go>Now, calculate the expected maximum:</span>
<a id=__codelineno-12-73 name=__codelineno-12-73 href=#__codelineno-12-73></a><span class=go>\[</span>
<a id=__codelineno-12-74 name=__codelineno-12-74 href=#__codelineno-12-74></a><span class=go>E(\text{max}) = 1 \cdot \frac{1}{216} + 2 \cdot \frac{7}{216} + 3 \cdot \frac{19}{216} + 4 \cdot \frac{37}{216} + 5 \cdot \frac{61}{216} + 6 \cdot \frac{91}{216}</span>
<a id=__codelineno-12-75 name=__codelineno-12-75 href=#__codelineno-12-75></a><span class=go>\]</span>
<a id=__codelineno-12-76 name=__codelineno-12-76 href=#__codelineno-12-76></a>
<a id=__codelineno-12-77 name=__codelineno-12-77 href=#__codelineno-12-77></a><span class=go>\[</span>
<a id=__codelineno-12-78 name=__codelineno-12-78 href=#__codelineno-12-78></a><span class=go>E(\text{max}) = \frac{1}{216} + \frac{14}{216} + \frac{57}{216} + \frac{148}{216} + \frac{305}{216} + \frac{546}{216}</span>
<a id=__codelineno-12-79 name=__codelineno-12-79 href=#__codelineno-12-79></a><span class=go>\]</span>
<a id=__codelineno-12-80 name=__codelineno-12-80 href=#__codelineno-12-80></a>
<a id=__codelineno-12-81 name=__codelineno-12-81 href=#__codelineno-12-81></a><span class=go>\[</span>
<a id=__codelineno-12-82 name=__codelineno-12-82 href=#__codelineno-12-82></a><span class=go>E(\text{max}) = \frac{1071}{216} \approx 4.958</span>
<a id=__codelineno-12-83 name=__codelineno-12-83 href=#__codelineno-12-83></a><span class=go>\]</span>
<a id=__codelineno-12-84 name=__codelineno-12-84 href=#__codelineno-12-84></a>
<a id=__codelineno-12-85 name=__codelineno-12-85 href=#__codelineno-12-85></a><span class=go>Thus, if you roll a 6-sided die three times, the expected maximum value is approximately 4.958.</span>
</code></pre></div> <h2 id=code-execution-during-reasoning>Code Execution During Reasoning<a class=headerlink href=#code-execution-during-reasoning title="Permanent link">#</a></h2> <p>You can setup the parameter <code>code_execution_config</code> in reasoning agent to enable code execution during reasoning. By default, <code>code_execution_config=False</code>, which means it will not execute code for reasoning. Note that to allow for code execution, <code>interim_execution</code> must be set to <code>True</code> at <code>reason_config</code>.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-13-1 name=__codelineno-13-1 href=#__codelineno-13-1></a><span class=k>with</span> <span class=n>llm_config</span><span class=p>:</span>
<a id=__codelineno-13-2 name=__codelineno-13-2 href=#__codelineno-13-2></a>    <span class=n>lats_agent</span> <span class=o>=</span> <span class=n>ReasoningAgent</span><span class=p>(</span>
<a id=__codelineno-13-3 name=__codelineno-13-3 href=#__codelineno-13-3></a>        <span class=n>name</span><span class=o>=</span><span class=s2>&quot;mcts_agent&quot;</span><span class=p>,</span>
<a id=__codelineno-13-4 name=__codelineno-13-4 href=#__codelineno-13-4></a>        <span class=n>system_message</span><span class=o>=</span><span class=s2>&quot;answer math questions&quot;</span><span class=p>,</span>
<a id=__codelineno-13-5 name=__codelineno-13-5 href=#__codelineno-13-5></a>        <span class=n>reason_config</span><span class=o>=</span><span class=p>{</span><span class=s2>&quot;method&quot;</span><span class=p>:</span> <span class=s2>&quot;lats&quot;</span><span class=p>,</span> <span class=s2>&quot;nsim&quot;</span><span class=p>:</span> <span class=mi>3</span><span class=p>,</span> <span class=s2>&quot;max_depth&quot;</span><span class=p>:</span> <span class=mi>4</span><span class=p>,</span> <span class=s1>&#39;interim_execution&#39;</span><span class=p>:</span> <span class=kc>True</span><span class=p>},</span>
<a id=__codelineno-13-6 name=__codelineno-13-6 href=#__codelineno-13-6></a>        <span class=n>code_execution_config</span><span class=o>=</span><span class=p>{</span><span class=s2>&quot;use_docker&quot;</span><span class=p>:</span> <span class=kc>False</span><span class=p>,</span> <span class=s2>&quot;work_dir&quot;</span><span class=p>:</span> <span class=s2>&quot;mypy_cache&quot;</span><span class=p>},</span>
<a id=__codelineno-13-7 name=__codelineno-13-7 href=#__codelineno-13-7></a>        <span class=c1># Enable Code execution. We skip docker here for simplicity</span>
<a id=__codelineno-13-8 name=__codelineno-13-8 href=#__codelineno-13-8></a>    <span class=p>)</span>
<a id=__codelineno-13-9 name=__codelineno-13-9 href=#__codelineno-13-9></a>
<a id=__codelineno-13-10 name=__codelineno-13-10 href=#__codelineno-13-10></a><span class=n>ans</span> <span class=o>=</span> <span class=n>user_proxy</span><span class=o>.</span><span class=n>initiate_chat</span><span class=p>(</span>
<a id=__codelineno-13-11 name=__codelineno-13-11 href=#__codelineno-13-11></a>    <span class=n>lats_agent</span><span class=p>,</span>
<a id=__codelineno-13-12 name=__codelineno-13-12 href=#__codelineno-13-12></a>    <span class=n>message</span><span class=o>=</span><span class=n>question</span> <span class=o>+</span> <span class=s2>&quot; Run a python simulation to get the result&quot;</span><span class=p>,</span>
<a id=__codelineno-13-13 name=__codelineno-13-13 href=#__codelineno-13-13></a>    <span class=n>summary_method</span><span class=o>=</span><span class=n>last_meaningful_msg</span>
<a id=__codelineno-13-14 name=__codelineno-13-14 href=#__codelineno-13-14></a>    <span class=p>)</span>
<a id=__codelineno-13-15 name=__codelineno-13-15 href=#__codelineno-13-15></a>
<a id=__codelineno-13-16 name=__codelineno-13-16 href=#__codelineno-13-16></a><span class=nb>print</span><span class=p>(</span><span class=n>ans</span><span class=o>.</span><span class=n>summary</span><span class=p>)</span>
</code></pre></div> <div class=highlight><pre><span></span><code><a id=__codelineno-14-1 name=__codelineno-14-1 href=#__codelineno-14-1></a><span class=go>Sure, I can run a Python simulation to estimate the expected maximum value when rolling a 6-sided dice three times. Here is the Python script:</span>
<a id=__codelineno-14-2 name=__codelineno-14-2 href=#__codelineno-14-2></a>
<a id=__codelineno-14-3 name=__codelineno-14-3 href=#__codelineno-14-3></a><span class=go>```python</span>
<a id=__codelineno-14-4 name=__codelineno-14-4 href=#__codelineno-14-4></a><span class=go>import random</span>
<a id=__codelineno-14-5 name=__codelineno-14-5 href=#__codelineno-14-5></a><span class=go>import collections</span>
<a id=__codelineno-14-6 name=__codelineno-14-6 href=#__codelineno-14-6></a>
<a id=__codelineno-14-7 name=__codelineno-14-7 href=#__codelineno-14-7></a><span class=go>def roll_and_max():</span>
<a id=__codelineno-14-8 name=__codelineno-14-8 href=#__codelineno-14-8></a><span class=go>    rolls = [random.randint(1, 6) for _ in range(3)]</span>
<a id=__codelineno-14-9 name=__codelineno-14-9 href=#__codelineno-14-9></a><span class=go>    return max(rolls)</span>
<a id=__codelineno-14-10 name=__codelineno-14-10 href=#__codelineno-14-10></a>
<a id=__codelineno-14-11 name=__codelineno-14-11 href=#__codelineno-14-11></a><span class=go>def simulate_max_dice_value(num_trials):</span>
<a id=__codelineno-14-12 name=__codelineno-14-12 href=#__codelineno-14-12></a><span class=go>    results = [roll_and_max() for _ in range(num_trials)]</span>
<a id=__codelineno-14-13 name=__codelineno-14-13 href=#__codelineno-14-13></a><span class=go>    expected_max_value = sum(results) / num_trials</span>
<a id=__codelineno-14-14 name=__codelineno-14-14 href=#__codelineno-14-14></a><span class=go>    return expected_max_value</span>
<a id=__codelineno-14-15 name=__codelineno-14-15 href=#__codelineno-14-15></a>
<a id=__codelineno-14-16 name=__codelineno-14-16 href=#__codelineno-14-16></a><span class=go>def analyze_distribution(num_trials):</span>
<a id=__codelineno-14-17 name=__codelineno-14-17 href=#__codelineno-14-17></a><span class=go>    results = [roll_and_max() for _ in range(num_trials)]</span>
<a id=__codelineno-14-18 name=__codelineno-14-18 href=#__codelineno-14-18></a><span class=go>    counter = collections.Counter(results)</span>
<a id=__codelineno-14-19 name=__codelineno-14-19 href=#__codelineno-14-19></a><span class=go>    for value in sorted(counter):</span>
<a id=__codelineno-14-20 name=__codelineno-14-20 href=#__codelineno-14-20></a><span class=go>        print(f&quot;Maximum Value: {value}, Frequency: {counter[value]}&quot;)</span>
<a id=__codelineno-14-21 name=__codelineno-14-21 href=#__codelineno-14-21></a>
<a id=__codelineno-14-22 name=__codelineno-14-22 href=#__codelineno-14-22></a><span class=go>num_trials = 10000  # Running with 10,000 trials for better estimation</span>
<a id=__codelineno-14-23 name=__codelineno-14-23 href=#__codelineno-14-23></a><span class=go>print(f&quot;Expected maximum dice value: {simulate_max_dice_value(num_trials)}&quot;)</span>
<a id=__codelineno-14-24 name=__codelineno-14-24 href=#__codelineno-14-24></a><span class=go>analyze_distribution(num_trials)</span>
<a id=__codelineno-14-25 name=__codelineno-14-25 href=#__codelineno-14-25></a><span class=go>```</span>
<a id=__codelineno-14-26 name=__codelineno-14-26 href=#__codelineno-14-26></a>
<a id=__codelineno-14-27 name=__codelineno-14-27 href=#__codelineno-14-27></a><span class=go>Copy and run this code snippet. It will print the expected maximum dice value and the distribution of maximum values over 10,000 trials.</span>
<a id=__codelineno-14-28 name=__codelineno-14-28 href=#__codelineno-14-28></a>
<a id=__codelineno-14-29 name=__codelineno-14-29 href=#__codelineno-14-29></a><span class=go>Here&#39;s what the output might look like:</span>
<a id=__codelineno-14-30 name=__codelineno-14-30 href=#__codelineno-14-30></a>
<a id=__codelineno-14-31 name=__codelineno-14-31 href=#__codelineno-14-31></a><span class=go>```python</span>
<a id=__codelineno-14-32 name=__codelineno-14-32 href=#__codelineno-14-32></a><span class=go>Expected maximum dice value: 4.6083</span>
<a id=__codelineno-14-33 name=__codelineno-14-33 href=#__codelineno-14-33></a><span class=go>Maximum Value: 2, Frequency: 48</span>
<a id=__codelineno-14-34 name=__codelineno-14-34 href=#__codelineno-14-34></a><span class=go>Maximum Value: 3, Frequency: 166</span>
<a id=__codelineno-14-35 name=__codelineno-14-35 href=#__codelineno-14-35></a><span class=go>Maximum Value: 4, Frequency: 599</span>
<a id=__codelineno-14-36 name=__codelineno-14-36 href=#__codelineno-14-36></a><span class=go>Maximum Value: 5, Frequency: 2237</span>
<a id=__codelineno-14-37 name=__codelineno-14-37 href=#__codelineno-14-37></a><span class=go>Maximum Value: 6, Frequency: 6950</span>
<a id=__codelineno-14-38 name=__codelineno-14-38 href=#__codelineno-14-38></a><span class=go>```</span>
<a id=__codelineno-14-39 name=__codelineno-14-39 href=#__codelineno-14-39></a>
<a id=__codelineno-14-40 name=__codelineno-14-40 href=#__codelineno-14-40></a><span class=go>From the simulation, the expected maximum dice value when rolling a 6-sided dice three times seems to be around 4.6083. The distribution shows that a maximum value of 6 is the most frequent outcome, which makes sense given the nature of the dice rolls.</span>
</code></pre></div> <h2 id=visualizing-the-reasoning-tree>Visualizing the Reasoning Tree<a class=headerlink href=#visualizing-the-reasoning-tree title="Permanent link">#</a></h2> <h3 id=installation-of-graphviz>Installation of Graphviz<a class=headerlink href=#installation-of-graphviz title="Permanent link">#</a></h3> <p>To visualize the reasoning tree, you need to install Graphviz. Please note that using <code>pip install</code> may not be sufficient for all operating systems. In some cases, you might need to manually download and install Graphviz.</p> <p><code>pip install graphviz</code></p> <h3 id=to-save-the-visualization-as-tree_of_thoughtspng-run-the-following-command>To save the visualization as "tree_of_thoughts.png", run the following command:<a class=headerlink href=#to-save-the-visualization-as-tree_of_thoughtspng-run-the-following-command title="Permanent link">#</a></h3> <div class=highlight><pre><span></span><code><a id=__codelineno-15-1 name=__codelineno-15-1 href=#__codelineno-15-1></a><span class=n>mcts_agent</span><span class=o>.</span><span class=n>visualize_tree</span><span class=p>()</span>
</code></pre></div> <h2 id=utilizing-reasoningagent-for-nested-chat-interactions>Utilizing ReasoningAgent for Nested Chat Interactions<a class=headerlink href=#utilizing-reasoningagent-for-nested-chat-interactions title="Permanent link">#</a></h2> <p>In this example, we will explore how the <a href=../../../api-reference/autogen/agents/experimental/ReasoningAgent><code>ReasoningAgent</code></a> can be employed to facilitate nested chat interactions, specifically for writing a blog post about NVIDIA. The agent will engage in a structured dialogue to enhance the quality of the content through iterative feedback and reasoning.</p> <h3 id=task-writing-a-blog-post-on-nvidia>Task: Writing a Blog Post on NVIDIA<a class=headerlink href=#task-writing-a-blog-post-on-nvidia title="Permanent link">#</a></h3> <p>The goal is to generate a concise yet engaging blog post about NVIDIA. The process involves one turn (for simplicity) of conversation where the agent reflects on the content, reasons about improvements, and incorporates user feedback. You can update the <code>max_turns</code> parameter to execute multiple times.</p> <p><div class=highlight><pre><span></span><code><a id=__codelineno-16-1 name=__codelineno-16-1 href=#__codelineno-16-1></a><span class=k>with</span> <span class=n>llm_config</span><span class=p>:</span>
<a id=__codelineno-16-2 name=__codelineno-16-2 href=#__codelineno-16-2></a>    <span class=n>writer</span> <span class=o>=</span> <span class=n>AssistantAgent</span><span class=p>(</span>
<a id=__codelineno-16-3 name=__codelineno-16-3 href=#__codelineno-16-3></a>        <span class=n>name</span><span class=o>=</span><span class=s2>&quot;Writer&quot;</span><span class=p>,</span>
<a id=__codelineno-16-4 name=__codelineno-16-4 href=#__codelineno-16-4></a>        <span class=n>system_message</span><span class=o>=</span><span class=s2>&quot;&quot;&quot;You are a professional writer, known for your insightful and engaging articles.</span>
<a id=__codelineno-16-5 name=__codelineno-16-5 href=#__codelineno-16-5></a><span class=s2>You transform complex concepts into compelling narratives.</span>
<a id=__codelineno-16-6 name=__codelineno-16-6 href=#__codelineno-16-6></a><span class=s2>You should improve the quality of the content based on the feedback from the user.</span>
<a id=__codelineno-16-7 name=__codelineno-16-7 href=#__codelineno-16-7></a><span class=s2>    &quot;&quot;&quot;</span><span class=p>,</span>
<a id=__codelineno-16-8 name=__codelineno-16-8 href=#__codelineno-16-8></a>    <span class=p>)</span>
<a id=__codelineno-16-9 name=__codelineno-16-9 href=#__codelineno-16-9></a>    <span class=n>reason_agent_for_writer</span> <span class=o>=</span> <span class=n>ReasoningAgent</span><span class=p>(</span>
<a id=__codelineno-16-10 name=__codelineno-16-10 href=#__codelineno-16-10></a>        <span class=n>name</span><span class=o>=</span><span class=s2>&quot;reason_agent&quot;</span><span class=p>,</span>
<a id=__codelineno-16-11 name=__codelineno-16-11 href=#__codelineno-16-11></a>        <span class=n>reason_config</span><span class=o>=</span><span class=p>{</span><span class=s2>&quot;method&quot;</span><span class=p>:</span> <span class=s2>&quot;lats&quot;</span><span class=p>,</span> <span class=s2>&quot;nsim&quot;</span><span class=p>:</span> <span class=mi>2</span><span class=p>,</span> <span class=s2>&quot;max_depth&quot;</span><span class=p>:</span> <span class=mi>3</span><span class=p>},</span>
<a id=__codelineno-16-12 name=__codelineno-16-12 href=#__codelineno-16-12></a>    <span class=p>)</span>
<a id=__codelineno-16-13 name=__codelineno-16-13 href=#__codelineno-16-13></a>
<a id=__codelineno-16-14 name=__codelineno-16-14 href=#__codelineno-16-14></a><span class=k>def</span><span class=w> </span><span class=nf>reflection_message</span><span class=p>(</span><span class=n>recipient</span><span class=p>,</span> <span class=n>messages</span><span class=p>,</span> <span class=n>sender</span><span class=p>,</span> <span class=n>config</span><span class=p>):</span>
<a id=__codelineno-16-15 name=__codelineno-16-15 href=#__codelineno-16-15></a>    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;Reflecting...&quot;</span><span class=p>,</span> <span class=s2>&quot;yellow&quot;</span><span class=p>)</span>
<a id=__codelineno-16-16 name=__codelineno-16-16 href=#__codelineno-16-16></a>    <span class=k>return</span> <span class=sa>f</span><span class=s2>&quot;Reflect, Reason and provide critique on the following writing. </span><span class=se>\n\n</span><span class=s2> </span><span class=si>{</span><span class=n>recipient</span><span class=o>.</span><span class=n>chat_messages_for_summary</span><span class=p>(</span><span class=n>sender</span><span class=p>)[</span><span class=o>-</span><span class=mi>1</span><span class=p>][</span><span class=s1>&#39;content&#39;</span><span class=p>]</span><span class=si>}</span><span class=s2>&quot;</span>
<a id=__codelineno-16-17 name=__codelineno-16-17 href=#__codelineno-16-17></a>
<a id=__codelineno-16-18 name=__codelineno-16-18 href=#__codelineno-16-18></a><span class=n>user_proxy</span><span class=o>.</span><span class=n>register_nested_chats</span><span class=p>(</span>
<a id=__codelineno-16-19 name=__codelineno-16-19 href=#__codelineno-16-19></a>    <span class=p>[</span>
<a id=__codelineno-16-20 name=__codelineno-16-20 href=#__codelineno-16-20></a>        <span class=p>{</span>
<a id=__codelineno-16-21 name=__codelineno-16-21 href=#__codelineno-16-21></a>            <span class=s2>&quot;recipient&quot;</span><span class=p>:</span> <span class=n>reason_agent_for_writer</span><span class=p>,</span>
<a id=__codelineno-16-22 name=__codelineno-16-22 href=#__codelineno-16-22></a>            <span class=s2>&quot;message&quot;</span><span class=p>:</span> <span class=n>reflection_message</span><span class=p>,</span>
<a id=__codelineno-16-23 name=__codelineno-16-23 href=#__codelineno-16-23></a>            <span class=s2>&quot;summary_method&quot;</span><span class=p>:</span> <span class=s2>&quot;last_msg&quot;</span><span class=p>,</span>
<a id=__codelineno-16-24 name=__codelineno-16-24 href=#__codelineno-16-24></a>            <span class=s2>&quot;max_turns&quot;</span><span class=p>:</span> <span class=mi>1</span><span class=p>,</span>
<a id=__codelineno-16-25 name=__codelineno-16-25 href=#__codelineno-16-25></a>        <span class=p>}</span>
<a id=__codelineno-16-26 name=__codelineno-16-26 href=#__codelineno-16-26></a>    <span class=p>],</span>
<a id=__codelineno-16-27 name=__codelineno-16-27 href=#__codelineno-16-27></a>    <span class=n>trigger</span><span class=o>=</span><span class=n>writer</span><span class=p>,</span>
<a id=__codelineno-16-28 name=__codelineno-16-28 href=#__codelineno-16-28></a><span class=p>)</span>
<a id=__codelineno-16-29 name=__codelineno-16-29 href=#__codelineno-16-29></a>
<a id=__codelineno-16-30 name=__codelineno-16-30 href=#__codelineno-16-30></a><span class=n>task</span> <span class=o>=</span> <span class=s2>&quot;&quot;&quot;Write a concise but engaging blogpost about Nvidia.&quot;&quot;&quot;</span>
<a id=__codelineno-16-31 name=__codelineno-16-31 href=#__codelineno-16-31></a><span class=n>res</span> <span class=o>=</span> <span class=n>user_proxy</span><span class=o>.</span><span class=n>initiate_chat</span><span class=p>(</span><span class=n>recipient</span><span class=o>=</span><span class=n>writer</span><span class=p>,</span> <span class=n>message</span><span class=o>=</span><span class=n>task</span><span class=p>,</span> <span class=n>max_turns</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span> <span class=n>summary_method</span><span class=o>=</span><span class=s2>&quot;last_msg&quot;</span><span class=p>)</span>
<a id=__codelineno-16-32 name=__codelineno-16-32 href=#__codelineno-16-32></a>
<a id=__codelineno-16-33 name=__codelineno-16-33 href=#__codelineno-16-33></a><span class=nb>print</span><span class=p>(</span><span class=n>res</span><span class=o>.</span><span class=n>summary</span><span class=p>)</span>
</code></pre></div> <div class=highlight><pre><span></span><code><a id=__codelineno-17-1 name=__codelineno-17-1 href=#__codelineno-17-1></a><span class=go>**The Unstoppable Rise of Nvidia: Empowering the Future of Computing**</span>
<a id=__codelineno-17-2 name=__codelineno-17-2 href=#__codelineno-17-2></a>
<a id=__codelineno-17-3 name=__codelineno-17-3 href=#__codelineno-17-3></a><span class=go>In the dynamic realm of technology, one company stands tall, continually pushing the boundaries of what&#39;s possible: Nvidia. Originating as a modest graphics chip manufacturer in 1993, Nvidia has metamorphosed into a powerhouse driving innovations across diverse industries from gaming to artificial intelligence (AI).</span>
<a id=__codelineno-17-4 name=__codelineno-17-4 href=#__codelineno-17-4></a>
<a id=__codelineno-17-5 name=__codelineno-17-5 href=#__codelineno-17-5></a><span class=go>**Revolutionizing Gaming**</span>
<a id=__codelineno-17-6 name=__codelineno-17-6 href=#__codelineno-17-6></a>
<a id=__codelineno-17-7 name=__codelineno-17-7 href=#__codelineno-17-7></a><span class=go>Nvidia&#39;s ascent began in the gaming industry, where its groundbreaking GPUs (Graphics Processing Units) transformed how we experience digital entertainment. The release of the GeForce series became a landmark moment, enabling unprecedented graphics quality and immersive gameplay that became standards in the industry. Gamers worldwide could render stunning, lifelike environments and complex textures, an evolution tracing back to Nvidiaâ€™s ceaseless commitment to performance enhancement.</span>
<a id=__codelineno-17-8 name=__codelineno-17-8 href=#__codelineno-17-8></a>
<a id=__codelineno-17-9 name=__codelineno-17-9 href=#__codelineno-17-9></a><span class=go>**Pioneering AI and Deep Learning**</span>
<a id=__codelineno-17-10 name=__codelineno-17-10 href=#__codelineno-17-10></a>
<a id=__codelineno-17-11 name=__codelineno-17-11 href=#__codelineno-17-11></a><span class=go>Beyond gaming, Nvidiaâ€™s influence has transcended into other technological territories, most notably AI and deep learning. The introduction of the CUDA (Compute Unified Device Architecture) platform redefined efficiency by harnessing the parallel processing power of GPUs, accelerating computational tasks that traditionally relied on CPUs. Researchers and developers suddenly had a magic wand to realize complex models, leading to breakthroughs in fields like medical research, autonomous driving, and natural language processing.</span>
<a id=__codelineno-17-12 name=__codelineno-17-12 href=#__codelineno-17-12></a>
<a id=__codelineno-17-13 name=__codelineno-17-13 href=#__codelineno-17-13></a><span class=go>Nvidia&#39;s GPUs are the silent workhorses behind many AI breakthroughs, powering everything from language translation apps to sophisticated medical diagnostics tools. The company&#39;s DGX systems offer unparalleled computational power, enabling enterprises to handle large-scale AI workloads effortlessly. It&#39;s not just about raw power; Nvidiaâ€™s software stackâ€”highlighted by CUDAâ€”provides a comprehensive ecosystem for developers to deploy, optimize, and scale AI models effectively.</span>
<a id=__codelineno-17-14 name=__codelineno-17-14 href=#__codelineno-17-14></a>
<a id=__codelineno-17-15 name=__codelineno-17-15 href=#__codelineno-17-15></a><span class=go>**Driving the Autonomous Revolution**</span>
<a id=__codelineno-17-16 name=__codelineno-17-16 href=#__codelineno-17-16></a>
<a id=__codelineno-17-17 name=__codelineno-17-17 href=#__codelineno-17-17></a><span class=go>As we look towards a future dominated by autonomous systems, Nvidia is at the forefront of this revolution as well. Nvidia Drive, the companyâ€™s autonomous vehicle platform, integrates AI to interpret and navigate complex road environments safely. In a remarkable blend of hardware and software, Nvidia&#39;s platforms are designed to handle the vast computational demands of self-driving technology, promising safer and smarter vehicles on tomorrow&#39;s roads.</span>
<a id=__codelineno-17-18 name=__codelineno-17-18 href=#__codelineno-17-18></a>
<a id=__codelineno-17-19 name=__codelineno-17-19 href=#__codelineno-17-19></a><span class=go>**Sustainability and Data Centers**</span>
<a id=__codelineno-17-20 name=__codelineno-17-20 href=#__codelineno-17-20></a>
<a id=__codelineno-17-21 name=__codelineno-17-21 href=#__codelineno-17-21></a><span class=go>Moreover, Nvidia&#39;s contributions extend to the realm of data centers and cloud computing. The Nvidia A100 Tensor Core GPUs signify a leap in computation power and efficiency that optimally supports modern data centers in managing vast amounts of data while consuming less energy. By focusing on sustainability, Nvidia is not just leading in technology but also ensuring its impact is environmentally responsible.</span>
<a id=__codelineno-17-22 name=__codelineno-17-22 href=#__codelineno-17-22></a>
<a id=__codelineno-17-23 name=__codelineno-17-23 href=#__codelineno-17-23></a><span class=go>**Looking Ahead**</span>
<a id=__codelineno-17-24 name=__codelineno-17-24 href=#__codelineno-17-24></a>
<a id=__codelineno-17-25 name=__codelineno-17-25 href=#__codelineno-17-25></a><span class=go>The narrative of Nvidia is one of relentless innovation and vision. We find ourselves in an era where Nvidia&#39;s technologies are integral to advancements in and out of the digital world. From transforming how we play games to enabling smarter, more resilient AI applications, Nvidia&#39;s trajectory signifies a transformative force in modern computing. With a keen eye on future trends and a robust pipeline of groundbreaking technologies, Nvidia is poised to drive the next wave of digital transformation, capturing the essence of the future itself.</span>
</code></pre></div></p> <h2 id=use-a-different-model-for-grading>Use a different Model for Grading<a class=headerlink href=#use-a-different-model-for-grading title="Permanent link">#</a></h2> <p>To use a different model for grading instead of gpt-4o, pass the <code>grader_llm_config</code> argument when initializing the <a href=../../../api-reference/autogen/agents/experimental/ReasoningAgent><code>ReasoningAgent</code></a>. This ensures that the grading of trajectories is performed using the specified configuration from the <code>config_list</code>, separate from the main <code>llm_config</code>.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-18-1 name=__codelineno-18-1 href=#__codelineno-18-1></a><span class=c1># Put your key in the OPENAI_API_KEY environment variable</span>
<a id=__codelineno-18-2 name=__codelineno-18-2 href=#__codelineno-18-2></a><span class=n>grader_llm_config</span> <span class=o>=</span> <span class=n>LLMConfig</span><span class=p>(</span><span class=n>api_type</span><span class=o>=</span><span class=s2>&quot;openai&quot;</span><span class=p>,</span> <span class=n>model</span><span class=o>=</span><span class=s2>&quot;gpt-4o-mini&quot;</span><span class=p>)</span>
<a id=__codelineno-18-3 name=__codelineno-18-3 href=#__codelineno-18-3></a>
<a id=__codelineno-18-4 name=__codelineno-18-4 href=#__codelineno-18-4></a><span class=k>with</span> <span class=n>llm_config</span><span class=p>:</span>
<a id=__codelineno-18-5 name=__codelineno-18-5 href=#__codelineno-18-5></a>    <span class=n>writer</span> <span class=o>=</span> <span class=n>AssistantAgent</span><span class=p>(</span>
<a id=__codelineno-18-6 name=__codelineno-18-6 href=#__codelineno-18-6></a>        <span class=n>name</span><span class=o>=</span><span class=s2>&quot;Writer&quot;</span><span class=p>,</span>
<a id=__codelineno-18-7 name=__codelineno-18-7 href=#__codelineno-18-7></a>        <span class=n>system_message</span><span class=o>=</span><span class=s2>&quot;&quot;&quot;You are a professional writer, known for your insightful and engaging articles.</span>
<a id=__codelineno-18-8 name=__codelineno-18-8 href=#__codelineno-18-8></a><span class=s2>You transform complex concepts into compelling narratives.</span>
<a id=__codelineno-18-9 name=__codelineno-18-9 href=#__codelineno-18-9></a><span class=s2>You should improve the quality of the content based on the feedback from the user.</span>
<a id=__codelineno-18-10 name=__codelineno-18-10 href=#__codelineno-18-10></a><span class=s2>        &quot;&quot;&quot;</span><span class=p>,</span>
<a id=__codelineno-18-11 name=__codelineno-18-11 href=#__codelineno-18-11></a>    <span class=p>)</span>
<a id=__codelineno-18-12 name=__codelineno-18-12 href=#__codelineno-18-12></a>    <span class=n>reason_agent_for_writer</span> <span class=o>=</span> <span class=n>ReasoningAgent</span><span class=p>(</span>
<a id=__codelineno-18-13 name=__codelineno-18-13 href=#__codelineno-18-13></a>        <span class=n>name</span><span class=o>=</span><span class=s2>&quot;reason_agent&quot;</span><span class=p>,</span>
<a id=__codelineno-18-14 name=__codelineno-18-14 href=#__codelineno-18-14></a>        <span class=n>grader_llm_config</span><span class=o>=</span><span class=n>grader_llm_config</span><span class=p>,</span>
<a id=__codelineno-18-15 name=__codelineno-18-15 href=#__codelineno-18-15></a>        <span class=n>reason_config</span><span class=o>=</span><span class=p>{</span><span class=s2>&quot;method&quot;</span><span class=p>:</span> <span class=s2>&quot;lats&quot;</span><span class=p>,</span> <span class=s2>&quot;nsim&quot;</span><span class=p>:</span> <span class=mi>2</span><span class=p>,</span> <span class=s2>&quot;max_depth&quot;</span><span class=p>:</span> <span class=mi>3</span><span class=p>},</span>
<a id=__codelineno-18-16 name=__codelineno-18-16 href=#__codelineno-18-16></a>    <span class=p>)</span>
</code></pre></div> <h2 id=save-data-to-future-training>Save data to future training<a class=headerlink href=#save-data-to-future-training title="Permanent link">#</a></h2> <p>In this section, we will focus on saving the reasoning agent's decision-making data to help future training.</p> <p>By capturing the structure and content of the reasoning tree, we can create a valuable dataset that can be used to enhance the agent's learning process. This data will allow us to analyze the agent's reasoning patterns, improve its performance, and refine its ability to generate high-quality responses.</p> <p>The saved data can be utilized for various training methodologies, including supervised fine-tuning and reinforcement learning, ultimately contributing to the development of a more robust and effective reasoning agent.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-19-1 name=__codelineno-19-1 href=#__codelineno-19-1></a><span class=kn>import</span><span class=w> </span><span class=nn>json</span>
<a id=__codelineno-19-2 name=__codelineno-19-2 href=#__codelineno-19-2></a>
<a id=__codelineno-19-3 name=__codelineno-19-3 href=#__codelineno-19-3></a><span class=n>data</span> <span class=o>=</span> <span class=n>reason_agent</span><span class=o>.</span><span class=n>_root</span><span class=o>.</span><span class=n>to_dict</span><span class=p>()</span>
<a id=__codelineno-19-4 name=__codelineno-19-4 href=#__codelineno-19-4></a><span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=s2>&quot;reasoning_tree.json&quot;</span><span class=p>,</span> <span class=s2>&quot;w&quot;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
<a id=__codelineno-19-5 name=__codelineno-19-5 href=#__codelineno-19-5></a>    <span class=n>json</span><span class=o>.</span><span class=n>dump</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=n>f</span><span class=p>)</span>
<a id=__codelineno-19-6 name=__codelineno-19-6 href=#__codelineno-19-6></a>
<a id=__codelineno-19-7 name=__codelineno-19-7 href=#__codelineno-19-7></a><span class=c1># recover the node</span>
<a id=__codelineno-19-8 name=__codelineno-19-8 href=#__codelineno-19-8></a><span class=n>new_node</span> <span class=o>=</span> <span class=n>ThinkNode</span><span class=o>.</span><span class=n>from_dict</span><span class=p>(</span><span class=n>json</span><span class=o>.</span><span class=n>load</span><span class=p>(</span><span class=nb>open</span><span class=p>(</span><span class=s2>&quot;reasoning_tree.json&quot;</span><span class=p>)))</span>  <span class=c1># noqa: SIM115</span>
<a id=__codelineno-19-9 name=__codelineno-19-9 href=#__codelineno-19-9></a>
<a id=__codelineno-19-10 name=__codelineno-19-10 href=#__codelineno-19-10></a><span class=n>sft_data</span> <span class=o>=</span> <span class=n>reason_agent</span><span class=o>.</span><span class=n>extract_sft_dataset</span><span class=p>()</span>
<a id=__codelineno-19-11 name=__codelineno-19-11 href=#__codelineno-19-11></a><span class=n>rlhf_data</span> <span class=o>=</span> <span class=n>reason_agent</span><span class=o>.</span><span class=n>extract_rlhf_preference_dataset</span><span class=p>()</span>
<a id=__codelineno-19-12 name=__codelineno-19-12 href=#__codelineno-19-12></a>
<a id=__codelineno-19-13 name=__codelineno-19-13 href=#__codelineno-19-13></a><span class=nb>print</span><span class=p>(</span><span class=n>rlhf_data</span><span class=p>)</span>
</code></pre></div> <h2 id=utilizing-ground-truth-to-enhance-training-data-generation>Utilizing Ground Truth to Enhance Training Data Generation<a class=headerlink href=#utilizing-ground-truth-to-enhance-training-data-generation title="Permanent link">#</a></h2> <p>Access to ground truth answers allows us to improve the evaluation of reasoning paths. In this section, we will explore: - The process of incorporating ground truth into prompts - The methods by which the agent leverages ground truth for evaluation</p> <div class=highlight><pre><span></span><code><a id=__codelineno-20-1 name=__codelineno-20-1 href=#__codelineno-20-1></a><span class=n>prompt</span> <span class=o>=</span> <span class=s2>&quot;&quot;&quot;What is the expected maximum dice value if you can roll a 6-sided dice three times?</span>
<a id=__codelineno-20-2 name=__codelineno-20-2 href=#__codelineno-20-2></a>
<a id=__codelineno-20-3 name=__codelineno-20-3 href=#__codelineno-20-3></a><span class=s2>GROUND_TRUTH:</span>
<a id=__codelineno-20-4 name=__codelineno-20-4 href=#__codelineno-20-4></a><span class=s2>We define X as the highest outcome among the three rolls.</span>
<a id=__codelineno-20-5 name=__codelineno-20-5 href=#__codelineno-20-5></a><span class=s2>The probability that X is at least m is 1 - </span><span class=se>\\</span><span class=s2>left(</span><span class=se>\f</span><span class=s2>rac{m-1}</span><span class=si>{6}</span><span class=se>\r</span><span class=s2>ight)^3 for each m from 1 to 6.</span>
<a id=__codelineno-20-6 name=__codelineno-20-6 href=#__codelineno-20-6></a><span class=s2>Summing these probabilities gives the expectation E(X) = </span><span class=se>\\</span><span class=s2>sum_{m=1}^</span><span class=si>{6}</span><span class=s2> [1 - (</span><span class=se>\f</span><span class=s2>rac{m-1}</span><span class=si>{6}</span><span class=s2>)^3].</span>
<a id=__codelineno-20-7 name=__codelineno-20-7 href=#__codelineno-20-7></a><span class=s2>Calculating this sum results in E(X) = 6 - </span><span class=se>\f</span><span class=s2>rac</span><span class=si>{225}{216}</span><span class=s2> = </span><span class=se>\f</span><span class=s2>rac</span><span class=si>{119}{24}</span><span class=s2>, which approximates to 4.9583.</span>
<a id=__codelineno-20-8 name=__codelineno-20-8 href=#__codelineno-20-8></a><span class=s2>Therefore, the expected maximum value when rolling a six-sided die three times is </span><span class=se>\f</span><span class=s2>rac</span><span class=si>{119}{24}</span><span class=s2> or approximately 4.9583.</span>
<a id=__codelineno-20-9 name=__codelineno-20-9 href=#__codelineno-20-9></a><span class=s2>&quot;&quot;&quot;</span>
<a id=__codelineno-20-10 name=__codelineno-20-10 href=#__codelineno-20-10></a><span class=n>random</span><span class=o>.</span><span class=n>seed</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>  <span class=c1># setup seed for reproducibility</span>
<a id=__codelineno-20-11 name=__codelineno-20-11 href=#__codelineno-20-11></a>
<a id=__codelineno-20-12 name=__codelineno-20-12 href=#__codelineno-20-12></a><span class=k>with</span> <span class=n>llm_config</span><span class=p>:</span>
<a id=__codelineno-20-13 name=__codelineno-20-13 href=#__codelineno-20-13></a>    <span class=n>mcts_agent2</span> <span class=o>=</span> <span class=n>ReasoningAgent</span><span class=p>(</span>
<a id=__codelineno-20-14 name=__codelineno-20-14 href=#__codelineno-20-14></a>        <span class=n>name</span><span class=o>=</span><span class=s2>&quot;mcts_agent&quot;</span><span class=p>,</span>
<a id=__codelineno-20-15 name=__codelineno-20-15 href=#__codelineno-20-15></a>        <span class=n>system_message</span><span class=o>=</span><span class=s2>&quot;answer math questions&quot;</span><span class=p>,</span>
<a id=__codelineno-20-16 name=__codelineno-20-16 href=#__codelineno-20-16></a>        <span class=c1># setup small depth and simulations for conciseness.</span>
<a id=__codelineno-20-17 name=__codelineno-20-17 href=#__codelineno-20-17></a>        <span class=n>reason_config</span><span class=o>=</span><span class=p>{</span><span class=s2>&quot;method&quot;</span><span class=p>:</span> <span class=s2>&quot;mcts&quot;</span><span class=p>,</span> <span class=s2>&quot;nsim&quot;</span><span class=p>:</span> <span class=mi>3</span><span class=p>,</span> <span class=s2>&quot;max_depth&quot;</span><span class=p>:</span> <span class=mi>4</span><span class=p>},</span>
<a id=__codelineno-20-18 name=__codelineno-20-18 href=#__codelineno-20-18></a>    <span class=p>)</span>
<a id=__codelineno-20-19 name=__codelineno-20-19 href=#__codelineno-20-19></a>
<a id=__codelineno-20-20 name=__codelineno-20-20 href=#__codelineno-20-20></a><span class=n>ans</span> <span class=o>=</span> <span class=n>user_proxy</span><span class=o>.</span><span class=n>initiate_chat</span><span class=p>(</span><span class=n>mcts_agent2</span><span class=p>,</span> <span class=n>message</span><span class=o>=</span><span class=n>prompt</span><span class=p>,</span> <span class=n>summary_method</span><span class=o>=</span><span class=n>last_meaningful_msg</span><span class=p>)</span>
<a id=__codelineno-20-21 name=__codelineno-20-21 href=#__codelineno-20-21></a>
<a id=__codelineno-20-22 name=__codelineno-20-22 href=#__codelineno-20-22></a><span class=nb>print</span><span class=p>(</span><span class=n>ans</span><span class=o>.</span><span class=n>summary</span><span class=p>)</span>
</code></pre></div> <div class=highlight><pre><span></span><code><a id=__codelineno-21-1 name=__codelineno-21-1 href=#__codelineno-21-1></a><span class=go>Let&#39;s break down the problem step by step, using the trajectory described:</span>
<a id=__codelineno-21-2 name=__codelineno-21-2 href=#__codelineno-21-2></a>
<a id=__codelineno-21-3 name=__codelineno-21-3 href=#__codelineno-21-3></a><span class=gp>#</span><span class=c1>## Step 1: Statistical Properties</span>
<a id=__codelineno-21-4 name=__codelineno-21-4 href=#__codelineno-21-4></a>
<a id=__codelineno-21-5 name=__codelineno-21-5 href=#__codelineno-21-5></a><span class=go>Consider a 6-sided die with faces numbered from 1 to 6. We want to find the expected maximum value when rolling the die three times.</span>
<a id=__codelineno-21-6 name=__codelineno-21-6 href=#__codelineno-21-6></a>
<a id=__codelineno-21-7 name=__codelineno-21-7 href=#__codelineno-21-7></a><span class=gp>#</span><span class=c1>## Step 2: Probability Distribution</span>
<a id=__codelineno-21-8 name=__codelineno-21-8 href=#__codelineno-21-8></a>
<a id=__codelineno-21-9 name=__codelineno-21-9 href=#__codelineno-21-9></a><span class=go>To calculate the expected maximum value, we need to determine the probability distribution for the maximum value when rolling three times:</span>
<a id=__codelineno-21-10 name=__codelineno-21-10 href=#__codelineno-21-10></a>
<a id=__codelineno-21-11 name=__codelineno-21-11 href=#__codelineno-21-11></a><span class=go>- The probability that the maximum value is 1: All three rolls must be 1.</span>
<a id=__codelineno-21-12 name=__codelineno-21-12 href=#__codelineno-21-12></a><span class=go>  \[</span>
<a id=__codelineno-21-13 name=__codelineno-21-13 href=#__codelineno-21-13></a><span class=go>  P(\text{max}=1) = \left(\frac{1}{6}\right)^3 = \frac{1}{216}</span>
<a id=__codelineno-21-14 name=__codelineno-21-14 href=#__codelineno-21-14></a><span class=go>  \]</span>
<a id=__codelineno-21-15 name=__codelineno-21-15 href=#__codelineno-21-15></a>
<a id=__codelineno-21-16 name=__codelineno-21-16 href=#__codelineno-21-16></a><span class=go>- The probability that the maximum value is 2: At least one roll must be 2, and no roll can be greater than 2.</span>
<a id=__codelineno-21-17 name=__codelineno-21-17 href=#__codelineno-21-17></a><span class=go>  \[</span>
<a id=__codelineno-21-18 name=__codelineno-21-18 href=#__codelineno-21-18></a><span class=go>  P(\text{max}=2) = \left(\frac{2}{6}\right)^3 - \left(\frac{1}{6}\right)^3 = \frac{8}{216} - \frac{1}{216} = \frac{7}{216}</span>
<a id=__codelineno-21-19 name=__codelineno-21-19 href=#__codelineno-21-19></a><span class=go>  \]</span>
<a id=__codelineno-21-20 name=__codelineno-21-20 href=#__codelineno-21-20></a>
<a id=__codelineno-21-21 name=__codelineno-21-21 href=#__codelineno-21-21></a><span class=go>- The probability that the maximum value is 3: At least one roll must be 3, and no roll can be greater than 3.</span>
<a id=__codelineno-21-22 name=__codelineno-21-22 href=#__codelineno-21-22></a><span class=go>  \[</span>
<a id=__codelineno-21-23 name=__codelineno-21-23 href=#__codelineno-21-23></a><span class=go>  P(\text{max}=3) = \left(\frac{3}{6}\right)^3 - \left(\frac{2}{6}\right)^3 = \frac{27}{216} - \frac{8}{216} = \frac{19}{216}</span>
<a id=__codelineno-21-24 name=__codelineno-21-24 href=#__codelineno-21-24></a><span class=go>  \]</span>
<a id=__codelineno-21-25 name=__codelineno-21-25 href=#__codelineno-21-25></a>
<a id=__codelineno-21-26 name=__codelineno-21-26 href=#__codelineno-21-26></a><span class=go>- The probability that the maximum value is 4: At least one roll must be 4, and no roll can be greater than 4.</span>
<a id=__codelineno-21-27 name=__codelineno-21-27 href=#__codelineno-21-27></a><span class=go>  \[</span>
<a id=__codelineno-21-28 name=__codelineno-21-28 href=#__codelineno-21-28></a><span class=go>  P(\text{max}=4) = \left(\frac{4}{6}\right)^3 - \left(\frac{3}{6}\right)^3 = \frac{64}{216} - \frac{27}{216} = \frac{37}{216}</span>
<a id=__codelineno-21-29 name=__codelineno-21-29 href=#__codelineno-21-29></a><span class=go>  \]</span>
<a id=__codelineno-21-30 name=__codelineno-21-30 href=#__codelineno-21-30></a>
<a id=__codelineno-21-31 name=__codelineno-21-31 href=#__codelineno-21-31></a><span class=go>- The probability that the maximum value is 5: At least one roll must be 5, and no roll can be greater than 5.</span>
<a id=__codelineno-21-32 name=__codelineno-21-32 href=#__codelineno-21-32></a><span class=go>  \[</span>
<a id=__codelineno-21-33 name=__codelineno-21-33 href=#__codelineno-21-33></a><span class=go>  P(\text{max}=5) = \left(\frac{5}{6}\right)^3 - \left(\frac{4}{6}\right)^3 = \frac{125}{216} - \frac{64}{216} = \frac{61}{216}</span>
<a id=__codelineno-21-34 name=__codelineno-21-34 href=#__codelineno-21-34></a><span class=go>  \]</span>
<a id=__codelineno-21-35 name=__codelineno-21-35 href=#__codelineno-21-35></a>
<a id=__codelineno-21-36 name=__codelineno-21-36 href=#__codelineno-21-36></a><span class=go>- The probability that the maximum value is 6: At least one roll must be 6.</span>
<a id=__codelineno-21-37 name=__codelineno-21-37 href=#__codelineno-21-37></a><span class=go>  \[</span>
<a id=__codelineno-21-38 name=__codelineno-21-38 href=#__codelineno-21-38></a><span class=go>  P(\text{max}=6) = 1 - \left(\frac{5}{6}\right)^3 = 1 - \frac{125}{216} = \frac{91}{216}</span>
<a id=__codelineno-21-39 name=__codelineno-21-39 href=#__codelineno-21-39></a><span class=go>  \]</span>
<a id=__codelineno-21-40 name=__codelineno-21-40 href=#__codelineno-21-40></a>
<a id=__codelineno-21-41 name=__codelineno-21-41 href=#__codelineno-21-41></a><span class=gp>#</span><span class=c1>## Step 3: Expected Maximum Value</span>
<a id=__codelineno-21-42 name=__codelineno-21-42 href=#__codelineno-21-42></a>
<a id=__codelineno-21-43 name=__codelineno-21-43 href=#__codelineno-21-43></a><span class=go>To find the expected maximum value, we multiply each possible maximum value by its probability and sum the results:</span>
<a id=__codelineno-21-44 name=__codelineno-21-44 href=#__codelineno-21-44></a>
<a id=__codelineno-21-45 name=__codelineno-21-45 href=#__codelineno-21-45></a><span class=go>\[</span>
<a id=__codelineno-21-46 name=__codelineno-21-46 href=#__codelineno-21-46></a><span class=go>E[\text{max}] = 1 \cdot \frac{1}{216} + 2 \cdot \frac{7}{216} + 3 \cdot \frac{19}{216} + 4 \cdot \frac{37}{216} + 5 \cdot \frac{61}{216} + 6 \cdot \frac{91}{216}</span>
<a id=__codelineno-21-47 name=__codelineno-21-47 href=#__codelineno-21-47></a><span class=go>\]</span>
<a id=__codelineno-21-48 name=__codelineno-21-48 href=#__codelineno-21-48></a>
<a id=__codelineno-21-49 name=__codelineno-21-49 href=#__codelineno-21-49></a><span class=go>Calculating these products:</span>
<a id=__codelineno-21-50 name=__codelineno-21-50 href=#__codelineno-21-50></a>
<a id=__codelineno-21-51 name=__codelineno-21-51 href=#__codelineno-21-51></a><span class=go>\[</span>
<a id=__codelineno-21-52 name=__codelineno-21-52 href=#__codelineno-21-52></a><span class=go>E[\text{max}] = \frac{1}{216} + \frac{14}{216} + \frac{57}{216} + \frac{148}{216} + \frac{305}{216} + \frac{546}{216}</span>
<a id=__codelineno-21-53 name=__codelineno-21-53 href=#__codelineno-21-53></a><span class=go>\]</span>
<a id=__codelineno-21-54 name=__codelineno-21-54 href=#__codelineno-21-54></a>
<a id=__codelineno-21-55 name=__codelineno-21-55 href=#__codelineno-21-55></a><span class=go>Summing them up:</span>
<a id=__codelineno-21-56 name=__codelineno-21-56 href=#__codelineno-21-56></a>
<a id=__codelineno-21-57 name=__codelineno-21-57 href=#__codelineno-21-57></a><span class=go>\[</span>
<a id=__codelineno-21-58 name=__codelineno-21-58 href=#__codelineno-21-58></a><span class=go>E[\text{max}] = \frac{1 + 14 + 57 + 148 + 305 + 546}{216} = \frac{1071}{216} \approx 4.96</span>
<a id=__codelineno-21-59 name=__codelineno-21-59 href=#__codelineno-21-59></a><span class=go>\]</span>
<a id=__codelineno-21-60 name=__codelineno-21-60 href=#__codelineno-21-60></a>
<a id=__codelineno-21-61 name=__codelineno-21-61 href=#__codelineno-21-61></a><span class=gp>#</span><span class=c1>## Final Answer</span>
<a id=__codelineno-21-62 name=__codelineno-21-62 href=#__codelineno-21-62></a>
<a id=__codelineno-21-63 name=__codelineno-21-63 href=#__codelineno-21-63></a><span class=go>The expected maximum value when rolling a 6-sided die three times is approximately 4.96.</span>
</code></pre></div> <h2 id=forest-of-thoughts>Forest of Thoughts<a class=headerlink href=#forest-of-thoughts title="Permanent link">#</a></h2> <p>The concept of a "Forest of Thoughts" allows us to leverage bootstrapping techniques to execute the tree of thoughts multiple times, creating a diverse set of answers. After running these independent reasoning processes, we can aggregate them to form our final answer.</p> <p><div class=highlight><pre><span></span><code><a id=__codelineno-22-1 name=__codelineno-22-1 href=#__codelineno-22-1></a><span class=k>with</span> <span class=n>llm_config</span><span class=p>:</span>
<a id=__codelineno-22-2 name=__codelineno-22-2 href=#__codelineno-22-2></a>    <span class=n>forest_agent</span> <span class=o>=</span> <span class=n>ReasoningAgent</span><span class=p>(</span>
<a id=__codelineno-22-3 name=__codelineno-22-3 href=#__codelineno-22-3></a>        <span class=n>name</span><span class=o>=</span><span class=s2>&quot;mcts_agent&quot;</span><span class=p>,</span>
<a id=__codelineno-22-4 name=__codelineno-22-4 href=#__codelineno-22-4></a>        <span class=n>system_message</span><span class=o>=</span><span class=s2>&quot;answer math questions&quot;</span><span class=p>,</span>
<a id=__codelineno-22-5 name=__codelineno-22-5 href=#__codelineno-22-5></a>        <span class=c1># setup small depth and simulations for conciseness.</span>
<a id=__codelineno-22-6 name=__codelineno-22-6 href=#__codelineno-22-6></a>        <span class=n>reason_config</span><span class=o>=</span><span class=p>{</span><span class=s2>&quot;method&quot;</span><span class=p>:</span> <span class=s2>&quot;dfs&quot;</span><span class=p>,</span> <span class=s2>&quot;max_depth&quot;</span><span class=p>:</span> <span class=mi>4</span><span class=p>,</span> <span class=s2>&quot;forest_size&quot;</span><span class=p>:</span> <span class=mi>3</span><span class=p>},</span>
<a id=__codelineno-22-7 name=__codelineno-22-7 href=#__codelineno-22-7></a>    <span class=p>)</span>
<a id=__codelineno-22-8 name=__codelineno-22-8 href=#__codelineno-22-8></a>
<a id=__codelineno-22-9 name=__codelineno-22-9 href=#__codelineno-22-9></a><span class=n>ans</span> <span class=o>=</span> <span class=n>user_proxy</span><span class=o>.</span><span class=n>initiate_chat</span><span class=p>(</span><span class=n>forest_agent</span><span class=p>,</span> <span class=n>message</span><span class=o>=</span><span class=n>question</span><span class=p>,</span> <span class=n>summary_method</span><span class=o>=</span><span class=n>last_meaningful_msg</span><span class=p>)</span>
<a id=__codelineno-22-10 name=__codelineno-22-10 href=#__codelineno-22-10></a>
<a id=__codelineno-22-11 name=__codelineno-22-11 href=#__codelineno-22-11></a><span class=nb>print</span><span class=p>(</span><span class=n>ans</span><span class=o>.</span><span class=n>summary</span><span class=p>)</span>
</code></pre></div> <div class=highlight><pre><span></span><code><a id=__codelineno-23-1 name=__codelineno-23-1 href=#__codelineno-23-1></a><span class=go>To find the expected maximum dice value when rolling a 6-sided die three times, we can follow these steps:</span>
<a id=__codelineno-23-2 name=__codelineno-23-2 href=#__codelineno-23-2></a>
<a id=__codelineno-23-3 name=__codelineno-23-3 href=#__codelineno-23-3></a><span class=go>Step 1: Use statistical properties and formulas to determine the expected maximum value of rolling a 6-sided die three times.</span>
<a id=__codelineno-23-4 name=__codelineno-23-4 href=#__codelineno-23-4></a>
<a id=__codelineno-23-5 name=__codelineno-23-5 href=#__codelineno-23-5></a><span class=go>Step 2: Calculate the probability distribution of the maximum value when rolling a 6-sided die three times. Consider each possible outcome (1 through 6). The probability that \(k\) will be the maximum value can be calculated by considering the likelihood that all three rolls are less than or equal to \(k\) and at least one roll equals \(k\).</span>
<a id=__codelineno-23-6 name=__codelineno-23-6 href=#__codelineno-23-6></a>
<a id=__codelineno-23-7 name=__codelineno-23-7 href=#__codelineno-23-7></a><span class=go>Probability \(P(X = k)\):</span>
<a id=__codelineno-23-8 name=__codelineno-23-8 href=#__codelineno-23-8></a><span class=go>1. For \(k = 1\):</span>
<a id=__codelineno-23-9 name=__codelineno-23-9 href=#__codelineno-23-9></a><span class=go>\[ P(X = 1) = \left( \frac{1}{6} \right)^3 = \frac{1}{216} \]</span>
<a id=__codelineno-23-10 name=__codelineno-23-10 href=#__codelineno-23-10></a><span class=go>2. For \(k = 2\):</span>
<a id=__codelineno-23-11 name=__codelineno-23-11 href=#__codelineno-23-11></a><span class=go>\[ P(X = 2) = \left( \frac{2}{6} \right)^3 - \left( \frac{1}{6} \right)^3 = \frac{8}{216} - \frac{1}{216} = \frac{7}{216} \]</span>
<a id=__codelineno-23-12 name=__codelineno-23-12 href=#__codelineno-23-12></a><span class=go>3. For \(k = 3\):</span>
<a id=__codelineno-23-13 name=__codelineno-23-13 href=#__codelineno-23-13></a><span class=go>\[ P(X = 3) = \left( \frac{3}{6} \right)^3 - \left( \frac{2}{6} \right)^3 = \frac{27}{216} - \frac{8}{216} = \frac{19}{216} \]</span>
<a id=__codelineno-23-14 name=__codelineno-23-14 href=#__codelineno-23-14></a><span class=go>4. For \(k = 4\):</span>
<a id=__codelineno-23-15 name=__codelineno-23-15 href=#__codelineno-23-15></a><span class=go>\[ P(X = 4) = \left( \frac{4}{6} \right)^3 - \left( \frac{3}{6} \right)^3 = \frac{64}{216} - \frac{27}{216} = \frac{37}{216} \]</span>
<a id=__codelineno-23-16 name=__codelineno-23-16 href=#__codelineno-23-16></a><span class=go>5. For \(k = 5\):</span>
<a id=__codelineno-23-17 name=__codelineno-23-17 href=#__codelineno-23-17></a><span class=go>\[ P(X = 5) = \left( \frac{5}{6} \right)^3 - \left( \frac{4}{6} \right)^3 = \frac{125}{216} - \frac{64}{216} = \frac{61}{216} \]</span>
<a id=__codelineno-23-18 name=__codelineno-23-18 href=#__codelineno-23-18></a><span class=go>6. For \(k = 6\):</span>
<a id=__codelineno-23-19 name=__codelineno-23-19 href=#__codelineno-23-19></a><span class=go>\[ P(X = 6) = 1 - \left( \frac{5}{6} \right)^3 = 1 - \frac{125}{216} = \frac{91}{216} \]</span>
<a id=__codelineno-23-20 name=__codelineno-23-20 href=#__codelineno-23-20></a>
<a id=__codelineno-23-21 name=__codelineno-23-21 href=#__codelineno-23-21></a><span class=go>Step 3: Sum the weighted probabilities to find the expected maximum value</span>
<a id=__codelineno-23-22 name=__codelineno-23-22 href=#__codelineno-23-22></a>
<a id=__codelineno-23-23 name=__codelineno-23-23 href=#__codelineno-23-23></a><span class=go>The expected maximum value \(E[X]\) is calculated by summing the products of each maximum value by its probability:</span>
<a id=__codelineno-23-24 name=__codelineno-23-24 href=#__codelineno-23-24></a>
<a id=__codelineno-23-25 name=__codelineno-23-25 href=#__codelineno-23-25></a><span class=go>\[ E[X] = \sum_{k=1}^{6} k \cdot P(X = k) \]</span>
<a id=__codelineno-23-26 name=__codelineno-23-26 href=#__codelineno-23-26></a><span class=go>\[ E[X] = 1 \cdot \frac{1}{216} + 2 \cdot \frac{7}{216} + 3 \cdot \frac{19}{216} + 4 \cdot \frac{37}{216} + 5 \cdot \frac{61}{216} + 6 \cdot \frac{91}{216} \]</span>
<a id=__codelineno-23-27 name=__codelineno-23-27 href=#__codelineno-23-27></a><span class=go>\[ E[X] = \frac{1 + 14 + 57 + 148 + 305 + 546}{216} \]</span>
<a id=__codelineno-23-28 name=__codelineno-23-28 href=#__codelineno-23-28></a><span class=go>\[ E[X] = \frac{1071}{216} \approx 4.96 \]</span>
<a id=__codelineno-23-29 name=__codelineno-23-29 href=#__codelineno-23-29></a>
<a id=__codelineno-23-30 name=__codelineno-23-30 href=#__codelineno-23-30></a><span class=go>Final Answer: The expected maximum dice value when rolling a 6-sided die three times is approximately \(4.96\).</span>
</code></pre></div></p> <h2 id=scope>Scope<a class=headerlink href=#scope title="Permanent link">#</a></h2> <p>The effectiveness of a LLM agent on a given task can be significantly enhanced through prompt optimization. To support this for the <code>ReasoningAgent</code>, a <code>scope</code> parameter can be specified during initialization. This parameter will provide valuable context about the agentâ€™s intended use, the reasoning process it should follow, and any constraints or pitfalls to avoid. This information is incorporated into the agentâ€™s thought process to guide its behavior more effectively.</p> <p>Note: The <code>scope</code> differs from the <code>system_message</code> in that it informs the agentâ€™s reasoning throughout the entire thinking process, whereas the <code>system_message</code> is used solely when generating the final response.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-24-1 name=__codelineno-24-1 href=#__codelineno-24-1></a><span class=n>scope</span> <span class=o>=</span> <span class=s2>&quot;&quot;&quot;You assess ethical risks of AI systems used in services.</span>
<a id=__codelineno-24-2 name=__codelineno-24-2 href=#__codelineno-24-2></a><span class=s2>Begin by identifying stakeholders and their interests.</span>
<a id=__codelineno-24-3 name=__codelineno-24-3 href=#__codelineno-24-3></a><span class=s2>Then, evaluate potential ethical risks (bias, transparency, impact).</span>
<a id=__codelineno-24-4 name=__codelineno-24-4 href=#__codelineno-24-4></a><span class=s2>Finally, suggest mitigation strategies and ethical safeguards&quot;&quot;&quot;</span>
<a id=__codelineno-24-5 name=__codelineno-24-5 href=#__codelineno-24-5></a>
<a id=__codelineno-24-6 name=__codelineno-24-6 href=#__codelineno-24-6></a><span class=k>with</span> <span class=n>llm_config</span><span class=p>:</span>
<a id=__codelineno-24-7 name=__codelineno-24-7 href=#__codelineno-24-7></a>    <span class=n>reason_agent</span> <span class=o>=</span> <span class=n>ReasoningAgent</span><span class=p>(</span>
<a id=__codelineno-24-8 name=__codelineno-24-8 href=#__codelineno-24-8></a>        <span class=n>name</span><span class=o>=</span><span class=s2>&quot;reason_agent&quot;</span><span class=p>,</span>
<a id=__codelineno-24-9 name=__codelineno-24-9 href=#__codelineno-24-9></a>        <span class=n>reason_config</span><span class=o>=</span><span class=p>{</span><span class=s2>&quot;method&quot;</span><span class=p>:</span> <span class=s2>&quot;dfs&quot;</span><span class=p>,</span> <span class=s2>&quot;max_depth&quot;</span><span class=p>:</span> <span class=mi>3</span><span class=p>},</span>  <span class=c1># Using DFS</span>
<a id=__codelineno-24-10 name=__codelineno-24-10 href=#__codelineno-24-10></a>        <span class=n>silent</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span>
<a id=__codelineno-24-11 name=__codelineno-24-11 href=#__codelineno-24-11></a>        <span class=n>scope</span><span class=o>=</span><span class=n>scope</span><span class=p>,</span>
<a id=__codelineno-24-12 name=__codelineno-24-12 href=#__codelineno-24-12></a>    <span class=p>)</span>
<a id=__codelineno-24-13 name=__codelineno-24-13 href=#__codelineno-24-13></a>
<a id=__codelineno-24-14 name=__codelineno-24-14 href=#__codelineno-24-14></a><span class=n>question</span> <span class=o>=</span> <span class=s2>&quot;What are the ethical risks of using AI in healthcare?&quot;</span>
<a id=__codelineno-24-15 name=__codelineno-24-15 href=#__codelineno-24-15></a><span class=n>ans</span> <span class=o>=</span> <span class=n>user_proxy</span><span class=o>.</span><span class=n>initiate_chat</span><span class=p>(</span><span class=n>reason_agent</span><span class=p>,</span> <span class=n>message</span><span class=o>=</span><span class=n>question</span><span class=p>,</span> <span class=n>summary_method</span><span class=o>=</span><span class=n>last_meaningful_msg</span><span class=p>)</span>
<a id=__codelineno-24-16 name=__codelineno-24-16 href=#__codelineno-24-16></a>
<a id=__codelineno-24-17 name=__codelineno-24-17 href=#__codelineno-24-17></a><span class=nb>print</span><span class=p>(</span><span class=n>ans</span><span class=o>.</span><span class=n>summary</span><span class=p>)</span>
</code></pre></div> <div class=highlight><pre><span></span><code><a id=__codelineno-25-1 name=__codelineno-25-1 href=#__codelineno-25-1></a><span class=gp>#</span><span class=c1>## Step 1: Identify Stakeholders</span>
<a id=__codelineno-25-2 name=__codelineno-25-2 href=#__codelineno-25-2></a><span class=go>In the context of AI in healthcare, the main stakeholders include:</span>
<a id=__codelineno-25-3 name=__codelineno-25-3 href=#__codelineno-25-3></a><span class=go>- **Patients:** The primary beneficiaries of healthcare services.</span>
<a id=__codelineno-25-4 name=__codelineno-25-4 href=#__codelineno-25-4></a><span class=go>- **Healthcare Providers:** Includes doctors, nurses, and other medical professionals.</span>
<a id=__codelineno-25-5 name=__codelineno-25-5 href=#__codelineno-25-5></a><span class=go>- **Hospitals and Clinics:** Organizations that deliver healthcare services.</span>
<a id=__codelineno-25-6 name=__codelineno-25-6 href=#__codelineno-25-6></a><span class=go>- **Insurance Companies:** Entities that provide health insurance coverage.</span>
<a id=__codelineno-25-7 name=__codelineno-25-7 href=#__codelineno-25-7></a><span class=go>- **Healthcare Administrators:** Individuals who manage healthcare operations.</span>
<a id=__codelineno-25-8 name=__codelineno-25-8 href=#__codelineno-25-8></a><span class=go>- **Technology Developers:** Companies and individuals developing AI solutions for healthcare.</span>
<a id=__codelineno-25-9 name=__codelineno-25-9 href=#__codelineno-25-9></a><span class=go>- **Regulatory Bodies:** Government agencies and boards overseeing healthcare practices and AI technology.</span>
<a id=__codelineno-25-10 name=__codelineno-25-10 href=#__codelineno-25-10></a>
<a id=__codelineno-25-11 name=__codelineno-25-11 href=#__codelineno-25-11></a><span class=gp>#</span><span class=c1>## Step 2: Identify Stakeholder Interests</span>
<a id=__codelineno-25-12 name=__codelineno-25-12 href=#__codelineno-25-12></a>
<a id=__codelineno-25-13 name=__codelineno-25-13 href=#__codelineno-25-13></a><span class=go>**Patients:**</span>
<a id=__codelineno-25-14 name=__codelineno-25-14 href=#__codelineno-25-14></a><span class=go>- **Privacy:** Ensuring personal health data is secure and confidential.</span>
<a id=__codelineno-25-15 name=__codelineno-25-15 href=#__codelineno-25-15></a><span class=go>- **Accuracy:** Reliable diagnostics and treatment recommendations.</span>
<a id=__codelineno-25-16 name=__codelineno-25-16 href=#__codelineno-25-16></a><span class=go>- **Autonomy:** Having informed consent and control over personal health decisions.</span>
<a id=__codelineno-25-17 name=__codelineno-25-17 href=#__codelineno-25-17></a><span class=go>- **Equity:** Fair access to healthcare regardless of socio-economic status.</span>
<a id=__codelineno-25-18 name=__codelineno-25-18 href=#__codelineno-25-18></a>
<a id=__codelineno-25-19 name=__codelineno-25-19 href=#__codelineno-25-19></a><span class=go>**Healthcare Providers:**</span>
<a id=__codelineno-25-20 name=__codelineno-25-20 href=#__codelineno-25-20></a><span class=go>- **Efficiency:** Improving operational efficiency and reducing workload.</span>
<a id=__codelineno-25-21 name=__codelineno-25-21 href=#__codelineno-25-21></a><span class=go>- **Training:** Adequate training on AI tools to ensure effective usage.</span>
<a id=__codelineno-25-22 name=__codelineno-25-22 href=#__codelineno-25-22></a><span class=go>- **Clinical Judgment:** Augmenting, not replacing, clinical decision-making.</span>
<a id=__codelineno-25-23 name=__codelineno-25-23 href=#__codelineno-25-23></a>
<a id=__codelineno-25-24 name=__codelineno-25-24 href=#__codelineno-25-24></a><span class=go>**Hospitals and Clinics:**</span>
<a id=__codelineno-25-25 name=__codelineno-25-25 href=#__codelineno-25-25></a><span class=go>- **Cost Reduction:** Lowering costs through operational efficiencies.</span>
<a id=__codelineno-25-26 name=__codelineno-25-26 href=#__codelineno-25-26></a><span class=go>- **Quality of Care:** Improving patient outcomes with advanced technology.</span>
<a id=__codelineno-25-27 name=__codelineno-25-27 href=#__codelineno-25-27></a><span class=go>- **Liability:** Managing risks associated with AI errors.</span>
<a id=__codelineno-25-28 name=__codelineno-25-28 href=#__codelineno-25-28></a>
<a id=__codelineno-25-29 name=__codelineno-25-29 href=#__codelineno-25-29></a><span class=go>**Insurance Companies:**</span>
<a id=__codelineno-25-30 name=__codelineno-25-30 href=#__codelineno-25-30></a><span class=go>- **Cost Management:** Controlling expenditures through better predictive analytics.</span>
<a id=__codelineno-25-31 name=__codelineno-25-31 href=#__codelineno-25-31></a><span class=go>- **Risk Assessment:** Improved evaluation of risk for more accurately assessing policyholders.</span>
<a id=__codelineno-25-32 name=__codelineno-25-32 href=#__codelineno-25-32></a><span class=go>- **Compliance:** Adhering to regulatory requirements for AI use.</span>
<a id=__codelineno-25-33 name=__codelineno-25-33 href=#__codelineno-25-33></a>
<a id=__codelineno-25-34 name=__codelineno-25-34 href=#__codelineno-25-34></a><span class=go>**Technology Developers:**</span>
<a id=__codelineno-25-35 name=__codelineno-25-35 href=#__codelineno-25-35></a><span class=go>- **Innovation:** Creating cutting-edge solutions to improve healthcare.</span>
<a id=__codelineno-25-36 name=__codelineno-25-36 href=#__codelineno-25-36></a><span class=go>- **Market Expansion:** Expanding the reach and adoption of AI solutions.</span>
<a id=__codelineno-25-37 name=__codelineno-25-37 href=#__codelineno-25-37></a><span class=go>- **Ethical Standards:** Ensuring their products are ethically sound.</span>
<a id=__codelineno-25-38 name=__codelineno-25-38 href=#__codelineno-25-38></a>
<a id=__codelineno-25-39 name=__codelineno-25-39 href=#__codelineno-25-39></a><span class=go>**Regulatory Bodies:**</span>
<a id=__codelineno-25-40 name=__codelineno-25-40 href=#__codelineno-25-40></a><span class=go>- **Safety:** Ensuring AI tools do not harm patients.</span>
<a id=__codelineno-25-41 name=__codelineno-25-41 href=#__codelineno-25-41></a><span class=go>- **Compliance:** Enforcing regulations around AI use.</span>
<a id=__codelineno-25-42 name=__codelineno-25-42 href=#__codelineno-25-42></a><span class=go>- **Standardization:** Implementing standards for AI technology in healthcare.</span>
<a id=__codelineno-25-43 name=__codelineno-25-43 href=#__codelineno-25-43></a>
<a id=__codelineno-25-44 name=__codelineno-25-44 href=#__codelineno-25-44></a><span class=gp>#</span><span class=c1>## Step 3: Ethical Risks</span>
<a id=__codelineno-25-45 name=__codelineno-25-45 href=#__codelineno-25-45></a>
<a id=__codelineno-25-46 name=__codelineno-25-46 href=#__codelineno-25-46></a><span class=go>**Bias:**</span>
<a id=__codelineno-25-47 name=__codelineno-25-47 href=#__codelineno-25-47></a><span class=go>- **Data Bias:** AI models trained on biased data may produce inequitable results, disproportionately affecting marginalized groups.</span>
<a id=__codelineno-25-48 name=__codelineno-25-48 href=#__codelineno-25-48></a><span class=go>- **Algorithm Bias:** AI algorithms may inadvertently prioritize certain patient demographics over others.</span>
<a id=__codelineno-25-49 name=__codelineno-25-49 href=#__codelineno-25-49></a>
<a id=__codelineno-25-50 name=__codelineno-25-50 href=#__codelineno-25-50></a><span class=go>**Transparency:**</span>
<a id=__codelineno-25-51 name=__codelineno-25-51 href=#__codelineno-25-51></a><span class=go>- **Openness:** AI systems may lack transparency, making it difficult to understand and trust their recommendations.</span>
<a id=__codelineno-25-52 name=__codelineno-25-52 href=#__codelineno-25-52></a><span class=go>- **Explanation:** Difficulty in explaining AI-driven decisions could impact patient trust.</span>
<a id=__codelineno-25-53 name=__codelineno-25-53 href=#__codelineno-25-53></a>
<a id=__codelineno-25-54 name=__codelineno-25-54 href=#__codelineno-25-54></a><span class=go>**Impact:**</span>
<a id=__codelineno-25-55 name=__codelineno-25-55 href=#__codelineno-25-55></a><span class=go>- **Displacement:** Potential for AI to displace healthcare jobs, affecting traditional roles and employment.</span>
<a id=__codelineno-25-56 name=__codelineno-25-56 href=#__codelineno-25-56></a><span class=go>- **Accountability:** Who bears responsibility for errors made by AI systems?</span>
<a id=__codelineno-25-57 name=__codelineno-25-57 href=#__codelineno-25-57></a>
<a id=__codelineno-25-58 name=__codelineno-25-58 href=#__codelineno-25-58></a><span class=go>**Privacy:**</span>
<a id=__codelineno-25-59 name=__codelineno-25-59 href=#__codelineno-25-59></a><span class=go>- **Data Security:** Risk of unauthorized access to sensitive health data.</span>
<a id=__codelineno-25-60 name=__codelineno-25-60 href=#__codelineno-25-60></a><span class=go>- **Consent:** Ensuring patients understand and consent to AI-driven diagnostics and treatments.</span>
<a id=__codelineno-25-61 name=__codelineno-25-61 href=#__codelineno-25-61></a>
<a id=__codelineno-25-62 name=__codelineno-25-62 href=#__codelineno-25-62></a><span class=gp>#</span><span class=c1>## Mitigation Strategies and Ethical Safeguards</span>
<a id=__codelineno-25-63 name=__codelineno-25-63 href=#__codelineno-25-63></a>
<a id=__codelineno-25-64 name=__codelineno-25-64 href=#__codelineno-25-64></a><span class=go>**Bias Mitigation:**</span>
<a id=__codelineno-25-65 name=__codelineno-25-65 href=#__codelineno-25-65></a><span class=go>- **Diverse Training Data:** Ensure diverse and inclusive data sets are used to train AI models.</span>
<a id=__codelineno-25-66 name=__codelineno-25-66 href=#__codelineno-25-66></a><span class=go>- **Algorithm Audits:** Regularly audit algorithms for biases and address identified issues.</span>
<a id=__codelineno-25-67 name=__codelineno-25-67 href=#__codelineno-25-67></a>
<a id=__codelineno-25-68 name=__codelineno-25-68 href=#__codelineno-25-68></a><span class=go>**Transparency Enhancement:**</span>
<a id=__codelineno-25-69 name=__codelineno-25-69 href=#__codelineno-25-69></a><span class=go>- **Explainable AI:** Develop AI systems that provide clear explanations for their decisions.</span>
<a id=__codelineno-25-70 name=__codelineno-25-70 href=#__codelineno-25-70></a><span class=go>- **User Education:** Train healthcare providers to understand and explain AI tools to patients.</span>
<a id=__codelineno-25-71 name=__codelineno-25-71 href=#__codelineno-25-71></a>
<a id=__codelineno-25-72 name=__codelineno-25-72 href=#__codelineno-25-72></a><span class=go>**Privacy Assurance:**</span>
<a id=__codelineno-25-73 name=__codelineno-25-73 href=#__codelineno-25-73></a><span class=go>- **Robust Security Protocols:** Implement strong security measures to protect health data.</span>
<a id=__codelineno-25-74 name=__codelineno-25-74 href=#__codelineno-25-74></a><span class=go>- **Informed Consent:** Ensure patients are fully informed about the use of AI in their care.</span>
<a id=__codelineno-25-75 name=__codelineno-25-75 href=#__codelineno-25-75></a>
<a id=__codelineno-25-76 name=__codelineno-25-76 href=#__codelineno-25-76></a><span class=go>**Impact Management:**</span>
<a id=__codelineno-25-77 name=__codelineno-25-77 href=#__codelineno-25-77></a><span class=go>- **Workforce Transition:** Prepare healthcare workers for transitions by providing training on AI integration.</span>
<a id=__codelineno-25-78 name=__codelineno-25-78 href=#__codelineno-25-78></a><span class=go>- **Clear Accountability:** Establish clear guidelines on responsibility for AI errors and outcomes.</span>
<a id=__codelineno-25-79 name=__codelineno-25-79 href=#__codelineno-25-79></a>
<a id=__codelineno-25-80 name=__codelineno-25-80 href=#__codelineno-25-80></a><span class=go>**Regulatory Compliance:**</span>
<a id=__codelineno-25-81 name=__codelineno-25-81 href=#__codelineno-25-81></a><span class=go>- **Regular Review:** Continually update regulatory standards in line with technological advancements.</span>
<a id=__codelineno-25-82 name=__codelineno-25-82 href=#__codelineno-25-82></a><span class=go>- **Stakeholder Involvement:** Involve all stakeholders in the development and review of ethical guidelines and regulations.</span>
<a id=__codelineno-25-83 name=__codelineno-25-83 href=#__codelineno-25-83></a>
<a id=__codelineno-25-84 name=__codelineno-25-84 href=#__codelineno-25-84></a><span class=go>By identifying stakeholders and their interests, evaluating potential ethical risks, and suggesting mitigation strategies, we can foster responsible and ethical use of AI in healthcare systems.</span>
</code></pre></div> <aside class=md-source-file> <span class=md-source-file__fact> <span class=md-icon title="Last update"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg> </span> <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-timeago"><span class=timeago datetime=2025-05-08T13:42:21+00:00 locale=en></span></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date">2025-05-08</span> </span> </aside> </article> </div> <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg> Back to top </button> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Footer> <a href=../docagent-performance/ class="md-footer__link md-footer__link--prev" aria-label="Previous: DocAgent Performance"> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </div> <div class=md-footer__title> <span class=md-footer__direction> Previous </span> <div class=md-ellipsis> DocAgent Performance </div> </div> </a> <a href=../deepresearchagent/ class="md-footer__link md-footer__link--next" aria-label="Next: DeepResearchAgent"> <div class=md-footer__title> <span class=md-footer__direction> Next </span> <div class=md-ellipsis> DeepResearchAgent </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> &copy; 2025 <a href=https://ag2.ai/ target=_blank rel=noopener>ag2</a> </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> <div class=md-social> <a href=https://discord.gg/pAbnFJrkgZ target=_blank rel=noopener title=discord.gg class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 640 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M524.531 69.836a1.5 1.5 0 0 0-.764-.7A485 485 0 0 0 404.081 32.03a1.82 1.82 0 0 0-1.923.91 338 338 0 0 0-14.9 30.6 447.9 447.9 0 0 0-134.426 0 310 310 0 0 0-15.135-30.6 1.89 1.89 0 0 0-1.924-.91 483.7 483.7 0 0 0-119.688 37.107 1.7 1.7 0 0 0-.788.676C39.068 183.651 18.186 294.69 28.43 404.354a2.02 2.02 0 0 0 .765 1.375 487.7 487.7 0 0 0 146.825 74.189 1.9 1.9 0 0 0 2.063-.676A348 348 0 0 0 208.12 430.4a1.86 1.86 0 0 0-1.019-2.588 321 321 0 0 1-45.868-21.853 1.885 1.885 0 0 1-.185-3.126 251 251 0 0 0 9.109-7.137 1.82 1.82 0 0 1 1.9-.256c96.229 43.917 200.41 43.917 295.5 0a1.81 1.81 0 0 1 1.924.233 235 235 0 0 0 9.132 7.16 1.884 1.884 0 0 1-.162 3.126 301.4 301.4 0 0 1-45.89 21.83 1.875 1.875 0 0 0-1 2.611 391 391 0 0 0 30.014 48.815 1.86 1.86 0 0 0 2.063.7A486 486 0 0 0 610.7 405.729a1.88 1.88 0 0 0 .765-1.352c12.264-126.783-20.532-236.912-86.934-334.541M222.491 337.58c-28.972 0-52.844-26.587-52.844-59.239s23.409-59.241 52.844-59.241c29.665 0 53.306 26.82 52.843 59.239 0 32.654-23.41 59.241-52.843 59.241m195.38 0c-28.971 0-52.843-26.587-52.843-59.239s23.409-59.241 52.843-59.241c29.667 0 53.307 26.82 52.844 59.239 0 32.654-23.177 59.241-52.844 59.241"/></svg> </a> <a href=https://github.com/ag2ai/ag2 target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 480 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1M480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2m-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3m-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1"/></svg> </a> <a href=https://x.com/ag2oss target=_blank rel=noopener title=x.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8l164.9-188.5L26.8 48h145.6l100.5 132.9zm-24.8 373.8h39.1L151.1 88h-42z"/></svg> </a> <a href=https://www.youtube.com/@ag2ai target=_blank rel=noopener title=www.youtube.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 576 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78 0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305m-317.51 213.508V175.185l142.739 81.205z"/></svg> </a> <a href=https://www.linkedin.com/company/ag2ai target=_blank rel=noopener title=www.linkedin.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5m282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../../../..", "features": ["search.suggest", "search.highlight", "navigation.tabs", "navigation.tabs.sticky", "navigation.indexes", "navigation.tracking", "navigation.prune", "navigation.top", "navigation.footer", "content.tabs.link", "content.code.copy", "content.code.annotate", "content.action.edit"], "search": "../../../../assets/javascripts/workers/search.f8cc74c7.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script> <script src=../../../../assets/javascripts/bundle.c8b220af.min.js></script> <script src=../../../../js/timeago.min.js></script> <script src=../../../../js/timeago_mkdocs_material.js></script> <script src=../../../../javascripts/extra.js></script> <script id=init-glightbox>const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(() => { lightbox.reload() });
</script></body> </html>